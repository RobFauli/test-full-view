/*!
* Common client JS-dependencies
* (c) Labrador CMS AS
* Licence required for usage
* https://labradorcms.com
*/
var e={"./build/modules/client_modules.js":(e,t,i)=>{i.r(t),i.d(t,{Entry:()=>F,behaviours:()=>R});var r={d:(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},s={};r.d(s,{k:()=>j,B:()=>a});var a={};r.r(a),r.d(a,{article:()=>v,image:()=>_,page_article:()=>m,page_front:()=>b});class o{static getSiteStyles(e,t=[]){const i=lab_api.v1.config.get(`site_styles.${e}`)||t;return Sys.logger.debug(`ViewSupport: Found ${Array.isArray(i)?i.length:0} stylesheet(s) for site "${e}".`),i}static getSiteStylesWithFallback(e,t=[]){const i=this.getSiteStyles(e,null);if(null===i){t.push(e);const i=lab_api.v1.config.get("lab_fallback_site",{site:e});if(i&&!t.includes(i))return this.getSiteStylesWithFallback(i,t)}return i||[]}static getSiteScripts(e,t,i){const r=this.filterScriptListByPageType(lab_api.v1.config.get(`site_scripts.${e}`)||[],t,i);return Sys.logger.debug(`ViewSupport: Found ${r.length} script-path(s) for site "${e}".`),r}static getSiteScriptsWithFallback(e,t,i,r=[]){let s=this.getSiteScripts(e,t,i);if(r.length&&(s=this.removeWithInheritFalse(s)),!s.length){r.push(e);const s=lab_api.v1.config.get("lab_fallback_site",{site:e});if(s&&!r.includes(s))return this.getSiteScriptsWithFallback(s,t,i,r).filter((e=>!1!==e.inherit))}return s}static getCommonScripts(e,t,i=!1){const r=this.filterScriptListByPageType(lab_api.v1.config.get("site_scripts_common")||[],e,t,i);return Sys.logger.debug(`ViewSupport: Found ${r.length} common ${i?"script-path(s)":"JS modules"}`),r}static filterScriptListByPageType(e,t,i,r=!1){return e.filter((e=>(!e.isModule&&!r||e.isModule&&r)&&(!e.pageType||e.pageType===t)&&(!i||i&&!e.skipEditor)))}static removeWithInheritFalse(e){return Array.isArray(e)&&e.length>0?e.filter((e=>!1!==e.inherit)):e}static getSiteFilesForContentboxes(e,t,i,r=[]){const s=[],a=lab_api.v1.model.query.getModelTypes();Sys.logger.debug(`ViewSupport sitefiles: Will register ${i}-file(s) for contentbox-types ${a.join(", ")}.`);for(const e of a){const t=lab_api.v1.config.get(`contentbox_settings.${e}.require.${i}`);if(Array.isArray(t))for(const a of t)s.includes(a)||r.includes(a)||(Sys.logger.debug(`ViewSupport sitefiles: Will include ${i}-file "${a}" for contentbox "${e}".`),s.push(a))}return Sys.logger.debug(`ViewSupport sitefiles: Finished registering ${i}-file(s). Found ${s.length} file(s).`),s}}class n{constructor(e){this.api=e,this.pageType=this.api.v1.model.root.getType()}get media(){return{getLogo:(e=this.api.v1.viewport.getName())=>{const t=this.api.v1.config.get("logo")||{},i=t.uploadedFileUrl?{src:t.uploadedFileUrl,href:t.default.href,type:"img",size:{width:t.logoWidth},title:t.default.title,isCustom:!0}:t[e]||t.default||null;return i&&("img"===i.type?i.is_img=!0:"svg"===i.type&&(i.is_svg=!0)),{current:i,sm:t.uploadedFileUrl?{src:t.uploadedFileUrl,href:t.default.href,size:{width:t.logoWidth},title:t.default.title,isCustom:!0}:t.standalone||t.mailmojo||null}}}}get menus(){return{get:({section:e,defaultSection:t}={},i)=>{const r={},s=Object.values(this.api.v1.config.get("menus")||{});if(s.length<1)return null;const a=i=>{i.forEach((i=>{i.selected=i.section===e||i.section===t,"target"in i||(i.target="_self"),"selector"in i||(i.selector=""),"children"in i||(i.children=[]),i.children.length>0&&(i.hasChildren=!0,a(i.children))}))};return s.forEach((e=>{a(e.menuItems);const t=e.type||e.menuName;r[t]={items:e.menuItems,type:e.type,selector:e.selector||""}})),i?r[i]:r}}}get misc(){return{}}get resources(){const e={required:[],getProgressReader:()=>(e.required.push({url:"/view-resources/public/common/ReadProgress.js",requireDom:!1}),{active:!0,minElementCount:lab_api.v1.config.get("displayReadProgress.minElementCount")||25}),getSiteFiles(t,i,r,s,a){const n=o.getSiteScriptsWithFallback(r,s,a),l=o.getCommonScripts(s,a);return e.required.push(...n,...l),{js:o.getSiteFilesForContentboxes(t,i,"js",e.required.map((e=>e.url))),css:o.getSiteFilesForContentboxes(t,i,"css")}},getModules:(e,t,i,r,s)=>o.getCommonScripts(r,s,!0)},t={get:()=>{const e=(lab_api.v1.config.get("analytics.kilkaya")||[]).map((e=>{const t={...e};return t.id&&"string"==typeof t.id&&t.id.trim().endsWith(".js")&&(t.url=t.id),t}));let i=this.api.v1.config.get("analytics.adnuntiusConnect");i&&"object"==typeof i&&!Array.isArray(i)&&Object.keys(i).length&&(i=new Array(i));const r={google:this.api.v1.config.get("analytics.google.tracking_id"),google_gtm:this.api.v1.config.get("analytics.google.gtm"),comscore:this.api.v1.config.get("analytics.comscore.comscore_id"),adnuntiusConnect:i,adnuntiusConnectCMP:this.api.v1.config.get("analytics.adnuntiusConnectCMP"),kilkaya:e,kilkayaSettings:this.api.v1.config.get("analytics.kilkayaSettings"),io:this.api.v1.config.get("analytics.io.tracking_id")},s=t.getDataLayer();return s.dataLayer&&(r.dataLayer=s.dataLayer),s.usesJWTCookieData&&(r.usesJWTCookieData=s.usesJWTCookieData),r},getDataLayer:()=>{const e=this.api.v1.config.get("analytics.google.dataLayer");let t=!1;if(e&&Array.isArray(e)&&e.length){e.forEach((e=>{let i=null;switch(e.source){case"config":i=this.api.v1.properties.get(e.value);break;case"jwtcookie":e.isJWTCookie=!0,i=e.value,t=!0;break;case this.pageType.replace("page_",""):i=this.api.v1.model.query.getRootModel().get(e.value)}e.value=null===i?"":i.toString()}));const i=e.map((e=>e.value.length>0)).lastIndexOf(!0);e[i]&&(e[i].last=!0)}return{dataLayer:e,usesJWTCookieData:t}}};return{scripts:e,analytics:t}}get settings(){return{get:(e={})=>{const t=this.api.v1.config.get(`page_settings.${e.pageType}.social.display`)||{},i=this.api.v1.model.query.getRootModel().get("fields.show_social_bodytext_before"),r=this.api.v1.model.query.getRootModel().get("fields.show_social_bodytext_after"),s=this.api.v1.model.query.getRootModel().get("fields.show_social_header");null!==i&&(t.bodytext_before=!!i),null!==r&&(t.bodytext_after=!!r),null!==s&&(t.header=!!s);const a=this.api.v1.config.get(`page_settings.${e.pageType}.social.items`)||{},o=this.api.v1.config.get(`page_settings.${e.pageType}.showTags`),n=Object.keys(a).filter((e=>!!a[e].display)).map((t=>({name:t,icon:a[t].icon||"",url:e.socialLinks[t]||"",shareText:a[t].shareText||"",isButton:a[t].isButton||!1})));return{page_type:e.pageType,social:{display:{bodytext_before:n.length>0&&!!t.bodytext_before,bodytext_after:n.length>0&&!!t.bodytext_after,header:n.length>0&&!!t.header},items:n},showTags:!1!==o}}}}}class l{static getStyleDefinitions(e){const t=e.v1.properties.get("site.alias"),i=e.v1.config.get("style_definitions",t),r=[];(i.rules||[]).forEach((e=>r.push(e))),(i.fontface||[]).forEach((e=>{const t=`.font-${e.family.replace(/ /g,"")}`;r.push(l.getFamilyDefinition(t,e.family));const i={light:{keys:["light","200","100","300"],used:!1},normal:{keys:["regular","normal","400","500"],used:!1},bold:{keys:["bold","600","700"],used:!1},black:{keys:["black","800","900"],used:!1}};e.variants.forEach((e=>{for(const s of Object.keys(i)){const a=i[s];a&&!a.used&&a.keys.indexOf(e)>-1&&(r.push(l.getWeightDefinition(t,e,s)),a.used=!0)}}))}));const s={fontface:i.fontface||[],parsedRules:l.CSSRuleParser(r)};return s.hasRules=!!s.parsedRules.length,s}static getFamilyDefinition(e,t){return{selector:e,declarations:[{key:"font-family",value:`"${t}" !important`}]}}static getWeightDefinition(e,t,i){let r=t;return"regular"===t&&(r="normal"),{selector:`${e}.font-weight-${i}`,declarations:[{key:"font-weight",value:`${r} !important`}]}}static CSSRuleParser(e){const t=[];return e.forEach((e=>{let i,r,s=`${e.selector} { `;e.declarations.forEach((e=>{"font-size-desktop"===e.key?"default"!==e.value&&(s+=`font-size: ${e.value.slice(0,-2)/16}rem; `):"font-size-mobile"===e.key?"default"!==e.value&&(i=`calc(0.262vw * ${e.value.slice(0,-2)})`):"line-height-desktop"===e.key?"default"!==e.value&&(s+=`line-height: ${e.value}; `):"line-height-mobile"===e.key?"default"!==e.value&&(r=e.value):"font-family"===e.key?e.value.includes("!important")?s+=`${e.key}: ${e.value}; `:s+=`${e.key}: "${e.value}"; `:s+=`${e.key}: ${e.value}; `})),s+="}",(i||r)&&(s+=`@media (max-width: 767px) { .resp_fonts ${e.selector} {`,i&&(s+=`font-size: ${i}; `),r&&(s+=`line-height: ${r}; `),s+="} }"),t.push(s)})),t}static getInlineCSS(e,t){return[{key:"custom_properties",value:e.v1.config.get("css_build.custom_properties",{site:t})||""},{key:"background_colors",value:e.v1.config.get("css_build.background_colors",{site:t})||""},{key:"background_colors_opacity",value:e.v1.config.get("css_build.background_colors_opacity",{site:t})||""},{key:"border_colors",value:e.v1.config.get("css_build.border_colors",{site:t})||""},{key:"font_colors",value:e.v1.config.get("css_build.font_colors",{site:t})||""},{key:"image_gradient",value:e.v1.config.get("css_build.image_gradient",{site:t})||""}]}}const d={sunday:{en:"sunday",sv:"söndag",dk:"søndag",no:"søndag",nl:"zondag",kl:"sapaat"},monday:{en:"monday",sv:"måndag",dk:"mandag",no:"mandag",nl:"maandag",kl:"ataasinngorneq"},tuesday:{en:"tuesday",sv:"tisdag",dk:"tirsdag",no:"tirsdag",nl:"dinsdag",kl:"marlunngorneq"},wednesday:{en:"wednesday",sv:"onsdag",dk:"onsdag",no:"onsdag",nl:"woensdag",kl:"pingasunngorneq"},thursday:{en:"thursday",sv:"torsdag",dk:"torsdag",no:"torsdag",nl:"donderdag",kl:"sisamanngorneq"},friday:{en:"friday",sv:"fredag",dk:"fredag",no:"fredag",nl:"vrijdag",kl:"tallimanngorneq"},saturday:{en:"saturday",sv:"lördag",dk:"lørdag",no:"lørdag",nl:"zaterdag",kl:"arfininngorneq"},january:{en:"January",sv:"januari",dk:"januar",no:"januar",nl:"januari",kl:"ukiortaarsiorneq"},february:{en:"February",sv:"februari",dk:"februar",no:"februar",nl:"februari",kl:"ukiortaami"},mars:{en:"March",sv:"mars",dk:"marts",no:"mars",nl:"maart",kl:"marsi"},april:{en:"April",sv:"april",dk:"april",no:"april",nl:"april",kl:"apriili"},may:{en:"May",sv:"maj",dk:"maj",no:"mai",nl:"mei",kl:"maajii"},june:{en:"June",sv:"juni",dk:"juni",no:"juni",nl:"juni",kl:"juuni"},july:{en:"July",sv:"juli",dk:"juli",no:"juli",nl:"juli",kl:"juuli"},august:{en:"August",sv:"augusti",dk:"august",no:"august",nl:"augustus",kl:"aggusti"},september:{en:"September",sv:"september",dk:"september",no:"september",nl:"september",kl:"septembari"},october:{en:"October",sv:"oktober",dk:"oktober",no:"oktober",nl:"oktober",kl:"oktobari"},november:{en:"November",sv:"november",dk:"november",no:"november",nl:"november",kl:"novembari"},december:{en:"December",sv:"december",dk:"december",no:"desember",nl:"december",kl:"decembari"},ago:{en:"ago",sv:"sedan",dk:"siden",no:"siden",nl:"geleden",kl:"matuma siorna"},now:{en:"now",sv:"nu",dk:"nu",no:"nå",nl:"nu",kl:"maanna"},min:{en:"min"},minutes:{en:"minutes",sv:"minuter",dk:"minutter",no:"minutter",nl:"minuten",kl:"minutsi"},hour:{en:"hour",sv:"timme",dk:"time",no:"time",nl:"uur",kl:"akunnera"},hours:{en:"hours",sv:"timmar",dk:"timer",no:"timer",nl:"uren",kl:"akunnerit"},day:{en:"day",sv:"dag",dk:"dag",no:"dag",nl:"dag",kl:"ulloq"},days:{en:"days",sv:"dagar",dk:"dage",no:"dager",nl:"dagen",kl:"ullut"},monthdayyear:{en:"{{MMMM}} {{DD}}. {{YYYY}}",sv:"{{DD}}/{{MM}} {{YYYY}}",dk:"{{DD}}/{{MM}} {{YYYY}}",no:"{{DD}}/{{MM}} {{YYYY}}",nl:"{{DD}}/{{MM}} {{YYYY}}"},hourminute:{en:"{{HH}}:{{mm}}"}};class c{constructor(e="en",t="en"){this.fallbackLanguage=t,this.language=e||t,this.words=d,this.timezone=this.getTimezone()}getTimezone(){const e=lab_api.v1.config.get("timezone");return void 0===e||Number.isNaN(e)||Number.isNaN(parseFloat(e))?1:parseInt(e,10)}str(e){let{language:t}=this;return e in this.words?(t in this.words[e]||(t=this.fallbackLanguage),t in this.words[e]?this.words[e][t]:null):null}format(e,t){return Mustache.render(t,{YYYY:()=>e.getFullYear(),YY:()=>`${e.getFullYear()}`.slice(-2),MM:()=>(e.getMonth()<9?"0":"")+(e.getMonth()+1),M:()=>e.getMonth()+1,D:()=>e.getDate(),DD:()=>(e.getDate()<10?"0":"")+e.getDate(),H:()=>e.getHours(),HH:()=>(e.getHours()<10?"0":"")+e.getHours(),m:()=>e.getMinutes(),mm:()=>(e.getMinutes()<10?"0":"")+e.getMinutes(),s:()=>e.getSeconds(),ss:()=>(e.getSeconds()<10?"0":"")+e.getSeconds(),dddd:()=>this.weekday(e,!1),ddd:()=>this.weekday(e,!1,3),MMMM:()=>this.monthName(e,!1),MMM:()=>this.monthName(e,!1,3),W:()=>this.weekNumber(e,!0,!0),WW:()=>this.weekNumber(e,!0,!1)})}utcFormat(e,t){const i=this.correctDate(e);return Mustache.render(t,{YYYY:()=>i.getUTCFullYear(),YY:()=>`${i.getUTCFullYear()}`.slice(-2),MM:()=>(i.getUTCMonth()<9?"0":"")+(i.getUTCMonth()+1),M:()=>i.getUTCMonth()+1,D:()=>i.getUTCDate(),DD:()=>(i.getUTCDate()<10?"0":"")+i.getUTCDate(),H:()=>i.getUTCHours(),HH:()=>(i.getUTCHours()<10?"0":"")+i.getUTCHours(),m:()=>i.getUTCMinutes(),mm:()=>(i.getUTCMinutes()<10?"0":"")+i.getUTCMinutes(),s:()=>i.getUTCSeconds(),ss:()=>(i.getUTCSeconds()<10?"0":"")+i.getUTCSeconds(),dddd:()=>this.weekday(i,!0),ddd:()=>this.weekday(i,!0,3),MMMM:()=>this.monthName(i,!0),MMM:()=>this.monthName(i,!0,3),W:()=>this.weekNumber(i,!0,!0),WW:()=>this.weekNumber(i,!0,!1)})}formattedDate(e,t,i=!0,r=!0){let s=t||"";return s=s.replace("Y",e.getFullYear()),s=s.replace("m",(i&&e.getMonth()<9?"0":"")+(e.getMonth()+1)),s=s.replace("d",(i&&e.getDate()<10?"0":"")+e.getDate()),s=s.replace("H",(r&&e.getHours()<10?"0":"")+e.getHours()),s=s.replace("i",(r&&e.getMinutes()<10?"0":"")+e.getMinutes()),s=s.replace("s",e.getSeconds()),s=s.replace("l",this.weekday(e,!1)),s=s.replace("D",this.weekday(e,!1,3)),s=s.replace("F",this.monthName(e,!1)),s=s.replace("M",this.monthName(e,!1,3)),s}formattedUtcDate(e,t,i=!0,r=!0){const s=this.correctDate(e);let a=t||"";return a=a.replace("Y",s.getUTCFullYear()),a=a.replace("m",(i&&s.getUTCMonth()<9?"0":"")+(s.getUTCMonth()+1)),a=a.replace("d",(i&&s.getUTCDate()<10?"0":"")+s.getUTCDate()),a=a.replace("H",(r&&s.getUTCHours()<10?"0":"")+s.getUTCHours()),a=a.replace("i",(r&&s.getUTCMinutes()<10?"0":"")+s.getUTCMinutes()),a=a.replace("s",s.getUTCSeconds()),a=a.replace("l",this.weekday(s,!0)),a=a.replace("D",this.weekday(s,!0,3)),a=a.replace("F",this.monthName(s,!0)),a=a.replace("M",this.monthName(s,!0,3)),a}correctDate(e){return this.manipulateTime(e,this.isSummerTime(e)?this.timezone+1:this.timezone)}utcDate(e){return this.unmanipulateTime(e,this.isSummerTime(e)?this.timezone+1:this.timezone)}timestampToDate(e){return new Date(1e3*e)}toTimestamp(e){return Math.round(e.getTime()/1e3)}parseDate(e){const t=e.substr(0,4),i=e.substr(4,2)-1,r=e.substr(6,2),s=new Date(t,i,r),a=s.getFullYear()==t,o=s.getMonth()==i,n=s.getDate()==r;return a&&o&&n?s:"invalid date"}weekday(e,t=!1,i=9){return([this.str("sunday"),this.str("monday"),this.str("tuesday"),this.str("wednesday"),this.str("thursday"),this.str("friday"),this.str("saturday")][t?e.getUTCDay():e.getDay()]||"").substr(0,i)}monthName(e,t=!1,i=10){return([this.str("january"),this.str("february"),this.str("mars"),this.str("april"),this.str("may"),this.str("june"),this.str("july"),this.str("august"),this.str("september"),this.str("october"),this.str("november"),this.str("december")][t?e.getUTCMonth():e.getMonth()]||"").substr(0,i)}weekNumber(e,t=!1,i=!0){const r=new Date(e.valueOf()),s=((t?e.getUTCDay():e.getDay())+6)%7;r.setDate(r.getDate()-s+3);const a=r.valueOf();r.setMonth(0,1),4!==r.getDay()&&r.setMonth(0,1+(4-r.getDay()+7)%7);const o=1+Math.ceil((a-r)/6048e5);return(!i&&o<10?"0":"")+o}timestampToNiceDate(e,t=!1){const i={ago:t?"":this.str("ago"),now:this.str("now"),minute:t?this.str("min"):this.str("minutes"),minutes:t?this.str("min"):this.str("minutes"),hour:this.str("hour"),hours:this.str("hours"),day:this.str("day"),days:this.str("days")},r=(new Date).getTime(),s=new Date(1e3*e).getTime()-0,a=parseInt((r-s)/1e3/60,10);return a<60?a<1?i.now:1==a?`1 ${i.minute} ${i.ago}`:`${a} ${i.minutes} ${i.ago}`:a<1440?1==parseInt(a/60,10)?`1 ${i.hour} ${i.ago}`:`${parseInt(a/60,10)} ${i.hours} ${i.ago}`:parseInt(a/1440,10)<30?1==parseInt(a/1440,10)?`1 ${i.day} ${i.ago}`:`${parseInt(a/1440,10)} ${i.days} ${i.ago}`:this.format(this.timestampToDate(e),this.str("monthdayyear"))}isSummerTime(e){function t(e,t){const i=new Date,r=new Date(Date.UTC(t||i.getFullYear(),e+1,0)),s=r.getDay();return new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate()-s))}const i=e||new Date,r=t(2,i.getFullYear());r.setHours(1);const s=t(9,i.getFullYear());return r.setHours(1),i.getTime()>=r.getTime()&&i.getTime()<s.getTime()}manipulateTime(e,t){return new Date(e.getTime()+60*t*60*1e3)}unmanipulateTime(e,t){return new Date(e.getTime()-60*t*60*1e3)}}class p{static getAdnuntiusSettings(e,t,i,r,s){const a=(e.v1.config.get("contentbox_settings.adnuntiusAd.bidding")||{}).enabled||!1;function o(e,t){let i="";return a&&e.prebidConfig&&(i=JSON.parse(e.prebidConfig),Array.isArray(i)&&([i]=i),i=JSON.stringify(i)),{...e,prebidConfig:i,metadata:t.metadata||[]}}const n=e.v1.config.get("contentbox_settings.adnuntiusAd.formats")||[],l=e.v1.config.getView(`insertDynamic.${e.v1.model.root.getType().replace("page_","")}.${i.getViewport()}`,s.alias)||[],d=e.v1.model.query.getChildrenOfType(t,"adnuntiusAd",!0,!0),p=[];for(const e of l){const[t]=n.filter((t=>e.content_data.fields.format===t.format));t&&p.push(o(t,e))}for(const e of d){const[t]=n.filter((t=>e.get("fields.format")===t.format));t&&p.push(o(t,e))}const g=(new c).utcFormat(new Date,"&tag=week_{{ W }}_{{ YYYY }}");return{enabled:n.length>0,lazyload:e.v1.config.get("contentbox_settings.adnuntiusAd.lazyload")||!1,adUnits:p,spacingTop:e.v1.config.get("contentbox_settings.adnuntiusAd.spacingTop")||120,bidding:{enabled:a},hideOnTabletWidth:r.hideOnTabletWidth||1316,refreshdelay:e.v1.config.get("contentbox_settings.adnuntiusAd.refreshdelay")||5,refreshcount:e.v1.config.get("contentbox_settings.adnuntiusAd.refreshcount")||1,connectLoading:e.v1.config.get("contentbox_settings.adnuntiusAd.connectLoading")||!1,contkitEnabled:e.v1.config.get("contentbox_settings.adnuntiusAd.contkitEnabled")||!1,newsletter:{targeting:g}}}static getGoogleSettings(e,t,i,r,s){function a(e,t){const{sizes:i=[]}=e;return{...e,sizesString:`[${i.map((e=>`[${e.width},${e.height}]`)).join(", ")}]`,metadata:t.metadata||[]}}const o=e.v1.config.get("contentbox_settings.googleAd.formats")||[],n=e.v1.config.get("contentbox_settings.googleAd.anchor")||{enabled:!1,code:"",type:"TOP_ANCHOR"},l=e.v1.config.getView(`insertDynamic.${e.v1.model.root.getType().replace("page_","")}.${i.getViewport()}`,s.alias)||[],d=e.v1.model.query.getChildrenOfType(t,"googleAd",!0,!0),c=[];for(const e of l){const[t]=o.filter((t=>e.content_data.fields.format===t.format));t&&c.push(a(t,e))}for(const e of d){const[t]=o.filter((t=>e.get("fields.format")===t.format));t&&c.push(a(t,e))}return{enabled:o.length>0,lazyload:r.lazyload||!1,spacingTop:e.v1.config.get("contentbox_settings.googleAd.spacingTop")||120,adUnits:c,anchor:n,dfpid:r.dfpid||!1,debugmode:r.debugmode||!1,bidding:r.bidding,hideOnTabletWidth:r.hideOnTabletWidth||1316}}}class g{constructor({pageType:e="",canonical:t="",isTagpage:i=!1,isTagpageWithFrontpage:r=!1,tagpagePath:s="/tag/"}={}){this.settings={pageType:e,canonical:t,isTagpage:i,isTagpageWithFrontpage:r,tagpagePath:s},this.cache={seoData:null}}getStructuredData(e){return e.get("fields.jsonld_json")?e.get("fields.custom_jsonld"):"front"===this.settings.pageType?this.generateFrontData(e):"article"===this.settings.pageType?this.generateArticleData(e):null}generateSiteData(e){return{"@context":"http://schema.org","@type":"WebSite",name:lab_api.v1.properties.get("site.display_name"),url:lab_api.v1.properties.get("site.domain")||""}}generateFrontData(e){const t=this.getSEOData(e);return{"@context":"https://schema.org","@type":"WebPage",name:t.title,description:t.description}}generateArticleData(e){const t=this.getSEOData(e),i={"@context":"https://schema.org","@type":"NewsArticle",headline:t.title,description:t.description,availableLanguage:[{"@type":"Language",alternateName:t.language}],author:lab_api.v1.model.query.getChildrenOfType(e,"byline",!0).map((e=>{let t=e.get("fields.firstname");"Byline first name"===t&&(t="");let i=e.get("fields.lastname");"Byline last name"===i&&(i="");const r={"@type":"Person",name:`${t} ${i}`},s=e.get("fields.public_url");s&&(r.url=s);const a=(e.children||[]).filter((e=>"image"===e.type))[0];a&&(r.image={"@type":"ImageObject",url:`${a.get("fields.imageurl")}&width=250`});const o=e.get("fields.public_email");return o&&(r.email=o),r})),publisher:{"@type":"Organization",name:lab_api.v1.properties.get("site.display_name"),logo:{"@type":"ImageObject",url:lab_api.v1.config.get("logo.default.src")}}};return e.get("fields.published")&&(i.datePublished=new Date(1e3*parseInt(e.get("fields.published"),10)).toISOString()),e.get("fields.modified")&&(i.dateModified=new Date(1e3*parseInt(e.get("fields.modified"),10)).toISOString()),"1"===e.get("fields.paywall")&&(i.isAccessibleForFree=!0,i.hasPart={"@type":"WebPageElement",isAccessibleForFree:!1,cssSelector:".teaserContent"}),i}getSEOData(e){if(this.cache.seoData)return this.cache.seoData;let t,i,r;if("article"===this.settings.pageType)i=e.get("fields.seotitle")||e.get("fields.title")||"",r=e.get("fields.seodescription")||e.get("fields.subtitle")||"",t=e.get("fields.seolanguage")||lab_api.v1.config.get("contentLanguage");else{if(this.settings.isTagpage&&!this.settings.isTagpageWithFrontpage){const e=this.settings.tagpagePath.replace(/\//g,""),t=(this.settings.canonical.split(this.settings.tagpagePath)[1]||"").split("/").filter((e=>!!e)),r={tag:t[t.length-1],tags:t,tagPath:e};i=lab_api.v1.locale.get("tags.title_text",{data:r})}else i=e.get("fields.seotitle")||e.get("fields.name")||"";r=e.get("fields.seodescription")||""}return this.cache.seoData={title:i.charAt(0).toUpperCase()+i.slice(1),description:r,language:t},this.cache.seoData}}class u{static prepareForTemplate(e,t,i){const r={meta:{head_top:[],head_bottom:[]},script:{head_top:[],head_bottom:[],body_top:[],body_bottom:[]},link:{head_top:[],head_bottom:[]}},s=e.filter((e=>!(e.pageType&&e.pageType!==t||e.skipEditor&&i)));for(const e of Object.keys(r))for(const t of Object.keys(r[e]))r.meta[t]=s.filter((e=>"meta"===e.tag)).filter((e=>e.placement===t)).map((e=>this.createCustomTag(e))),r.script[t]=s.filter((e=>"script"===e.tag)).filter((e=>e.placement===t)).map((e=>this.createCustomTag(e))),r.link[t]=s.filter((e=>"link"===e.tag)).filter((e=>e.placement===t)).map((e=>this.createCustomTag(e)));return r}static createCustomTag(e){switch(e.tag){case"link":return this.createLinkTag(e);case"script":return this.createScriptTag(e);default:return this.createMetaTag(e)}}static fetchDynamicAttribute(e){return lab_api.v1.view.render({model:lab_api.v1.model.query.getRootModel(),template:e})||null}static parseAttributes(e){return e.filter((e=>!!e.key)).map((e=>e.value?`${e.key}="${e.value.match(/\{\{.*\}\}/g)?this.fetchDynamicAttribute(e.value):e.value}"`:e.key)).join(" ")}static parseVariables(e){return e.replace(/\{\{\{?.*?\}\}\}?/g,this.fetchDynamicAttribute)}static createLinkTag(e){return`<link ${this.parseAttributes(e.attributes)}>`}static createScriptTag(e){return`<script ${this.parseAttributes(e.attributes)}>${e.value?this.parseVariables(e.value):""}<\/script>`}static createMetaTag(e){return`<meta ${this.parseAttributes(e.attributes)}>`}}class h{constructor(e,t){this.api=e,this.page=t}set(e,t){const i=this.export(e,t);for(const t of Object.keys(i))e.setFiltered(t,i[t])}export(e,t){const i={},r=new Date,s=t.get("type").replace("page_",""),a=t.get("id"),n=this.api.v1.site.getSite().domain||this.api.v1.properties.get("customer_front_url"),d=n+t.get("fields.published_url"),c=encodeURIComponent(d),h=this.api.v1.properties.get("image_server"),f=this.api.v1.app.mode.isEditor(),m=this.getCanonicalUrl(e,s,a,n),b=this.api.v1.config.get("tagPagePath")||"/tag/",y="front"===s&&(d.endsWith(b.slice(0,-1))||d.indexOf(b)>-1),v=y&&!d.endsWith(b.slice(0,-1));i.customer_front_url=n,i.isEditMode=f,i.url=d,i.urlEncoded=c,i.specificUrl=m,i.image_server=h,i.pageType=s,i.is_article="article"===s,i.is_front="front"===s,i.section=t.get("primaryTags.section")||t.get("fields.defaultsection"),i.device=this.api.v1.viewport.getName(),i.cmsVersion=this.api.v1.properties.get("app.version"),i.front_api_url=this.api.v1.properties.get("front_api_url"),i.xUaDevice=this.api.v1.properties.get("xUaDevice"),i.favicons=this.api.v1.config.get("favicons"),i.faviconList=this.api.v1.config.get("faviconList"),i.skipDefaultFont=this.api.v1.config.get("skipDefaultFont"),i.isDebug=this.api.v1.util.request.hasQueryParam("debug"),i.staticUrl=this.getStaticUrl(e,s,a,n),i.customMetatags=this.getCustomMetatags(),i.customTags=u.prepareForTemplate(this.api.v1.config.get("customTags")||[],s,f),i.footerSettings=this.api.v1.config.get("page_settings.footer"),i.rssDescriptionPrefix=this.api.v1.config.get("viewports.rss.descriptionPrefix"),i.is_tagpage=y,i.contentLanguage=lab_api.v1.config.get("contentLanguage");const w=this.page.media.getLogo();i.logo=w.current,i.logo_sm=w.sm,i.misc=this.api.v1.config.get("misc");const _={active:!1,lang:this.api.v1.config.get("google_translate")};if(_.lang&&Array.isArray(_.lang)&&_.lang.length&&(_.active=!0),i.google_translate=_,i.social={facebook:`https://www.facebook.com/sharer.php?u=${c}`,twitter:`https://twitter.com/intent/tweet?url=${c}`,mail:`mailto:?subject=${encodeURIComponent(this.api.v1.util.string.stripTags(t.get("fields.title")))}&body=${encodeURIComponent(this.api.v1.util.string.stripTags(t.get("fields.subtitle")))}%0D${c}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${c}`,threads:`https://threads.net/intent/post?text=${c}`,copyLink:`navigator.clipboard.writeText("${d}");`,glimta:`https://glimta.com/unlock?link=${c}`,talandeWebb:"ReachDeck.panel.toggleBar();"},"article"===s){const t=this.api.v1.config.get("page_settings.article.ignoredTags")||[],r=this.api.v1.config.get("page_settings.article.ignoredTagPrefix")||[],s=(e.get("tags")||[]).filter((e=>!t.includes(e))).filter((e=>{for(const t of r)if(e.startsWith(t))return!1;return!0}));i.tagsString=s.toString();let a="";s.forEach(((e,t)=>{a+=`"${e.replace('"',"'")}"`,t<s.length-1&&(a+=", ")})),i.tagsStringCommaSeparated=a;const o=this.api.v1.model.query.getChildrenOfType(e,"byline",!0);if(o){const e=o.map((e=>`"${e.get("fields.firstname")} ${e.get("fields.lastname")}"`)).join(", ");i.bylinesStringCommaSeparated=e}}"article"===s&&e.get("fields.published")&&(i.published=new Date(1e3*parseInt(e.get("fields.published"),10)).toISOString(),i.publishedTimestamp=e.get("fields.published")),i.site=this.api.v1.site.getSite(),i.siteJSON=JSON.stringify(i.site),i["site.domain_no_protocol"]=i.site.domain.split("://").pop(),i.siteAlias=i.site.alias,i.fullUrl=i.site.domain,i[`site_is_${i.siteAlias}`]=!0;const k=this.page.resources;if(!f&&i.is_article&&this.api.v1.config.get("displayReadProgress.active")&&t.get("fields.displayReadProgress")&&(i.readProgress=k.scripts.getProgressReader()),i.siteStylesheetList=o.getSiteStylesWithFallback(i.siteAlias),Sys.logger.debug(`ViewSupport: Will include ${i.siteStylesheetList.length} configured stylesheet(s): "${i.siteStylesheetList.join(", ")}".`),i.siteFiles=k.scripts.getSiteFiles(e,t,i.siteAlias,s,f),i.modules=k.scripts.getModules(e,t,i.siteAlias,s,f),!f){i.analytics=k.analytics.get(),i.widgets={strossle:this.api.v1.config.get("widgets.strossle.strossle_id")},i.consent={cookieconsent:this.api.v1.config.get("consent.cookieconsent.show"),cookieconsent_culture:this.api.v1.config.get("consent.cookieconsent.culture")||"NB"},this.api.v1.config.get("cookieConsent.enabled")&&k.scripts.required.push({url:"/view-resources/public/common/cookieConsent.js",requireDom:!1}),"desktop"===this.api.v1.viewport.getName()&&t.get("fields.style_slidein")&&(i.style_slidein=!0,k.scripts.required.push({url:"/view-resources/public/common/SlideIn/SlideIn.js",requireDom:!1}));const r=this.api.v1.config.get("adEnvironment")||{},s="1"===t.get("fields.hideAds");if(!s&&r&&"adnuntius"===r.name)try{i.adnuntius=p.getAdnuntiusSettings(this.api,e,t,r,i.site)}catch(e){Sys.logger.warn(`[PageData] Failed to prepare Adnuntius ads: ${e.toString()}`)}if(!s&&r&&"google"===r.name)try{i.googleAds=p.getGoogleSettings(this.api,e,t,r,i.site)}catch(e){Sys.logger.warn(`[PageData] Failed to prepare Google ads: ${e.toString()}`)}}if(this.api.v1.util.request.hasQueryParam("fontpreview")&&(i.fontpreview=this.api.v1.util.request.getQueryParam("fontpreview"),i.analytics=null),i.page_settings=this.page.settings.get({pageType:s,socialLinks:i.social}),"article"===s){const r=this.api.v1.config.get("comments_provider.hideCommentsIfPaywall")||!1,o=this.api.v1.properties.get("paywall")||{},n=lab_api.v1.app.mode.isFront()&&o.active&&!o.hasAccess&&r,l=!1===f&&!1===n;if(t.get("fields.showcomments")&&!n){if(this.api.v1.config.get("comments_provider.facebook")){const e=this.api.v1.config.get("comments_provider.facebook.app_id");e&&(i.facebook={display:l,displayPlaceholder:f,appId:e,pageId:a,url:i.fullUrl+("article"===s?`/a/${a}`:"")},i.displayComments=!0)}if(this.api.v1.config.get("comments_provider.disqus")){const e=this.api.v1.config.get("comments_provider.disqus.enable"),t=this.api.v1.config.get("comments_provider.disqus.script");e&&(i.disqus={display:l,displayPlaceholder:f,canonical:m,pageId:a,script:t},i.displayComments=!0)}const t=this.api.v1.config.get("comments_provider.commento");t&&t.enable&&(i.commento={display:l,displayPlaceholder:f,canonical:m,usePageId:t.usePageId,pageId:a,script:t.script,cssOverride:t.cssOverride,descriptionText:t.descriptionText},i.displayComments=!0);const r=lab_api.v1.config.get("comments_provider.hyvor");if(r&&r.websiteId){const t=e.get("fields.published")||0;i.hyvor={display:l,displayPlaceholder:f,websiteId:r.websiteId,pageId:t>1646908200&&a},r.hidePageIdBeforeDate&&t<r.hidePageIdBeforeDate&&(i.hyvor.pageId=""),i.displayComments=!0}const o=lab_api.v1.config.get("comments_provider.ifragasatt");o&&(i.ifragasatt={display:l,displayPlaceholder:f,customerId:o.customer_id,articleId:`article${a}`},i.displayComments=!0)}}i.menus=this.page.menus.get({defaultSection:t.get("fields.defaultsection"),section:t.get("primaryTags.section")}),i.style_definitions=l.getStyleDefinitions(this.api),i.css_build=l.getInlineCSS(this.api),i.contact=this.api.v1.config.get("contact");const x=!!t.get("fields.norobots"),P=t.get("fields.hidefromfp_time"),C=Math.round(r.getTime()/1e3);if(i.norobots=x||P&&P<=C||!1,"article"===s&&this.api.v1.config.get("embeddable.active")){k.scripts.required.push({url:"/view-resources/public/common/embedThis.js",requireDom:!0});const e=this.api.v1.config.get("embeddable.sitelink")||{};i.embeddable={active:!0,display:!!t.get("fields.displayEmbedButton"),isFullContent:this.api.v1.util.request.getQueryString().indexOf("lab_content=full")>-1,sitelink:{prefix:e.prefix,postfix:e.postfix}}}Sys.logger.debug(`ViewSupport: Will include ${k.scripts.required.length} configured script(s): "${k.scripts.required.map((e=>e.url)).join(", ")}".`),k.scripts.required.forEach((e=>{if(!e.placeholderKey&&e.requireDom&&(e.placeholderKey="requireDom"),e.placeholderKey){const{placeholderKey:t}=e;e.placeholderKey={},e.placeholderKey[t]=!0}})),i.siteScriptList=k.scripts.required,i.paywall=this.getPaywallInfo(e,f);const M=new g({pageType:s,canonical:m,isTagpage:y,isTagpageWithFrontpage:v,tagpagePath:b}),S=M.generateSiteData(e),T=M.getStructuredData(e);i.jsonld=JSON.stringify([S,T]);const $=M.getSEOData(e);if(i.seotitle=$.title,i.seodescription=$.description,i.seolanguage=$.language,"article"===s){const t=e.get("fields.sometitle")||e.get("fields.teaserTitle")||e.get("fields.title");t&&(i.sometitle=this.api.v1.util.string.stripTags(t));const r=e.get("fields.somedescription")||e.get("fields.teaserSubtitle")||e.get("fields.subtitle");if(r&&r.length>0)i.somedescription=this.api.v1.util.string.stripTags(r);else{let t=e.get("fields.bodytext")||"";t=this.api.v1.util.string.stripTags(t),i.somedescription=`${t.substring(0,100)} ...`}}else if("front"===s){const t=e.get("fields.someimage");null!=t&&""!==t&&(i.someimage=`${h}/${t}.webp?width=1200&height=630`),i.sometitle=e.get("fields.sometitle")||e.get("fields.name"),i.somedescription=e.get("fields.somedescription")||""}if(i.simplestreamEnabled=lab_api.v1.config.get("contentbox_settings.simplestream")||!1,"mailmojo"===i.device&&this.setDefaultMailmojoData(e,t),"article"===s){const t=lab_api.v1.config.get("page_settings.article.ageWarnings");if(Array.isArray(t)){const i=e.get("fields.published");if(i){const r=this.getAgeWarningItem(i,t);r&&e.setFiltered("ageWarning",r)}}}return i.featureFlags={responsive_mobile_fonts:!lab_api.v1.util.featureFlags.enabled("Disable responsive mobile fonts",s)},i}getAgeWarningItem(e,t){const i=Object.values(t).filter((e=>!!e.years&&!!e.label)).sort(((e,t)=>t.years-e.years)),r=new Date(1e3*e),s=Date.now()-r,a=new Date(s),o=Math.abs(a.getUTCFullYear()-1970);for(const e of i)if(o>=e.years)return e;return null}setDefaultMailmojoData(e,t){const i=lab_api.v1.config.get("lang")||"no";e.setFiltered("lang",i)}getCanonicalUrl(e,t,i,r){const s=e.get("fields.lab_canonical");if(s)return s;if("front"===t){const t=e.get("fields.hostpath");if(t)return`${r}/${"index"===t?"":t}`}return`${r+e.get("fields.published_url")}`}getStaticUrl(e,t,i,r){if("front"===t){const t=lab_api.v1.util.request.getHeader("X-Labrador-404-Referer");if(t)return`${r}${t}`;const i=e.get("fields.hostpath");return i?`${r}/${"index"===i?"":i}`:`${r+e.get("fields.published_url")}`}return`${lab_api.v1.properties.get("site").domain}/a/${i}`}getCustomMetatags(){const e=lab_api.v1.config.get("customMetatags")||[],t=lab_api.v1.config.get("customMetatagsKeyVal")||[],i=[];for(const t of e){const e=Object.keys(t).map((e=>({key:e,value:t[e]})));i.push(e)}for(const e of t)e.length&&i.push(e);return i}getPaywallInfo(e,t){const i=lab_api.v1.properties.get("paywall"),r=!t&&"1"===e.get("fields.paywall");return{enabled:r,settings:i,hasAccess:!r||!i.active||i.hasAccess,hidePaywallOffers:"paywall_loginonly"===this.api.v1.util.request.getQueryParam("lab_opts"),requiredProducts:JSON.stringify(this.api.v1.properties.get("app.paywall.requiredProducts")||[])}}}class f{static parseCss(e,t="filtered.autodata"){const i=e.get(t);if(i&&"object"==typeof i)return[Object.values(i.cssObject||{}).join(" "),i.cssString||"",(i.cssArray||[]).join(" ")].join(" ").trim()}static parseAttributes(e){const t=e.get("filtered.autodata.attributesObject");if(t&&"object"==typeof t)return Object.keys(t).map((e=>({key:e,value:t[e]})))}static parseCustomData(e){const t=e.get("filtered.autodata.custom");if(!t||"object"!=typeof t)return;const i={};for(const e of Object.keys(t))i[e]=Object.keys(t[e]).map((i=>({key:i,value:t[e][i]})));return i}static parseCustomDataFromFeed(e,t){const i=lab_api.v1.config.get(`${t}.autodata.mapping`)||{};if(!i||"object"!=typeof i)return;const r={labels:[]};if(i.labels)for(const t of Object.keys(i.labels))e[i.labels[t]]&&r.labels.push({key:t,value:e[i.labels[t]]});return r}}class m{constructor(e){this.api=e,this.pageData=new h(this.api,new n(this.api))}onReady(e,t){this.pageData.set(e,t),e.setFiltered("autodata_css",f.parseCss(e)),e.setFiltered("autodata_attributes",f.parseAttributes(e)),e.setFiltered("autodata_custom",f.parseCustomData(e))}}class b{constructor(e){this.api=e,this.pageData=new h(this.api,new n(this.api))}onReady(e,t){this.pageData.set(e,t)}}class y{static textElements(e,t){const i={top:[],floating:[],bottom:[],positions:{kicker:""}};return e.get("metadata.showKicker")&&(t||e.get("fields.kicker")||e.get("fields.origin_data_json.teaserKicker")||e.get("fields.origin_data_json.kicker"))&&(e.get("metadata.floatingKicker")?(i.floating.push("kicker"),i.positions.kicker="floating"):e.get("metadata.kickerBelowImage")?(i.bottom.push("kicker"),i.positions.kicker="below"):(i.top.push("kicker"),i.positions.kicker="above")),e.get("metadata.hideTitle")||!t&&!e.get("fields.title")||(e.get("metadata.floatingTitle")?i.floating.push("title"):e.get("metadata.titleAboveImage")?i.top.push("title"):i.bottom.push("title")),!e.get("metadata.hidesubtitle")&&(t||e.get("fields.subtitle")||e.get("fields.origin_data_json.teaserSubtitle"))&&(e.get("metadata.floatingSubtitle")?i.floating.push("subtitle"):e.get("metadata.subtitleAboveImage")?i.top.push("subtitle"):i.bottom.push("subtitle")),i}}class v{constructor(e){this.api=e,this.imageServer=this.api.v1.properties.get("image_server"),this.domain=this.api.v1.site.getSite().domain||this.api.v1.properties.get("customer_front_url")}onReady(e,t){e.setFiltered("layout",y.textElements(t,this.api.v1.app.mode.isEditor()));let i=e.get("fields.published_url")||"";!/^https?/.test(i)&&i&&(i=this.domain+i),e.setFiltered("published_url",i),e.setFiltered("published_url_rss",i.replace(/&/g,"&amp;"))}onRender(e,t){const i=e.get("instance_of")||e.get("fields.origin_data_json.id"),r=e.get("fields.published")||e.get("fields.origin_data_json.published"),s=e.get("fields.origin_data_json.teaserTitle")||t.get("fields.title")||"",a=e.get("fields.origin_data_json.teaserSubtitle")||t.get("fields.subtitle")||"",o=e.get("fields.origin_data_json.published")||e.get("fields.published"),n=e.get("fields.origin_data_json.teaserKicker")||e.get("fields.origin_data_json.kicker")||t.get("fields.kicker"),l=e.get("fields.site_id")||e.get("fields.origin_data_json.site_id");e.setFiltered("published",r),e.setFiltered("title",s),e.setFiltered("kicker",n),e.setFiltered("subtitle",a),e.setFiltered("articleId",i),e.setFiltered("section",e.get("fields.origin_data_json.section_tag")||e.get("fields.section")||""),e.setFiltered("base_url",this.domain),e.setFiltered("published_sitemap",o),e.setFiltered("canonical_url",`${this.getSiteDomain(l)}/a/${i}`),e.setFiltered("tags",e.get("tags")||[]);const d=(new Date).getTime()-1728e5;if(e.setFiltered("articleOutOfDate_sitemap",d>Math.floor(new Date(o).getTime())),!this.api.v1.config.get("showHiddenTagsOnFront")){const t=(this.api.v1.config.get("tagsToHide")||"").split(",").map((e=>e.trim()))||[],i=(e.get("tags")||[]).filter((e=>!t.includes(e)));e.setFiltered("tags",i)}if(l){const t=this.api.v1.site.getSiteById(l);t&&e.setFiltered("site_alias",t.alias)}const c=e.get("fields.origin_data_json.showbylineonfp")||t.get("fields.displayByline")||!1;if(c){const i=t.get("fields.byline")||e.get("fields.origin_data_json.byline"),r=t.get("fields.bylineImage")||e.get("fields.origin_data_json.bylineImage"),s=(e.get("fields.origin_data_json.full_bylines")||e.get("fields.full_bylines_json")||[]).map((e=>({firstname:e.firstname,lastname:e.lastname,imageUrl:e.imageUrl?this.getImageUrl(`${e.imageUrl}&width=30&height=30`):""})));s.length||!i&&!r||s.push({firstname:i,lastname:"",imageUrl:r?this.getImageUrl(`${r}&width=30&height=30`):""}),e.setFiltered("bylines",s),r&&e.setFiltered("bylineImage",`${r}&width=30&height=30`)}e.setFiltered("displayByline",c);let p=e.get("fields.origin_data_json.paywall")||e.get("fields.paywall")||!1;if(p=1===p||"1"===p||!0===p||null,p){const i={text:{content:"Pluss"},icon:{content:"fi-plus"},display:!0,displayInNewsletter:!0,...this.api.v1.config.get("paywall.label")};if(i.display){i.layout={noImage:!0,float:null};const r=this.api.v1.model.query.getChildOfType(e,"image")||this.api.v1.model.query.getChildOfType(e,"graphic");if(r){const e=this.api.v1.view.getView(r,t.getViewport());i.layout.float=e.get("fields.float")||null,i.layout.noImage=!!t.get("metadata.hideimage")}e.setFiltered("paywallLabel",i)}}else e.setFiltered("paywallLabel",null);e.setFiltered("paywall",p);const g=e.get("metadata.sectionPlacement")||"floating";e.setFiltered("sectionPlacement.floating","floating"===g),e.setFiltered("sectionPlacement.underImage","underImage"===g),e.setFiltered("sectionPlacement.underText","underText"===g),e.setFiltered("articleWidth",t.getPixelWidth()),e.setFiltered("autodata_css",f.parseCss(e)),e.setFiltered("autodata_content_css",f.parseCss(e,"filtered.autodata_content")),e.setFiltered("autodata_attributes",f.parseAttributes(e)),e.setFiltered("autodata_custom",f.parseCustomData(e))}onId(e){const t=e.get("fields.published");if(t){const i=new Date(t).getTime();if(i>(new Date).getTime()){let r=this.api.v1.model.query.getParentOfType(e,"row");if(!r)return;const s=this.api.v1.model.query.getParentOfType(r,"row");s&&(r=s);const a=r.get("metadata.visibleAfterDate")||new Date(t).toISOString();new Date(a).getTime()<=i&&(r.set("metadata.visibleAfterDate",new Date(t).toISOString()),this.api.v1.model.highlight.message(r,"Publish-date updated for row"))}}}getSiteDomain(e){if(!e)return"";const t=this.api.v1.site.getSiteById(e);return t?t.domain:""}getImageUrl(e){return e?e.startsWith("http")?e:this.imageServer+e:""}}class w{constructor(e){this.api=e,this.isEditor=this.api.v1.app.mode.isEditor(),this.isFragmentMode=this.api.v1.app.mode.isFragmentMode(),this.lazyloadImages=!this.isEditor&&!!this.api.v1.config.get("imageLoading.lazy")}check(e,t){if(!this.lazyloadImages||t.getProperty("image.noLazy"))return!1;const i=lab_api.v1.model.query.getParentOfType(e,"row");return!(i&&!this.isFragmentMode&&i.getModelIndex()<5)}}class _{constructor(e){this.api=e,this.lazyloadHelper=new w(e),this.api.v1.app.mode.isEditor()&&(this.cropIds=[],this.rootModel=this.api.v1.model.query.getRootModel(),this.frontcropBinding=this.frontCropChanged.bind(this),this.api.v1.model.bindings.bind(this.rootModel,"frontCrop",this.frontcropBinding),this.frontcropBinding(this.rootModel,"frontCrop",this.rootModel.get("frontCrop")),this.api.v1.ns.set("imageFilter.preview",this.prepareVisualFilters)),this.isFragmentMode=this.api.v1.app.mode.isFragmentMode()}onViewHelper(e,t){if(e.parent){this.prepareForSlideshow(e,t);const i=t.getViewport();if(this.api.v1.view.getView(e.parent,i).get("metadata.hasFullWidth")){const t="mobile"===i?600:1800;e.setFiltered(`width.${i}`,t)}else e.setFiltered(`width.${i}`,null);e.setFiltered("allowFullwidth","image"!==e.parent.getType())}}onRender(e,t){this.setVisualFilters(e,t),e.setFiltered("lazyloadImages",this.lazyloadHelper.check(e,t)),this.setCaptionOptions(e.getParent(),e,t);const i=t.get("fields.float");e.setFiltered("hasFloat",!!i&&"floatNone"!==i)}onRendered(e,t){if(!this.api.v1.app.mode.isEditor()||!this.cropIds.length)return;const i=parseInt(e.get("instance_of"),10);this.cropIds.includes(i)&&this.markFrontCrop(t,i)}setVisualFilters(e,t){e.setFiltered("filters",this.prepareVisualFilters(e,t))}prepareVisualFilters(e,t,i=!1){const r=[],s=e.get("metadata.filter_blur_active")?e.get("metadata.filter_blur_value")||0:null,a=e.get("metadata.filter_sepia_active")?e.get("metadata.filter_sepia_value")||0:null,o=e.get("metadata.filter_saturate_active")?e.get("metadata.filter_saturate_value")||1:null,n=e.get("metadata.filter_brightness_active")?e.get("metadata.filter_brightness_value")||1:null,l=e.get("metadata.filter_contrast_active")?e.get("metadata.filter_contrast_value")||1:null;return null!==s&&r.push(`blur(${s}px)`),null!==a&&r.push(`sepia(${a})`),null!==o&&r.push(`saturate(${o})`),null!==n&&r.push(`brightness(${n})`),null!==l&&r.push(`contrast(${l})`),i?{filter:r.join(" ")}:r.length?`filter: ${r.join(" ")};`:null}markFrontCrop(e,t){const i=document.createElement("span");i.classList.add("labicon-imgFrontCrop","is-frontcrop"),i.setAttribute("title","Image used as front crop. Click to edit"),i.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),this.api.v1.apps.start("ArticleSettings")}),!1),e.getMarkup().appendChild(i)}frontCropChanged(e,t,i){let r=this.getImages(this.cropIds);this.cropIds=[],this.updateImages(r),i&&(i.pano&&i.pano.instance_of&&this.cropIds.push(i.pano.instance_of),i.height&&i.height.instance_of&&!this.cropIds.includes(i.height.instance_of)&&this.cropIds.push(i.height.instance_of),r=this.getImages(this.cropIds),this.updateImages(r))}getImages(e){const t=[];for(const i of e)t.push(...this.api.v1.model.query.getModelsByKeyAndValue("instance_of",i));return t}updateImages(e){for(const t of e)this.api.v1.model.addToRedrawQueue(t)}setCaptionOptions(e,t,i){const r=e?this.api.v1.view.getView(e,i.getViewport()):null,s=(e,t,i)=>{if(e){const t=e.get(i);if(!t&&null!==t)return!1;if(t)return!0}return!!t.get(i)};let a=s(r,i,"fields.displayCaption"),o=a||null===i.get("fields.displayCaption")&&!i.get("metadata.hidecaption");!this.api.v1.app.mode.isFront()||t.get("fields.imageCaption")||t.get("fields.byline")||(a=!1,o=!1);const n=s(r,i,"fields.expandableCaption"),l=s(r,i,"fields.truncateCaption");let d=t.get("fields.imageCaption");!t.parent||i.getProperty("image.useCaptionForTitle")&&d||(d=t.parent.get("fields.title")||"");const c={title:d,display:a,displayDefault:o,truncate:l,expandable:n||l};t.setFiltered("captionOptions",c)}prepareForSlideshow(e,t){if(!e.parent||"slideshow"!==e.parent.getType())return;if(t.get("fields.whRatio"))return void e.setFiltered("whRatio",null);const i=e.get("fields.originalWidth"),r=e.get("fields.originalHeight");if(r&&i){const t=r/i;e.setFiltered("whRatio",t)}}}class k{constructor({path:e=null,selector:t=null,data:i={},options:r={}}={}){this.path=e,this.selector=t,this.data=i,this.options={persistentTarget:!0,intermediate:{useExisting:!0},...r}}}class x{constructor({key:e=null,path:t=null,selector:i=null,placeholder:r=null,metadata:s={},options:{shouldInsert:a=!0,wrap:o=null,skipIfOutOfBounds:n=!1,useIndex:l=!1,useBodyTextIndex:d=!1,useBodyTextHeadingIndex:c=!1,lastBodyTextHeading:p=!1}={}}={}){this.key=e,this.path=t,this.selector=i,this.placeholder=r,this.metadata=s,this.options={shouldInsert:a,wrap:o,skipIfOutOfBounds:n,useIndex:l,useBodyTextIndex:d,useBodyTextHeadingIndex:c,lastBodyTextHeading:p}}}class P{constructor({type:e=null,contentdata:t=null,content_data:i=null,cssSettings:r={},children:s=[],metadata:a={}}={}){this.type=e,this.contentdata=t||i,this.children=s,this.metadata={...a},this.state={};const o=[];this.metadata.css&&o.push(this.metadata.css);for(const e of Object.keys(r))r[e]&&o.push(e);this.metadata.css=o.join(" ")}}class C{constructor(e){this.api=e,this.page=this.api.v1.model.query.getRootModel(),this.pageType=this.api.v1.model.root.getType().replace("page_",""),this.viewports=this.api.v1.viewport.getActive(),this.isEditor=this.api.v1.app.mode.isEditor(),this.cache=new Map}insert(e,t=null){const i=`insertDynamic.${this.pageType}.${e}`,r=`placements.${this.pageType}.${e}`;if(!this.cache.has(i)){const e=this.isEditor?(this.api.v1.config.get(i)||[]).filter((e=>!e.dynamicDataSettings||!e.dynamicDataSettings.hideInEditMode)):this.api.v1.config.get(i)||[];this.cache.set(i,e.map((e=>e)))}if(!this.cache.has(r)){const e=this.api.v1.config.get(r)||[];this.cache.set(r,e.map((e=>new x(e))))}const s=this.parse(this.cache.get(i),this.cache.get(r),e,t);for(const e of s)e.selector?this.api.v1.model.insert.bySelector({selector:e.selector,data:e.data,options:e.options}):e.path&&this.api.v1.model.insert.atPath({path:e.path,data:e.data,options:e.options})}parse(e=[],t=[],i="desktop",r=null){const s=[];for(const a of e){const[o]=t.filter((({key:e})=>e===a.placement.key));if(o)if(this.acceptPath(o.path,r)){const t=this.create(a,o,e,i);null!==t&&(t.data.metadata.viewportBlacklist=this.viewports.filter((e=>e!==i)),s.unshift(t))}else Sys.logger.debug(`[DynamicDataHelper]: Path "${o.path}" not allowed. Filter: "${r}", key: "${a.placement.key}"`);else Sys.logger.debug(`[DynamicDataHelper]: No placement found with key "${a.placement.key}"`)}return s}create(e,t,i,r="desktop"){if(this.filter(e)){const s=this.assemble(e,t);t.path&&t.selector&&(this.api.v1.model.query.getModelBySelector(t.selector)||this.api.v1.model.insert.atPath({path:t.path,data:{type:"placeholder",selector:t.selector,metadata:{...t.metadata||{},key:t.key},state:{isNonPersistent:!0}},options:{index:0,useExisting:!0,prepend:!0,silent:!0}}));const a={...e.options,prepend:!0,silent:!0};let{path:o}=t,n=e.placement.index||0,l=null;if(t.selector)l=this.api.v1.model.query.getModelBySelector(t.selector);else if(t.path){const e=this.getModelsByPath(t.path,r);e.length&&(l=t.options.useBodyTextIndex||t.options.useBodyTextHeadingIndex||t.options.lastBodyTextHeading?e.find((e=>"bodytext"===e.getType())):t.options.shouldInsert?e[0].children[n]:e[n])}if(l||!t.options.skipIfOutOfBounds){if(l){n=this.api.v1.model.query.getIndex(l);let e=l.getParent();if("mobile"===r){if(n>0&&n<e.children.length){let t=e.children[n];for(;t;){const i=l.get("width",r,!0);if(void 0===i||100===i)break;t=e.children[++n]}}e.get("metadata.hasRowTitle")&&(0===n||n>=e.children.length)&&(l=e,e=l.getParent(),n=this.api.v1.model.query.getIndex(l),o=e.getPositionedPath())}if(t.options.useIndex&&n<e.children.length)if(e.children[n-1]&&e.children[n-1].getNoRenderState()){if(i[n+1]&&i[n+1].placement.index===n+1)return null;a.index=n+1}else a.index=n;t.options.shouldInsert||(o=e.getPositionedPath())}else a.prepend=!1;return new k({data:s,options:a,selector:t.selector,path:o})}}return null}assemble(e,t){let i=new P(e);return t.selector||(i.metadata={...i.metadata,...t.metadata,css:t.metadata.css?`${i.metadata.css} ${t.metadata.css}`:i.metadata.css||""}),t.options.wrap&&(i=new P({type:t.options.wrap.type,metadata:t.options.wrap.metadata,children:[i]})),t.options.skipIfOutOfBounds&&(i.metadata.skipIfOutOfBounds=!0),t.options.useBodyTextIndex?i.metadata.bodyTextIndex=e.placement.index||0:t.options.useBodyTextHeadingIndex&&(i.metadata.bodyTextHeadingIndex=e.placement.index||0),t.options.lastBodyTextHeading&&(i.metadata.lastBodyTextHeading=!0),i.state.isNonPersistent=!0,i}acceptPath(e,t){return!e||!t||e===t}filter(e){const t=this.page.get("fields.hideAds");return"googleAd"!==e.type&&"adnuntiusAd"!==e.type||"1"!==t&&!0!==t}getModelsByPath(e,t){const i=`getByPath-${e}`;return this.cache.has(i)||this.cache.set(i,(this.api.v1.model.query.getModelsByPath(e)||[]).filter((e=>!e.get("metadata.hideViewport",t)&&!e.isNonPersistent()))),this.cache.get(i)}}class M{constructor(e){this.api=e,this.request=this.api.v1.util.request}listen(){const e={selector:this.request.getQueryParam("lab_selector")||"contentFromPath",path:this.request.getQueryParam("lab_path"),guid:this.request.getQueryParam("lab_guid")};(e.guid||e.path)&&this.api.v1.model.on("insert",(t=>{const i=e.guid?this.getModelByGuid(e.guid,t):this.getModelByPath(e.path,t);if(i)return Sys.logger.debug(`[FragmentHelper] Element found. Path: ${i.getPositionedPath()}, GUID: ${i.getGuid()}.`),i.setSelector(e.selector),"embed"===lab_api.v1.viewport.getName()?this.appendToRoot(t,i):[i]}))}getModelByGuid(e){return Sys.logger.debug(`[FragmentHelper] Will filter elements by guid: "${e}".`),this.api.v1.model.query.getModelByGuid(e)}getModelByPath(e,t){Sys.logger.debug(`[FragmentHelper] Will filter elements by path: "${e}".`);const i=this.api.v1.util.string.parsePath(e);if(!i[0])return null;const r=this.api.v1.model.query.getModelsByType(i[0].base,t);return this.api.v1.model.query.getModelByPath(e,!0,!1,r)}appendToRoot(e,t){const i=e[0];return i.children=[t],[i]}}class S{constructor(e){this.api=e,this.paths={main:["parent","guid","type","tags"],fields:["feedId","byline","bylineImage","paywall","published","published_url","site_alias","site_id","subtitle","subtitleHTML","teaserSubtitle","somedescription","title","teaserTitle","titleHTML","seolanguage","seotitle","sometitle","kicker","teaserKicker","showcomments"],fieldsAuto:["section_tag","tags"],fieldsNative:["section"],fieldMap:{subtitle:"description",subtitleHTML:"descriptionHTML",somedescription:"someDescription",teaserSubtitle:"teaserDescription",seolanguage:"seolanguage",seotitle:"seoTitle",sometitle:"someTitle",published_url:"url",section_tag:"section"},fallback:{url:"url"}},this.frontUrl=this.api.v1.site.getSite().domain||this.api.v1.properties.get("customer_front_url"),this.imageServer=this.api.v1.properties.get("image_server")}jsonData(e){Sys.logger.debug("[PageExport] Will export page as JSON-data");const t=this.api.v1.model.serialize.model(e);return delete t.guid,{page:t,result:"page_article"===e.getType()?this.exportArticle():this.exportFront()}}exportArticle(){}exportFront(){const e=this.api.v1.model.query.getModelByType("dropZone");return this.api.v1.model.query.getModelsByType("article",[e]).map((e=>this.serialize(e))).filter((e=>!!e))}serialize(e){const t=this.api.v1.model.serialize.model(e);if(!t||!t.fields)return null;const i=!!t.fields.origin_data_json,r={images:[],width:e.getWidth("desktop"),metadata:t.metadata,isAutomatic:i,siteDomain:this.frontUrl},s=i?t.fields.origin_data_json:t.fields,a=[...this.paths.fields,...i?this.paths.fieldsAuto:this.paths.fieldsNative];for(const e of this.paths.main)r[e]=t[e]||"";for(const e of a)r[this.paths.fieldMap[e]||e]=s[e]||"";if(r.teaserSubtitle=s.teaserSubtitle||"",i){if(!r.byline){const e=(s.full_bylines||[]).shift();r.byline=e?`${e.firstname} ${e.lastname}`:"",r.bylineImage=r.bylineImage||(e||{}).imageUrl}"string"==typeof r.tags&&(r.tags=r.tags.split(",").map((e=>(e||"").trim()))),r.site_alias=(this.api.v1.site.getSiteById(s.site_id)||{}).alias,r.id=parseInt(s.id,10)}else r.titleHTML=r.title,r.title=this.cleanText(r.title),r.descriptionHTML=r.description,r.description=this.cleanText(r.description),r.kickerHTML=r.kicker,r.kicker=this.cleanText(r.kicker),r.id=t.id;r.section_tag=r.section,r.url&&!r.url.startsWith("http")&&(r.url=this.frontUrl+r.url);for(const e of Object.keys(this.paths.fallback))r[e]||(r[e]=s[this.paths.fallback[e]]||"");r.full_bylines=(i?s.full_bylines:s.full_bylines_json)||[],r.full_bylines=r.full_bylines.map((e=>({firstname:e.firstname,lastname:e.lastname,imageUrl:this.getImageUrl(e.imageUrl)}))),i&&r.byline&&r.full_bylines.unshift({firstname:r.byline,lastname:"",imageUrl:this.getImageUrl(r.bylineImage)}),!r.byline&&r.full_bylines.length&&(r.byline=`${r.full_bylines[0].firstname} ${r.full_bylines[0].lastname}`,r.bylineImage=r.full_bylines[0].imageUrl.replace(this.imageServer,""));const o=lab_api.v1.config.get("customAdapterFields.article")||[];if(o)for(const e of o)if(e){let i=t.fields[e]||"";!i&&t.fields.origin_data_json&&(i=t.fields.origin_data_json[e]||""),i&&(r[e]=i)}r.paywall="0"!==r.paywall&&!!r.paywall;const n=this.api.v1.model.query.getChildOfType(e,"image");if(n){const e=n.get("filtered.image");e&&r.images.push({url:e,jpg:`${e}&format=jpg`,webp:`${e}&format=webp`,url_size:e,default:"1",id:n.get("instance_of")})}return r}cleanText(e){return this.api.v1.util.string.sanitizeString(e).replace(/&amp;/g,"&")}getImageUrl(e){return e?e.startsWith("http")?e:this.imageServer+e:""}}class T{constructor(e){this.api=e}register(e,t){if(this.api.v1.app.mode.isFragmentMode())return void Sys.logger.debug("[EsiHelper] Labrador is is fragment-mode. Will not register ESI. Skipping.");if(!e)return void Sys.logger.debug("[EsiHelper] Missing model, cannot process. Skipping.");const i=this.api.v1.config.get("footer.include");if(i&&i.pageId){const t=this.getEsiUrl(i);t?"client"===i.render?e.setFiltered("renderFooter.url",t):this.insertEsi(e,t,"esi_footer"):Sys.logger.warning("[EsiHelper] Cannot prepare url for footer-fragment. Missing url.")}const r=this.api.v1.config.get("header.include"),s=this.api.v1.config.get("header.includes")||[],a=[];if(r&&r.pageId){const t=this.insertHeader(r,e);t&&a.push(t)}for(const t of s)if(t&&t.pageId){const i=this.insertHeader(t,e);i&&a.push(i)}e.setFiltered("renderHeader.urls",a.map((e=>`'${e}'`)).join(", "))}getEsiUrl(e){if(!e.pageId)return null;const t=["pageId","path","structureType","start","count"],i=[];if(t.forEach((t=>{void 0!==e[t]&&""!==e[t]&&null!==e[t]&&i.push(`${t}=${e[t]}`)})),i.length===t.length){let e=this.api.v1.properties.get("front_api_url");return this.api.v1.app.mode.isEditor()&&"https:"===document.location.protocol&&(e=e.replace("http:","https:")),`${e}/fragment/structure/?${i.join("&")}`}return null}insertEsi(e,t,i){Sys.logger.debug(`[EsiHelper] Will insert fragment for selector: "${i}", url: "${t}".`),this.api.v1.model.insert.atPath({path:e.getPath(),data:{type:"esi",selector:i,contentdata:{fields:{url:t,identifier:i}},state:{isNonPersistent:!0}},options:{frontpage:!0,articlepage:!0}}),this.api.v1.app.mode.isEditor()&&this.fetchEditorEsi(t,`${i}`)}insertHeader(e,t){const i=this.getEsiUrl(e);if(i){if("client"===e.render)return Sys.logger.debug(`[EsiHelper] Found url for header-fragment to render in client: "${i}".`),i;this.insertEsi(t,i,"esi_header")}else Sys.logger.warning("[EsiHelper] Cannot prepare url for header-fragment. Missing url.");return null}fetchEditorEsi(e,t){this.api.v1.view.on("domRendered",((i,r)=>{const s=this.api.v1.model.query.getModelBySelector(t);s&&(Sys.logger.debug(`EsiHelper.fetchEditorEsi: Will fetch esi-substitute for editor. Selector: ${t}, url: ${e}`),this.api.v1.util.httpClient.get(e,{credentials:"omit",type:"text"}).then((e=>{const i=lab_api.v1.view.getView(s,r),a=document.createElement("template");if(a.innerHTML=e,Sys.logger.debug(`EsiHelper.fetchEditorEsi: Esi-substitute fetched. Selector: ${t}, element-count: ${a.content.children.length}`),i.markup){for(const e of[...a.content.children])i.markup.parentElement.insertBefore(e,i.markup);i.markup.remove()}else Sys.logger.warn(`EsiHelper.fetchEditorEsi: Element markup not found. Cannot insert dom-element(s). Selector: ${t}`)})).catch((e=>{Sys.logger.warning(`EsiHelper.fetchEditorEsi: Esi-substitute could not be fetched. Selector: ${t}, error: ${e}`)})))}))}}class ${static mediaQueries={desktop:"(min-width:1024px)",mobile:"(max-width: 1023px)"};static createStyle({model:e,view:t,viewports:i,styleCollection:r="content_inline_spacing",mediaQueries:s=this.mediaQueries,returnArray:a=!1}){const o=[],n=`[data-element-guid="${e.getGuid()}"] .content`;for(const a of i)if(s[a]){const i=lab_api.v1.style.getStyles(e,t,r,a);i&&o.push(`@media ${s[a]} { ${n} { ${i} } }`)}return a?o:`<style>${o.join("\n")}</style>`}}const j=class{constructor(){this.name="Baseview",this.api=null,this.pageAPI=null,this.useSpacing=!1}onReady(e){if(this.api=e,"json"===this.api.v1.viewport.getName()&&"PageExport.jsonData"===this.api.v1.config.get("viewports.json.renderer")){const e=new S(this.api);lab_api.v1.view.on("rendered",((t,i)=>[JSON.stringify(e.jsonData(lab_api.v1.model.query.getRootModel()),null,4)]))}new M(this.api,this.api.v1.util.request).listen()}onAcceptContent(){const e=this.api.v1.model.query.getRootModel();this.useSpacing=!(!e||!e.get("fields.style_spacing")),"editor"!==this.api.v1.app.mode.getSimulatedMode()?(new C(this.api).insert(this.api.v1.viewport.getName()),new T(this.api).register(e,lab_api.v1.site.getSite().alias)):Sys.logger.debug("[Front] Labrador is running in simulated editor-mode. Skipping DynamicDataHelper and EsiHelper.")}onRender(e,t){this.useSpacing&&e.setFiltered("styleSheets",$.createStyle({model:e,view:t,viewports:["desktop","mobile"],returnArray:!1}))}};var F=s.k,R=s.B},"./build/modules/client_package.js":(e,t,i)=>{i.r(t),i.d(t,{config:()=>r,properties:()=>s,templates:()=>a});const r={view_version:"1.4.5",view_version_number:145,view_name:"Baseview",view_build:{baseview:{releasenotes:"145:1",userReleasenotes:"145:3",version:232}},viewports:{mobile:{deviceWidth:480},desktop:{deviceWidth:1058}},imageUrlOptions:{extension:".webp"},viewHelper:{image:{viewports:["desktop","mobile"],pixelDensityFactor:2}},grid:{total_grid_spans:12,grid_prefix:{mobile:"small-",desktop:"large-"},abs_grid_prefix:{mobile:"small-abs-",desktop:"large-abs-"}},style:{definitions:{css_style:{requirePath:!1,path:"metadata.css_style",items:[{prefix:"style-",postfix:""}]},style_preset:{path:"metadata.style_preset",items:[{viewport:"no_viewport"}]},text_size:{requirePath:!0,path:"text_size",items:[{viewport:"desktop",fallback:"no_viewport",prefix:"t"},{viewport:"mobile",prefix:"tm"}],template:"{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"},font_weight:{requirePath:!0,path:"font_weight",items:[{viewport:"desktop",fallback:["no_viewport","mobile"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"m-"}]},bold:{requirePath:!0,path:"bold",items:[{viewport:"no_viewport"}]},text_background_color:{requirePath:!0,path:"text_background_color",items:[{viewport:"desktop",fallback:["no_viewport","mobile"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_",nullValue:"no_bg_color"}]},text_background_color_op:{requirePath:!0,path:"text_background_color_op",items:[{viewport:"desktop",fallback:["no_viewport","mobile"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_",nullValue:"no_bg_color"}]},custom_text_background_color:{requirePath:!0,path:"custom_text_background_color",items:[{prefix:"background-color:",postfix:" !important;"}]},custom_text_color:{requirePath:!0,path:"custom_text_color",items:[{prefix:"color:",postfix:" !important;"}]},custom_text_shadow:{requirePath:!0,path:"custom_text_shadow",items:[{prefix:"text-shadow:"}]},text_color:{requirePath:!0,path:"text_color",items:[{viewport:"desktop",fallback:["no_viewport","mobile"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},text_align:{requirePath:!0,path:"text_align",items:[{viewport:"desktop",fallback:["no_viewport","mobile"],prefix:"align-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile_text_align_align-"}]},fontface:{requirePath:!0,path:"fontface",items:[{prefix:"font-"}]},italic:{requirePath:!0,path:"italic",items:[{viewport:"desktop",fallback:["no_viewport","mobile"],nullValue:"no_italic"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"m-",nullValue:"no_italic"}]},underline:{requirePath:!0,path:"underline",items:[{viewport:"no_viewport"}]},texttransform:{requirePath:!0,path:"texttransform",items:[{viewport:"no_viewport"}]},strikethrough:{requirePath:!0,path:"strikethrough",items:[{viewport:"no_viewport"}]},text_shadow:{requirePath:!0,path:"text_shadow",items:[{viewport:"no_viewport"}]},animate:{requirePath:!0,path:"animate",items:[{viewport:"no_viewport"}]},background_color:{requirePath:!1,path:"metadata.background_color",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"",postfix:""},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_",postfix:"",nullValue:"no_bg_color"}],template:"{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"},background_opacity:{requirePath:!1,path:"metadata.background_color_op",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"",postfix:""},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_",postfix:""}]},background_gradient:{requirePath:!1,path:"metadata.gradient",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},border_color:{requirePath:!1,path:"metadata.border_color",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile_",nullValue:"no_border_color"}],template:"{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"},border_side:{requirePath:!1,path:"metadata.border_side",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile_",nullValue:"no_border_side"}],template:"{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"},border_width:{requirePath:!1,path:"metadata.border_width",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"border_width_",nullValue:"no_border_width"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"border_width_mobile_",nullValue:"no_border_width"}],template:"{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"},image_overlay:{requirePath:!1,path:"metadata.image_overlay",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},image_overlay_opacity:{requirePath:!1,path:"metadata.image_overlay_opacity",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},image_gradient:{requirePath:!1,path:"metadata.image_gradient",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},image_gradient_opacity:{requirePath:!1,path:"metadata.image_gradient_opacity",items:[{viewport:"desktop",fallback:["mobile","no_viewport"]},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"color_mobile_"}]},float:{requirePath:!1,path:"metadata.float",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"desktop-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-"}]},spacing:{requirePath:!1,path:"fields.spacing",items:[{prefix:"spacing-",nullValue:"default"}]},spacing_outer_top:{requirePath:!1,path:"metadata.spacing_outer_top",items:[{viewport:"current_viewport",prefix:"margin-top:",postfix:"% !important;"}]},spacing_outer_right:{requirePath:!1,path:"metadata.spacing_outer_right",items:[{viewport:"current_viewport",prefix:"margin-right:",postfix:"% !important;"}]},spacing_outer_bottom:{requirePath:!1,path:"metadata.spacing_outer_bottom",items:[{viewport:"current_viewport",prefix:"margin-bottom:",postfix:"% !important;"}]},spacing_outer_left:{requirePath:!1,path:"metadata.spacing_outer_left",items:[{viewport:"current_viewport",prefix:"margin-left:",postfix:"% !important;"}]},spacing_inner_top:{requirePath:!1,path:"metadata.spacing_inner_top",items:[{viewport:"current_viewport",prefix:"padding-top:",postfix:"% !important;"}]},spacing_inner_right:{requirePath:!1,path:"metadata.spacing_inner_right",items:[{viewport:"current_viewport",prefix:"padding-right:",postfix:"% !important;"}]},spacing_inner_bottom:{requirePath:!1,path:"metadata.spacing_inner_bottom",items:[{viewport:"current_viewport",prefix:"padding-bottom:",postfix:"% !important;"}]},spacing_inner_left:{requirePath:!1,path:"metadata.spacing_inner_left",items:[{viewport:"current_viewport",prefix:"padding-left:",postfix:"% !important;"}]},pull_up:{requirePath:!1,path:"metadata.pull_up",items:[{viewport:"desktop",prefix:"large-pull-"},{viewport:"mobile",prefix:"small-pull-"}]},content_text_align:{requirePath:!1,path:"metadata.text_align",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"align-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile_text_align_align-"}]},content_vertical_text_align:{requirePath:!1,path:"metadata.vertical_text_align",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"vertical-text-align-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-vertical-text-align-"}]},text_align_row:{requirePath:!1,path:"metadata.text_align_row",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"align-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile_text_align_align-"}]},vertical_align:{requirePath:!1,path:"metadata.vertical_align",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"grid-vas-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-grid-vas-"}]},vertical_align_content:{requirePath:!1,path:"metadata.vertical_align_content",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"grid-align-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-grid-align-"}]},custom_background_color:{requirePath:!1,path:"metadata.custom_background_color",items:[{prefix:"background-color:",postfix:";"}]},custom_background_color_L3:{requirePath:!1,path:"metadata.box_custom_background",items:[{prefix:"background-color:",postfix:";"}]},custom_border_color:{requirePath:!1,path:"metadata.custom_border_color",items:[{prefix:"border-color:",postfix:" !important;"}]},movableContainer:{requirePath:!0,items:[{viewport:"desktop",value:"desktop-movable-container",nullValue:""},{viewport:"mobile",value:"mobile-movable-container",nullValue:""}]},movableElement:{requirePath:!0,items:[{viewport:"desktop",value:"desktop-movable-element",nullValue:""},{viewport:"mobile",value:"mobile-movable-element",nullValue:""}]},collapsedContent:{requirePath:!0,items:[{viewport:"desktop",value:"desktop-collapsed-element",nullValue:""},{viewport:"mobile",value:"mobile-collapsed-element",nullValue:""}]},imageAlign:{requirePath:!0,items:[{viewport:"desktop",fallback:["no_viewport"],prefix:"desktop-"},{viewport:"mobile",fallback:["no_viewport"],prefix:"mobile-"}]},imageBorder:{requirePath:!0,items:[{value:"bordered"}]},vertical_space_outside_top:{requirePath:!1,path:"metadata.spaceOutsideTop",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"desktop-space-outsideTop-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-space-outsideTop-"}]},vertical_space_outside_bottom:{requirePath:!1,path:"metadata.spaceOutsideBottom",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"desktop-space-outsideBottom-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-space-outsideBottom-"}]},vertical_space_inside_top:{requirePath:!1,path:"metadata.spaceInsideTop",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"desktop-space-insideTop-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-space-insideTop-"}]},vertical_space_inside_bottom:{requirePath:!1,path:"metadata.spaceInsideBottom",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"desktop-space-insideBottom-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-space-insideBottom-"}]},fullWidth:{requirePath:!1,path:"metadata.hasFullWidth",items:[{viewport:"desktop",fallback:["no_viewport"],prefix:"desktop-",value:"fullWidth",nullValue:""},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-",value:"fullWidth",nullValue:""}]},fullWidthLimit:{path:"metadata.hasFullWidthWithLimit",items:[{viewport:"desktop",fallback:["no_viewport"],prefix:"desktop-",value:"fullWithLimit",nullValue:""},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-",value:"fullWithLimit",nullValue:""}]},expandedState:{path:"metadata.expandedState",items:[{viewport:"desktop",postfix:"-desktop",value:"state-expanded",nullValue:""},{viewport:"mobile",postfix:"-mobile",value:"state-expanded",nullValue:""}]},dacBtn:{requirePath:!0,path:"dacBtn",items:[{viewport:"no_viewport",value:"dacBtn bg-btn-color"}]},responsive_size:{requirePath:!0,items:[{viewport:"mobile",prefix:"small-vw-"}]},compactDisplay:{path:"metadata.compactDisplay",items:[{value:"compactDisplay"}]},subimagePlacement:{requirePath:!1,path:"metadata.subimagePlacement",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"placement-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-placement-"}]},subimageSize:{requirePath:!1,path:"metadata.subimageSize",items:[{viewport:"desktop",fallback:["mobile","no_viewport"],prefix:"size-"},{viewport:"mobile",fallback:["desktop","no_viewport"],prefix:"mobile-size-"}]}},collections:{text_decoration:{name:"text_decoration",definitions:["text_size","font_weight","bold","text_background_color","text_background_color_op","text_color","text_align","fontface","italic","underline","texttransform","strikethrough","text_shadow","animate","dacBtn"]},text_decoration_inline_style:{name:"text_decoration_inline_style",definitions:["custom_text_background_color","custom_text_color","custom_text_shadow"]},section_decoration:{name:"section_decoration",definitions:["style_preset","vertical_space_outside_top","vertical_space_outside_bottom"]},box_decoration:{name:"box_decoration",definitions:["float","pull_up","vertical_align","vertical_align_content","css_style","style_preset","vertical_space_outside_top","vertical_space_outside_bottom","vertical_space_inside_top","vertical_space_inside_bottom","expandedState","compactDisplay"]},box_fullWidth:{name:"box_fullWidth",definitions:["fullWidth","fullWidthLimit"]},content_decoration:{name:"content_decoration",definitions:["background_color","background_opacity","background_gradient","border_color","border_side","border_width","image_gradient","image_gradient_opacity","content_text_align","content_vertical_text_align"]},content_inline_style:{name:"content_inline_style",definitions:["custom_background_color","custom_background_color_L3","custom_border_color"]},content_inline_spacing:{name:"content_inline_spacing",definitions:["spacing_inner_top","spacing_inner_right","spacing_inner_bottom","spacing_inner_left","spacing_outer_top","spacing_outer_right","spacing_outer_bottom","spacing_outer_left"]},subimage:{name:"subimage",definitions:["subimagePlacement","subimageSize"]}},copyDefinitions:[{definition:"text_size",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"font_weight",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"text_background_color",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"text_background_color_op",data:[{path:"fields.title"}]},{definition:"text_color",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"text_align",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"fontface",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"italic",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"underline",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"texttransform",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"strikethrough",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"animate",data:[{path:"fields.title"},{path:"fields.subtitle"},{path:"fields.kicker"},{path:"fields.description"},{path:"fields.author"},{path:"fields.quote"},{path:"fields.firstname"},{path:"fields.lastname"},{path:"fields.imageCaption"},{path:"fields.byline"}]},{definition:"custom_text_shadow",data:[{path:"fields.title",values:{no_viewport:null}},{path:"fields.subtitle",values:{no_viewport:null}},{path:"fields.kicker",values:{no_viewport:null}},{path:"fields.description",values:{no_viewport:null}},{path:"fields.author",values:{no_viewport:null}},{path:"fields.quote",values:{no_viewport:null}},{path:"fields.firstname",values:{no_viewport:null}},{path:"fields.lastname",values:{no_viewport:null}},{path:"fields.imageCaption",values:{no_viewport:null}},{path:"fields.byline",values:{no_viewport:null}}]},{definition:"text_shadow",data:[{path:"fields.title",values:{no_viewport:null}},{path:"fields.subtitle",values:{no_viewport:null}},{path:"fields.kicker",values:{no_viewport:null}},{path:"fields.description",values:{no_viewport:null}},{path:"fields.author",values:{no_viewport:null}},{path:"fields.quote",values:{no_viewport:null}},{path:"fields.firstname",values:{no_viewport:null}},{path:"fields.lastname",values:{no_viewport:null}},{path:"fields.imageCaption",values:{no_viewport:null}},{path:"fields.byline",values:{no_viewport:null}}]},{definition:"custom_text_color",data:[{path:"fields.title",values:{no_viewport:null}},{path:"fields.subtitle",values:{no_viewport:null}},{path:"fields.kicker",values:{no_viewport:null}},{path:"fields.description",values:{no_viewport:null}},{path:"fields.author",values:{no_viewport:null}},{path:"fields.quote",values:{no_viewport:null}},{path:"fields.firstname",values:{no_viewport:null}},{path:"fields.lastname",values:{no_viewport:null}},{path:"fields.imageCaption",values:{no_viewport:null}},{path:"fields.byline",values:{no_viewport:null}}]},{definition:"custom_text_background_color",data:[{path:"fields.title",values:{no_viewport:null}},{path:"fields.subtitle",values:{no_viewport:null}},{path:"fields.kicker",values:{no_viewport:null}},{path:"fields.description",values:{no_viewport:null}},{path:"fields.author",values:{no_viewport:null}},{path:"fields.quote",values:{no_viewport:null}},{path:"fields.firstname",values:{no_viewport:null}},{path:"fields.lastname",values:{no_viewport:null}},{path:"fields.imageCaption",values:{no_viewport:null}},{path:"fields.byline",values:{no_viewport:null}}]},{definition:"css_style"},{definition:"style_preset"},{definition:"background_color"},{definition:"custom_background_color"},{definition:"background_opacity"},{definition:"background_gradient"},{definition:"image_gradient"},{definition:"border_color"},{definition:"border_side"},{definition:"border_width"},{definition:"image_overlay"},{definition:"image_overlay_opacity"},{definition:"image_gradient_opacity"},{definition:"float"},{definition:"pull_up"},{definition:"content_text_align"},{definition:"content_vertical_text_align"},{definition:"vertical_align"},{definition:"vertical_space_outside_top"},{definition:"vertical_space_outside_bottom"},{definition:"vertical_space_inside_top"},{definition:"vertical_space_inside_bottom"},{definition:"spacing_outer_top",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_outer_right",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_outer_bottom",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_outer_left",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_inner_top",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_inner_right",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_inner_bottom",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{definition:"spacing_inner_left",data:[{values:{no_viewport:null,desktop:null,mobile:null}}]},{targets:["article","articleHeader"],data:[{path:"metadata.image_gradient_direction",values:{no_viewport:null,desktop:null,mobile:null}}]},{targets:["image"],data:[{path:"fields.bbRatio",values:{no_viewport:null,desktop:null,mobile:null}},{path:"fields.whRatio",values:{no_viewport:null,desktop:null,mobile:null}},{path:"fields.float",values:{no_viewport:null,desktop:null,mobile:null}},{path:"fields.shapes",values:{no_viewport:null,desktop:null,mobile:null}},{path:"fields.displayCaption",values:{no_viewport:null}}]},{targets:["article"],data:[{path:"fields.displayByline",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.showSection",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.showTags",values:{no_viewport:null,desktop:null,mobile:null}}]},{targets:["article","articleHeader"],data:[{path:"metadata.showKicker",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.kickerBelowImage",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.floatingKicker",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.hideTitle",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.titleAboveImage",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.floatingTitle",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.hidesubtitle",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.floatingSubtitle",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.hideimage",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.hasFullWidth",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.hasFullWidthWithLimit",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.compactDisplay",values:{no_viewport:null}},{path:"metadata.sub_hideImage",values:{no_viewport:null}},{path:"metadata.sub_hideTitle",values:{no_viewport:null}},{path:"metadata.sub_hideSubtitle",values:{no_viewport:null}}]},{targets:["row"],data:[{path:"metadata.hasRowTitle",values:{no_viewport:null}},{path:"metadata.vertical_align_content",values:{no_viewport:null}},{path:"metadata.isSection",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.text_background_color",values:{no_viewport:null,desktop:null,mobile:null}},{path:"metadata.text_color",values:{no_viewport:null,desktop:null,mobile:null}}]},{targets:["userFeedback","timeline"],data:[{path:"metadata.ui_color",values:{no_viewport:null}},{path:"metadata.ui_text_color",values:{no_viewport:null}}]},{targetPath:"bodytext/",data:[{path:"width",values:{no_viewport:null,desktop:null,mobile:null}}]}],presets:{}}},s={"content_settings/front/vp_data.json":{viewportMap:{presets:{vp_data:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"},attributes:"presets.vp_content_attributes.attributes"},vp_content_attributes:{attributes:{font_weight:{viewport:{default:!0},fallback:{default:"desktop"}},text_size:{viewport:{default:!0}},text_color:{viewport:{default:!0},fallback:{default:"desktop"}},text_background_color:{viewport:{default:!0},fallback:{default:"desktop"}},text_align:{viewport:{default:!0},fallback:{default:"desktop"}},italic:{viewport:{default:!0},fallback:{default:"desktop"}}}},vp_metadata_attributes:{attributes:{bodyTextIndex:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},showKicker:{viewport:{default:!0},fallback:{default:"desktop"}},hideTitle:{viewport:{default:!0},fallback:{default:"desktop"}},titleAboveImage:{viewport:{default:!0},fallback:{default:"desktop"}},floatingTitle:{viewport:{default:!0},fallback:{default:"desktop"}},floatingSubtitle:{viewport:{default:!0},fallback:{default:"desktop"}},subtitleAboveImage:{viewport:{default:!0},fallback:{default:"desktop"}},hidesubtitle:{viewport:{default:!0},fallback:{default:"desktop"}},kickerBelowImage:{viewport:{default:!0},fallback:{default:"desktop"}},floatingKicker:{viewport:{default:!0},fallback:{default:"desktop"}},hasFullWidth:{viewport:{default:!0},fallback:{default:"desktop"}},hasFullWidthWithLimit:{viewport:{default:!0},fallback:{default:"desktop"}},background_color:{viewport:{default:!0},fallback:{default:"desktop"}},gradient:{viewport:{default:!0},fallback:{default:"desktop"}},image_overlay:{viewport:{default:!0},fallback:{default:"desktop"}},image_overlay_opacity:{viewport:{default:!0},fallback:{default:"desktop"}},image_gradient:{viewport:{default:!0},fallback:{default:"desktop"}},image_gradient_opacity:{viewport:{default:!0},fallback:{default:"desktop"}},image_gradient_direction:{viewport:{default:!0},fallback:{default:"desktop"}},background_color_op:{viewport:{default:!0},fallback:{default:"desktop"}},hideimage:{viewport:{default:!0},fallback:{default:"desktop"}},spacing_outer_top:{viewport:{default:!0}},spacing_outer_right:{viewport:{default:!0}},spacing_outer_bottom:{viewport:{default:!0}},spacing_outer_left:{viewport:{default:!0}},spacing_inner_top:{viewport:{default:!0}},spacing_inner_right:{viewport:{default:!0}},spacing_inner_bottom:{viewport:{default:!0}},spacing_inner_left:{viewport:{default:!0}},pull_up:{viewport:{default:!0}},float:{viewport:{default:!0}},border_color:{viewport:{default:!0},fallback:{default:"desktop"}},border_side:{viewport:{default:!0},fallback:{default:"desktop"}},border_width:{viewport:{default:!0},fallback:{default:"desktop"}},subarticles:{viewport:{default:!0},fallback:{default:"desktop"}},showSection:{viewport:{default:!0},fallback:{default:"desktop"}},showTags:{viewport:{default:!0},fallback:{default:"desktop"}},text_align:{viewport:{default:!0},fallback:{default:"desktop"}},vertical_align:{viewport:{default:!0}},hideViewport:{viewport:{default:!0},fallback:{no_viewport:!1}},expandedState:{viewport:{default:!0}},displayNavigation:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},displayPreview:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}}}}},width:{viewport:{default:!0},fallback:{mailmojo:"desktop"}},metadata:"presets.vp_metadata_attributes"}},"content/row/front/default.json":{viewportMap:{metadata:{attributes:{bodyTextIndex:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},hasFullWidth:{viewport:{default:!0},fallback:{default:"desktop"}},hasFullWidthWithLimit:{viewport:{default:!0},fallback:{default:"desktop"}},background_color:{viewport:{default:!0},fallback:{default:"desktop"}},background_color_op:{viewport:{default:!0},fallback:{default:"desktop"}},border_color:{viewport:{default:!0},fallback:{default:"desktop"}},border_side:{viewport:{default:!0},fallback:{default:"desktop"}},border_width:{viewport:{default:!0},fallback:{default:"desktop"}},vertical_align:{viewport:{default:!0}},isSection:{viewport:{default:!0},fallback:{default:"desktop"}},hideViewport:{viewport:{default:!0},fallback:{no_viewport:!1}},spaceOutsideTop:{viewport:{default:!0},fallback:{default:"desktop"}},spaceOutsideBottom:{viewport:{default:!0},fallback:{default:"desktop"}},spaceInsideTop:{viewport:{default:!0},fallback:{default:"desktop"}},spaceInsideBottom:{viewport:{default:!0},fallback:{default:"desktop"}},float:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},text_size:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},text_color:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},text_background_color:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},movableContent:{viewport:{default:!0},fallback:{no_viewport:!1}},collapsedContent:{viewport:{default:!0},fallback:{no_viewport:!1}},contentPosition:{viewport:{default:!0},fallback:{no_viewport:!1}}}}}},"content/columns/front/default.json":{},"content_settings/front/grid/default.json":{gridRules:{oddRule:{condition:"odd",values:{mobile:{default:12}}},evenRule:{condition:"even",values:{mobile:{default:12}}}}},"content/article/front/default.json":{viewportMap:{fields:{title:"presets.vp_content_attributes",subtitle:"presets.vp_content_attributes",kicker:"presets.vp_content_attributes",displayByline:"presets.vp_data",displayCaption:"presets.vp_data"}}},"content/image/front/default.json":{viewHelper:"image",viewportMap:{fields:{x:{viewport:{default:!0},fallback:{default:"desktop"}},y:{viewport:{default:!0},fallback:{default:"desktop"}},cropw:{viewport:{default:!0},fallback:{default:"desktop"}},croph:{viewport:{default:!0},fallback:{default:"desktop"}},float:{viewport:{default:!0}},shapes:{viewport:{default:!0},fallback:{default:"desktop"}},bbRatio:{viewport:{default:!0}},vpWidth:{viewport:{default:!0}},whRatio:{viewport:{default:!0},fallback:{default:"desktop"}},height:{viewport:{default:!0},fallback:{default:"desktop"}},width:{viewport:{default:!0}}},metadata:{attributes:{float:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},bodyTextIndex:{viewport:{default:!0},fallback:{default:"desktop",desktop:"mobile"}},hideViewport:{viewport:{default:!0},fallback:{no_viewport:!1}},hasFullWidth:{viewport:{default:!0},fallback:{default:"desktop"}},zoomable:{viewport:{default:!0},fallback:{default:"no_viewport",desktop:"no_viewport"}},subimage:{viewport:{default:!0},fallback:{default:"desktop"}},subimagePlacement:{viewport:{default:!0},fallback:{default:"desktop"}},subimageSize:{viewport:{default:!0},fallback:{default:"desktop"}}}}}},"content/row/_resources.json":{presentation:{stage:{"lab-default":{template:{default:"content/row/template/default"},properties:{default:["content_settings/front/vp_data.json","content/row/front/default.json"]}}}}},"content/columns/_resources.json":{presentation:{stage:{"lab-default":{properties:{default:["content/columns/front/default.json","content_settings/front/grid/default.json"]},template:{default:"content/columns/template/default"}}}}},"content/article/_resources.json":{presentation:{stage:{"lab-default":{properties:{default:["content/article/front/default.json","content_settings/front/grid/default.json","content_settings/front/vp_data.json"]},template:{default:"content/article/template/default",partials:["content/article/template/partials/kicker","content/article/template/partials/subtitle","content/article/template/partials/title","partial/elements/paywallLabel"]}}}}},"content/image/_resources.json":{presentation:{stage:{"lab-default":{template:{default:"content/image/template/default",partials:["content/image/template/partials/caption_links","content/image/template/partials/caption","content/image/template/partials/img"]},properties:{default:["content/image/front/default.json"]}}}}}},a={"content/row/template/default":'{{ #get.current.metadata.isSection }}\n<div data-element-guid="{{ get.current.guid }}" class="{{ #helper.trim }}\nrow-section \n{{ #style.collection }}section_decoration{{ /style.collection }}\n{{ #style.collection }}content_decoration{{ /style.collection }}\n{{ #style.definition }}movableContainer metadata.movableContent{{ /style.definition }}\n{{ #style.definition }}movableElement metadata.movableContent{{ /style.definition }}\n{{ #style.definition }}collapsedContent metadata.collapsedContent{{ /style.definition }}\n{{ /helper.trim }}" style="{{ #style.collection }}content_inline_style{{ /style.collection }}">\n{{ /get.current.metadata.isSection }}\n<div {{ ^get.current.metadata.isSection }}data-element-guid="{{ get.current.guid }}" {{ /get.current.metadata.isSection }}class="{{ #helper.trim }}\n    row\n    {{ size.grid.css }}\n    {{ #get.current.metadata.fullWidthContent }}fullWidthContent{{ /get.current.metadata.fullWidthContent }}\n    {{ #style.collection }}box_decoration{{ /style.collection }}\n    {{ #style.collection }}content_decoration{{ /style.collection }}\n    {{ #style.definition }}movableContainer metadata.movableContent{{ /style.definition }}\n    {{ #style.definition }}movableElement metadata.movableContent{{ /style.definition }}\n    {{ #style.definition }}collapsedContent metadata.collapsedContent{{ /style.definition }}\n    {{ #get.current.metadata.hasRowTitle }}has-row-header{{ /get.current.metadata.hasRowTitle }}\n    {{ #get.children.mediaContainer }}has-media-container{{ /get.children.mediaContainer }}\n    {{ /helper.trim }}" style="{{ #style.collection }}content_inline_style{{ /style.collection }}"{{ #get.current.metadata.sectionId }} id="{{ get.current.metadata.sectionId }}"{{ /get.current.metadata.sectionId }}>{{ #get.current.metadata.hasRowTitle }}\n    {{ #get.current.metadata.rowTitleTag }}\n    <{{ get.current.metadata.rowTitleTag }} class="row_header_text large-12 small-12 {{ #style.collection }}text_decoration metadata{{ /style.collection }} {{ #style.definition }}text_align_row{{ /style.definition }}">{{{ get.current.metadata.rowTitle }}}</{{ get.current.metadata.rowTitleTag }}>\n    {{ /get.current.metadata.rowTitleTag }}\n    {{ ^get.current.metadata.rowTitleTag }}\n    <h5 class="row_header_text large-12 small-12 {{ #style.collection }}text_decoration metadata{{ /style.collection }} {{ #style.definition }}text_align_row{{ /style.definition }}">{{{ get.current.metadata.rowTitle }}}</h5>\n    {{ /get.current.metadata.rowTitleTag }}\n    {{ /get.current.metadata.hasRowTitle }}{{ #get.current.metadata.movableContent }}{{{ get.current.filtered.movableStyle }}}{{ /get.current.metadata.movableContent }}{{{ children.all }}}</div>\n{{ #get.current.metadata.isSection }}\n</div>\n{{ /get.current.metadata.isSection }}\n',"content/columns/template/default":'<div data-element-guid="{{ get.current.guid }}" class="columns {{ size.grid.css }} {{ size.grid.absCss }}">{{{ children.all }}}</div>',"content/article/template/default":'<article {{ #helper.trim }}\n    data-element-guid="{{ get.current.guid }}"\n    class="column\n        {{ #style.collection }}box_decoration{{ /style.collection }}\n        {{ #get.current.filtered.paywall }}paywall{{ /get.current.filtered.paywall }}\n        {{ size.grid.css }}\n        {{ size.grid.absCss }}\n        {{ get.current.filtered.autodata_css }}"\n    {{ #get.current.filtered.autodata_attributes }} {{ key }}="{{ value }}"{{ /get.current.filtered.autodata_attributes }} \n    data-site-alias="{{ get.current.filtered.site_alias }}" \n    data-section="{{ get.current.filtered.section }}" \n    data-instance="{{ get.current.instance_of }}{{ ^get.current.instance_of }}{{ get.current.id }}{{ /get.current.instance_of }}" \n    {{ #get.child.image.fields.float }}data-image-float="{{ get.child.image.fields.float }}"{{ /get.child.image.fields.float }}\n    itemscope itemtype="http://schema.org/NewsArticle"\n    {{ /helper.trim }}>\n    {{{ get.current.filtered.styleSheets }}}\n    <div class="{{ #helper.trim }}\n        content\n        {{ #style.collection }}content_decoration{{ /style.collection }}\n        {{ #get.current.metadata.image_gradient_direction }}image-gradient-{{ get.current.metadata.image_gradient_direction }}{{ /get.current.metadata.image_gradient_direction }} \n        {{ #style.collection }}box_fullWidth{{ /style.collection }}\n        {{ /helper.trim }}" style="{{ #style.collection }}content_inline_style{{ /style.collection }}">\n        \n        {{#get.current.fields.published_url}}<a itemprop="url"{{ #get.current.fields.open_in_new_window }} target="_blank"{{ /get.current.fields.open_in_new_window }} class="" href="{{{ get.current.fields.published_url }}}" data-k5a-url="{{{ get.current.filtered.canonical_url }}}">{{/get.current.fields.published_url}}\n\n        {{ #get.current.filtered.layout.top }}\n        {{ #render.template }}content/article/template/partials/{{ . }}{{ /render.template }}\n        {{ /get.current.filtered.layout.top }}\n\n        <div class="media{{ #get.current.metadata.floatingTextSubset }} floatingTextSubset{{ /get.current.metadata.floatingTextSubset }} {{ #style.definition }}imageAlign child.image.fields.float{{ /style.definition }}">\n            {{^get.current.metadata.hideimage}}\n                {{{ placeholder.no_media }}}\n\n                {{{ child.image }}}\n                {{{ child.graphic }}}\n                {{{ child.slideshow }}}\n                {{{ child.youtube }}}\n                {{{ child.simplestream }}}\n                {{{ child.markup }}}\n                {{{ child.parallax }}}\n            \n            {{/get.current.metadata.hideimage}}\n            <div class="floatingText">\n                {{ #get.current.filtered.layout.floating }}\n                {{ #render.template }}content/article/template/partials/{{ . }}{{ /render.template }}\n                {{ /get.current.filtered.layout.floating }}\n\n                <div class="labels">\n                    {{ #get.current.filtered.autodata_custom.labels }}\n                    <div class="label" data-label-key="{{ key }}" data-label-value="{{ value }}"><span class="label-value">{{ value }}</span></div>\n                    {{ /get.current.filtered.autodata_custom.labels }}\n                    {{ #get.current.filtered.sectionPlacement.floating }}\n                        {{ #get.current.metadata.showSection }}\n                            {{ #get.current.filtered.section }}<p itemprop="section" class="section" data-tag="{{ get.current.filtered.section }}">{{ get.current.filtered.section }}</p>{{ /get.current.filtered.section }}\n                        {{ /get.current.metadata.showSection }}\n                    {{ /get.current.filtered.sectionPlacement.floating }}\n                </div>\n            </div>\n            {{ #get.current.filtered.paywallLabel }}{{> partial/elements/paywallLabel }}{{ /get.current.filtered.paywallLabel }}\n        </div>\n        {{ #get.current.fields.displayCaption }}\n            <div class="caption {{ #helper.trim }}\n                {{ #app.isEditor }}expanded{{ /app.isEditor }}\n                {{ #get.current.fields.truncateCaption }}truncate{{ /get.current.fields.truncateCaption }}\n                {{ ^get.current.fields.truncateCaption }}\n                    {{ #get.child.image.fields.truncateCaption }}truncate{{ /get.child.image.fields.truncateCaption }}\n                {{ /get.current.fields.truncateCaption }}\n                {{ /helper.trim }}" data-showmore="{{{ getConfig.image.caption.showMoreLabel }}}"{{ #get.child.image.filtered.captionOptions.expandable }} data-expandable="true"{{ /get.child.image.filtered.captionOptions.expandable }}>\n                <figcaption itemprop="caption" class="{{ #style.collection }}text_decoration child.image.fields.imageCaption{{ /style.collection }}">{{ #helper.stripLinks }}{{ #get.child.image.fields.globalCaption }}{{{ get.child.image.fields.globalCaption }}}{{ /get.child.image.fields.globalCaption }}{{ ^get.child.image.fields.globalCaption }}{{{ get.child.image.fields.imageCaption }}}{{ /get.child.image.fields.globalCaption }}{{ /helper.stripLinks }}</figcaption>\n                <figcaption itemprop="author" class="{{ #style.collection }}text_decoration child.image.fields.byline{{ /style.collection }}" data-byline-prefix="{{{ getConfig.image.imageBylinePrefix }}}">{{ #helper.stripLinks }}{{{ get.child.image.fields.byline }}}{{ /helper.stripLinks }}</figcaption>\n            </div>\n        {{ /get.current.fields.displayCaption }}\n\n        {{ #get.current.metadata.vertical_text_align }}\n            <div class="vertically-aligned-text">\n        {{ /get.current.metadata.vertical_text_align }}\n\n            {{ #get.current.filtered.sectionPlacement.underImage }}\n                {{ #get.current.metadata.showSection }}\n                    {{ #get.current.filtered.section }}<p itemprop="section" class="section" data-tag="{{ get.current.filtered.section }}">{{ get.current.filtered.section }}</p>{{ /get.current.filtered.section }}\n                {{ /get.current.metadata.showSection }}\n            {{ /get.current.filtered.sectionPlacement.underImage }}\n\n        \n            {{ #get.current.metadata.showTags }}\n            <div itemprop="tags" class="tags">{{#get.current.filtered.tags}}\n                <span itemprop="tag" class="tag" data-tag="{{ . }}">{{.}}</span>\n            {{/get.current.filtered.tags}}</div>\n            {{ /get.current.metadata.showTags }}\n            {{ #get.current.filtered.layout.bottom }}\n            {{ #render.template }}content/article/template/partials/{{ . }}{{ /render.template }}\n            {{ /get.current.filtered.layout.bottom }}\n        \n\n            {{ #get.current.filtered.sectionPlacement.underText }}\n                {{ #get.current.metadata.showSection }}\n                    {{ #get.current.filtered.section }}<p itemprop="section" class="section" data-tag="{{ get.current.filtered.section }}">{{ get.current.filtered.section }}</p>{{ /get.current.filtered.section }}\n                {{ /get.current.metadata.showSection }}\n            {{ /get.current.filtered.sectionPlacement.underText }}\n\n        {{ #get.current.metadata.vertical_text_align }}\n            </div>\n        {{ /get.current.metadata.vertical_text_align }}\n\n        {{ #get.current.filtered.displayByline }}\n        <div class="bylines">{{ #get.current.filtered.bylines }}\n            <div class="byline column" itemscope="" itemtype="http://schema.org/Person">\n                <div class="content">\n                    {{ #imageUrl}}\n                    <figure>\n                        <img itemprop="image" src="{{{ imageUrl}}}">\n                    </figure>\n                    {{ /imageUrl}}\n                    <address class="name">{{{ firstname }}} {{{ lastname }}}</address>\n                </div>\n            </div>\n        {{ /get.current.filtered.bylines }}</div>\n        {{ /get.current.filtered.displayByline}}\n\n        {{#get.current.fields.published_url}}</a>{{/get.current.fields.published_url}}\n\n        {{ #get.current.metadata.subarticles }}\n            <p class="subarticlesTitle bold {{ #style.collection }}text_decoration fields.subarticlesTitle{{ /style.collection }}" style="margin: 0.6em 0 0;">{{{ get.current.fields.subarticlesTitle }}}</p>\n            <ul class="relatedArticles">{{ #children.article[]+ }}\n            {{{ . }}}\n            {{ /children.article[]+ }}</ul>\n        {{ /get.current.metadata.subarticles }}\n        <time itemprop="datePublished" datetime="{{ get.current.filtered.published }}"></time>\n    </div>\n</article>',"content/article/template/partials/kicker":'<div {{ #get.current.fields.kicker[animate] }}data-content="{{ #helper.sanitizeString }}{{{ get.current.filtered.kicker }}}{{ /helper.sanitizeString }}"{{ /get.current.fields.kicker[animate] }}\nstyle="{{ #style.collection }}text_decoration_inline_style fields.kicker{{ /style.collection }}"\nclass="kicker {{ get.current.filtered.layout.positions.kicker }} {{ #style.collection }}text_decoration fields.kicker{{ /style.collection }}">\n{{{ get.current.filtered.kicker }}}\n</div>',"content/article/template/partials/subtitle":'<p itemprop="description" class="subtitle {{ #style.collection }}text_decoration fields.subtitle{{ /style.collection }}" style="{{ #style.collection }}text_decoration_inline_style fields.subtitle{{ /style.collection }}"\n    {{ #get.current.fields.kicker[animate] }}data-content="{{ #helper.sanitizeString }}{{{ get.current.filtered.kicker }}}{{ /helper.sanitizeString }}"{{ /get.current.fields.kicker[animate] }}>\n    {{{ get.current.filtered.subtitle }}}\n</p>',"content/article/template/partials/title":'<h2 itemprop="headline" \n    class="headline {{ #style.collection }}text_decoration fields.title{{ /style.collection }}"\n    style="{{ #style.collection }}text_decoration_inline_style fields.title{{ /style.collection }}"\n    {{ #get.current.fields.title[animate] }}data-content="{{ #helper.sanitizeString }}{{{ get.current.filtered.title }}}{{ /helper.sanitizeString }}"{{ /get.current.fields.title[animate] }}>{{{ get.current.filtered.title }}}\n</h2>',"partial/elements/paywallLabel":'<div class="paywallLabel{{ #layout.noImage }} no-image{{ /layout.noImage }} {{ layout.float }}">{{ #icon.content }}<span class="{{ icon.content }}"></span> {{/icon.content }}{{ text.content }}</div>\n',"content/image/template/default":'<figure data-element-guid="{{ get.current.guid }}" class="{{#helper.trim}}\n    {{ #style.collection }}box_decoration{{ /style.collection }}\n    {{ #get.current.filtered.hasFloat }}{{ #style.definition }}responsive_size fields.vpWidth{{ /style.definition }}{{ /get.current.filtered.hasFloat }}\n    {{ #style.definition }}imageBorder fields.border{{ /style.definition }}\n    {{ #style.definition }}imageAlign fields.float{{ /style.definition }}\n    {{ get.current.filtered.imageLoadingClass }}\n    {{/helper.trim}}" {{ #get.current.filtered.hasFloat }}{{ ^get.current.fields.vpWidth }}style="width:{{ get.current.filtered.imageWidth }}px;"{{ /get.current.fields.vpWidth }}{{ /get.current.filtered.hasFloat }}>\n    <div class="img{{ #get.current.filtered.allowFullwidth }} fullwidthTarget{{ /get.current.filtered.allowFullwidth }} {{ #style.collection }}content_decoration{{ /style.collection }}">\n        {{ > content/image/template/partials/img }}\n        {{ > content/image/template/partials/shapes }}\n    </div>\n    {{ ^get.parent.filtered.layout.floating }} {{ #get.current.filtered.captionOptions.display }}\n    {{ > content/image/template/partials/caption }}\n    {{ /get.current.filtered.captionOptions.display }} {{ /get.parent.filtered.layout.floating }}\n</figure>\n',"content/image/template/partials/caption_links":'<div class="caption {{ #helper.trim }}\n    {{ #app.isEditor }}expanded{{ /app.isEditor }}\n    {{ #get.parent.fields.truncateCaption }}truncate{{ /get.parent.fields.truncateCaption }}\n    {{ ^get.parent.fields.truncateCaption }}\n        {{ #get.current.fields.truncateCaption }}truncate{{ /get.current.fields.truncateCaption }}\n    {{ /get.parent.fields.truncateCaption }}\n    {{ /helper.trim }}" data-showmore="{{{ getConfig.image.caption.showMoreLabel }}}"{{ #get.current.filtered.captionOptions.expandable }} data-expandable="true"{{ /get.current.filtered.captionOptions.expandable }}>\n    <figcaption itemprop="caption" class="{{ #style.collection }}text_decoration fields.imageCaption{{ /style.collection }}">{{{ get.current.fields.imageCaption }}}</figcaption>\n    <figcaption itemprop="author" class="{{ #style.collection }}text_decoration fields.byline{{ /style.collection }}" data-byline-prefix="{{{ getConfig.image.imageBylinePrefix }}}">{{{ get.current.fields.byline }}}</figcaption>\n</div>',"content/image/template/partials/caption":'<div class="caption {{ #helper.trim }}\n    {{ #app.isEditor }}expanded{{ /app.isEditor }}\n    {{ #get.parent.fields.truncateCaption }}truncate{{ /get.parent.fields.truncateCaption }}\n    {{ ^get.parent.fields.truncateCaption }}\n        {{ #get.current.fields.truncateCaption }}truncate{{ /get.current.fields.truncateCaption }}\n    {{ /get.parent.fields.truncateCaption }}\n    {{ /helper.trim }}" data-showmore="{{{ getConfig.image.caption.showMoreLabel }}}"{{ #get.current.filtered.captionOptions.expandable }} data-expandable="true"{{ /get.current.filtered.captionOptions.expandable }}>\n    <figcaption itemprop="caption" class="{{ #style.collection }}text_decoration fields.imageCaption{{ /style.collection }}">{{ #get.parent.fields.globalCaption }}{{{ get.parent.fields.globalCaption }}}{{ /get.parent.fields.globalCaption }}{{ ^get.parent.fields.globalCaption }}{{{ get.current.fields.imageCaption }}}{{ /get.parent.fields.globalCaption }}</figcaption>\n    <figcaption itemprop="author" class="{{ #style.collection }}text_decoration fields.byline{{ /style.collection }}" data-byline-prefix="{{{ getConfig.image.imageBylinePrefix }}}">{{{ get.current.fields.byline }}}</figcaption>\n</div>',"content/image/template/partials/img":'<picture>\n    {{ #get.current.filtered.viewport_list.desktop.formats }}\n    <source srcset="{{{ get.current.filtered.viewport_list.desktop.url }}}&format={{ format }}" \n        width="{{{ get.current.filtered.viewport_list.desktop.width }}}"\n        height="{{{ get.current.filtered.viewport_list.desktop.height }}}"\n        media="(min-width: 768px)"\n        type="{{{ type }}}">    \n    {{ /get.current.filtered.viewport_list.desktop.formats }}\n    {{ #get.current.filtered.viewport_list.mobile.formats }}\n    <source srcset="{{{ get.current.filtered.viewport_list.mobile.url }}}&format={{ format }}" \n        width="{{{ get.current.filtered.viewport_list.mobile.width }}}"\n        height="{{{ get.current.filtered.viewport_list.mobile.height }}}"\n        media="(max-width: 767px)"\n        type="{{{ type }}}">    \n    {{ /get.current.filtered.viewport_list.mobile.formats }}\n    <img src="{{{ get.current.filtered.viewport_list.mobile.url }}}&format=jpg"\n        width="{{{ get.current.filtered.viewport_list.mobile.width }}}"\n        height="{{{ get.current.filtered.viewport_list.mobile.height }}}"\n        title="{{ #helper.sanitizeString }}\n        {{ #getConfig.image.showBylineAsTitle }}{{ get.current.fields.byline }}{{ /getConfig.image.showBylineAsTitle }}\n        {{ ^getConfig.image.showBylineAsTitle }}{{ get.current.filtered.captionOptions.title }}{{ /getConfig.image.showBylineAsTitle }}\n        {{ /helper.sanitizeString }}"\n        alt="{{ #helper.sanitizeString }}{{ #get.current.fields.altText }}{{{ get.current.fields.altText }}}{{ /get.current.fields.altText }}{{ /helper.sanitizeString }}" \n        {{ #get.current.filtered.lazyloadImages }}loading="lazy"{{ /get.current.filtered.lazyloadImages }}\n        {{ #app.isEditor }}\n        class="{{ #helper.getEditorLoadingClass }}{{ /helper.getEditorLoadingClass }}"\n        style="{{ #helper.getEditorLoadingStyle }}{{ /helper.getEditorLoadingStyle }} {{{ get.current.filtered.filters }}}"    \n        {{ /app.isEditor }}\n        {{ ^app.isEditor }}\n        style="{{{ get.current.filtered.filters }}}"    \n        {{ /app.isEditor }}>\n</picture>'}},"./public/common/labrador/ClientData.js":(e,t,i)=>{i.r(t),i.d(t,{ClientData:()=>r});class r{constructor(){this.totalCount=0,this.count=0,this.data=[],this.markups=[]}setMarkups(e){this.markups=e}setData(e){this.data=e,this.count=this.data.length}setTotalCount(e){this.totalCount=e}getData(){return this.data}}},"./public/common/labrador/Core.js":(e,t,i)=>{i.r(t),i.d(t,{Core:()=>K});var r={d:(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},s={};r.d(s,{Q:()=>G});var a={};r.r(a),r.d(a,{defaults:()=>l,functionHelper:()=>S,grid:()=>P,interpolation:()=>d,objectHelper:()=>n,stringHelper:()=>v,uuid:()=>F});const o={state:"",version:"4.2.1",build:{styleguide:4,releasenotes:"40200:5",userReleasenotes:"40109:4",browsers:{chrome:94},version:370}},n={get:(e,t,i)=>e.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:i?void 0:null),t),set:(e,t,i)=>(e.split(".").reduce(((e,i,r,s)=>{if(r!==s.length-1)return n.isObject(e[i])?e[i]:e[i]={};e[i]=t}),i),i),delete:(e,t)=>{e.split(".").reduce(((e,t,i,r)=>{if(i!==r.length-1)return n.isObject(e[t])?e[t]:e[t]={};delete e[t]}),t)},isObject:e=>e&&"object"==typeof e&&!Array.isArray(e),hasContent:e=>!!n.isObject(e)&&!!Object.keys(e).length,merge:(e,t)=>{if(Array.isArray(e)&&Array.isArray(t))return t;const i=Object.assign(Array.isArray(e)?[]:{},e);if(n.isObject(e)&&n.isObject(t))for(const r of Object.keys(t))n.isObject(t[r])?r in e&&n.isObject(e[r])?i[r]=n.merge(e[r],t[r]):Object.assign(i,{[r]:t[r]}):Object.assign(i,{[r]:t[r]});return i},mergeArray:(e,t,i=!0)=>{const r=[...e||[],...t||[]];return i?[...new Set(r)]:r},clone:(e,t)=>{if(!e)return e;let i;if(!t&&e instanceof Array)i=e.slice(0);else{i=e instanceof Array?[]:{};for(const r in e)e.hasOwnProperty(r)&&(t&&"object"==typeof e[r]&&null!==e[r]?i[r]=n.clone(e[r],t):i[r]=e[r])}return i},serialize(e,t="=",i="&"){const r=[];for(const i of Object.keys(e))r.push(i+t+e[i]);return r.length?r.join(i):null}},l={true:e=>void 0===e||!!e,false:e=>!!e,string:(e,t="")=>"string"==typeof e?e:t,stringRestricted:(e,t="",i=[])=>"string"!=typeof e?t:i.includes(e)?e:t,pixelString:(e,t="")=>{if("number"==typeof e)return`${e}px`;if("string"!=typeof e)return t;const i=e.trim().split("px");return 2!==i.length||isNaN(i[0])?t:`${i[0]}px`},stringOrNull:e=>"string"==typeof e?e:null,stringOrUndefined:e=>"string"==typeof e?e:void 0,numberOrDefault:(e,t=0)=>"number"==typeof e?e:t,array:(e,t=[])=>Array.isArray(e)?e:t,arrayOrNull:e=>Array.isArray(e)?e:null,object:(e,t={},i=t)=>!e||"object"!=typeof e||Array.isArray(e)?t:{...i,...e},objectOrArray:(e,t={})=>Array.isArray(e)?e:l.object(e,t),notNullOrUndefined:(e,t)=>null==e?t:e,notUndefined:(e,t)=>void 0===e?t:e},d={resolve:(e,t,i)=>"object"==typeof e?d.resolveObject(e,t,i):"string"==typeof e?d.resolveString(e,t,i):e,resolveObject:(e,t,i)=>{for(const r in e)"object"==typeof e[r]?e[r]=d.resolveObject(e[r],t,i):"string"==typeof e[r]&&(e[r]=d.resolveString(e[r],t,i));return e},resolveString:(e,t,i)=>-1===e.indexOf("${")?e:e.replace(/\${([^{}]*)}/g,((e,r)=>{const s=i.getCms(r.trim());return"string"==typeof s||"number"==typeof s?s:("undefined"!=typeof Sys&&Sys.logger.warn(`Cannot interpolate config value "${e}". Description: ${t}.`),e)}))};class c{constructor(e,t){this.logger=t,this.log("Setup"),this.config=e,this.siteAlias=this.config.site&&this.config.site.alias||null,this.fallbackSites=this.resolveSiteAliases(this.siteAlias),this.log(`Site-alias: ${this.siteAlias}`),this.log(`Will use site(s): ${this.fallbackSites}`),this.resources=[{name:"config",source:"config",path:"customer",sitesPrefix:"customer.site_config_",storeSitesPrefix:null,siteOverride:{},paths:[],content:[],resolved:!1},{name:"cmsConfig",source:"config",path:"",sitesPrefix:null,storeSitesPrefix:null,paths:[],content:[],resolved:!1},{name:"viewConfig",source:"configObject",path:"ConfigObject.viewConfig.config.customer",sitesPrefix:"ConfigObject.viewConfig.config.customer.site_config.",storeSitesPrefix:"config.customer.site_config.",siteOverride:{},paths:[],content:[],resolved:!1},{name:"featureFlags",source:"configObject",path:"ConfigObject.featureFlags",sitesPrefix:"ConfigObject.featureFlags.site.",storeSitesPrefix:"site.",siteOverride:{},paths:[],content:[],resolved:!1},{name:"content",source:"configObject",path:"ConfigObject.content",sitesPrefix:null,storeSitesPrefix:null,paths:[],content:[],resolved:!1},{name:"localisation",source:"configObject",path:"ConfigObject.localisation",sitesPrefix:null,storeSitesPrefix:null,paths:[],content:[],resolved:!1}],this.resourceObject={},this.cache={get:{},debug:{getter:{},reload:{},update:{},resetCache:{}}},this.setupResources()}static resolveFullConfig(e={},t={}){const i={ConfigObject:{},app:{mode:"presentation",version:"[unversioned cms]"},mainViewport:l.string(e.deviceMain,e.device||"desktop"),isTouchDevice:l.false(e.isTouchDevice),sites:l.array(e.sites),...e};return i.app.version=t.version||i.app.version,i.buildInfo=t.build||e.build,i.customer=c.resolveConfig(e.customer),i}static resolveConfig(e={}){const t={grid:{},...e};t.resourceAllocation=l.object(t.resourceAllocation,{resourceMaps:["_resources"],mergeMaps:!0});const i=t.viewHelper||{};return t.viewHelper={image:l.object(i.image,{viewports:["desktop"],pixelDensityFactor:1})},t.appMapper=l.objectOrArray(t.appMapper),t.view_name=l.string(t.view_name,"[unnamed view]"),t.view_version=l.string(t.view_version,"[unversioned view]"),t.grid.total_grid_spans=l.numberOrDefault(t.grid.total_grid_spans,12),t.grid.grid_prefix=l.object(t.grid.grid_prefix),t.grid.abs_grid_prefix=l.object(t.grid.abs_grid_prefix,null),t.preload=l.array(t.preload),t.preloadObject=l.object(t.preloadObject),t.viewports=l.object(t.viewports),t.viewport=l.string(t.viewport),t.touchEditingViewport=l.string(t.touchEditingViewport),t.style=l.object(t.style,{definitions:{},collections:[],presets:[],copyDefinitions:[]}),t.image=l.object(t.image,{defaultAspectRatio:.45,defaultBoundingBoxWidthRatio:1}),t.imageUrlOptions=l.object(t.imageUrlOptions),t.tags=l.object(t.tags,{},{section:[]}),t.elementList=l.object(t.elementList,{all:[],favourites:[]}),t.elementListAdditions=l.object(t.elementListAdditions,{all:[],favourites:[]}),t.elementListRemovals=l.object(t.elementListRemovals,{all:[],favourites:[]}),t.autoscroll=l.object(t.autoscroll,{scrollDistance:100,scrollBuffer:50,accelerator:{max:3,step:.2}}),t.markLockedPaths=l.true(t.markLockedPaths),t.minimap=l.object(t.minimap,{structure:null,pageType:[]}),t.exitWarning=l.stringOrNull(t.exitWarning),t.publish=l.object(t.publish,{retry:{count:4,delay:2e3},options:{article:{hidden:!0,defaultHidden:!1}}}),t.autolock=l.object(t.autolock,{timeout:18e5}),t.networkWarning=l.object(t.networkWarning,null,{offline:{alert:!0,lockPage:!0},online:{alert:!0}}),t.image_preview=l.object(t.image_preview,{width:1600,compression:50}),t.textTools=l.object(t.textTools,{characterBlacklists:{utf:[]},text_size:{min:{default:14},max:{default:150,mobile:80}}}),t.structure_map=l.object(t.structure_map),t.shapes=l.object(t.shapes),t.requiredElements=l.array(t.requiredElements),t.requiredElementsAdditions=l.array(t.requiredElementsAdditions),t.data=l.object(t.data,{elements:{},presets:{},presetBlacklist:{},blacklist:[],blacklistOptions:{}}),t.pageElements=l.object(t.pageElements),t.drawer=l.array(t.drawer),t.drawerAdditions=l.array(t.drawerAdditions),t.drawerRemovals=l.array(t.drawerRemovals),t.maxChildCount=l.numberOrDefault(t.maxChildCount,150),t}log(e,t=null){this.logger&&(t?this.logger.debug(`[ConfigReader] ${e}`,[t]):this.logger.debug(`[ConfigReader] ${e}`))}setupResources(){for(const e of this.resources)this.resourceObject[e.name]=e}setupResource(e,t=null){const i=!!t&&t!==this.siteAlias,r=this.resourceObject[e];this.log(`Settings up resource "${e}". Site: "${t||this.siteAlias}". Site-override: ${r.sitesPrefix?i:"n/a"}`),t&&!r.siteOverride[t]&&(r.siteOverride[t]={content:[],paths:[],resolved:!1});const s=t?r.siteOverride[t]:r,a=i?this.resolveSiteAliases(t):this.fallbackSites;for(const e of this.calculateResourcePaths(r,a)){s.paths.push(e);const t=this.getPath(e,this.config);s.content.push({path:e,value:t||{}})}return s.resolved=!0,s}reloadResourceBySite(e,t,i){if(e&&this.resourceObject[e]&&i){this.cache.debug.reload[`${e}|${t||"no-site"}`]=this.cache.debug.reload[`${e}|${t||"no-site"}`]?this.cache.debug.reload[`${e}|${t||"no-site"}`]+1:1;const r=d.resolve(i,"reload_resouce"),s=t?this.resourceObject[e].sitesPrefix+t:this.resourceObject[e].path;n.set(s,r,this.config),this.resourceObject[e].siteOverride[t]?delete this.resourceObject[e].siteOverride[t]:t||(this.setupResource(e),this.resourceObject[e].siteOverride={})}}updateConfigByPath(e,t){this.cache.debug.update[e]=this.cache.debug.update[e]?this.cache.debug.update[e]+1:1,n.set(e,t,this.config),this.resetCache(e)}getCacheKey(e="",t={}){const i=[e,t.mergeStrategy,t.orderStrategy];for(const e of t.resourceList)i.push(e.name,e.useSites?1:0,e.site||"-");return i.join("|")}getCache(e){return this.cache.debug.getter[e]=this.cache.debug.getter[e]?this.cache.debug.getter[e]+1:1,{isSet:e in this.cache.get,value:this.cache.get[e]}}setCache(e,t){this.cache.get[e]=t}resetCache(e){for(const t of Object.keys(this.cache.get))t.startsWith(`${e}|`)&&(this.cache.debug.resetCache[t]=this.cache.debug.resetCache[t]?this.cache.debug.resetCache[t]+1:1,this.log(`Deleting cache for key "${e}" ("${t}")`),delete this.cache.get[t])}calculateResourcePaths(e,t=this.fallbackSites){const i=e.sitesPrefix?t.map((t=>e.sitesPrefix+t)):[];return i.push(e.path),i}resolveSiteAliases(e,t=[]){if(!e)return t;t.push(e);const i=this.getFallbackSite(e);return i&&this.resolveSiteAliases(i,t),t}getFallbackSite(e){return this.getPath(`customer.site_config_${e}.lab_fallback_site`,this.config)}getResource(e){let t=e.site?this.resourceObject[e.name].siteOverride[e.site]:this.resourceObject[e.name];return t&&t.resolved||(t=this.setupResource(e.name,e.site)),t}getPath(e,t,i=!1){return e?i?d.resolve(n.get(e,t,!0),e,{getCms:e=>n.get(e,this.config,!0)}):n.get(e,t,!0):t}getPaths(e,t,i=!1){const r=[],s=this.getResource(t),a=t.useSites?s.content:[s.content[s.content.length-1]];for(const s of a){const o=this.getPath(e,s.value,i);void 0!==o&&r.push({source:t.name,path:s.path,value:o,sourceIndex:a.indexOf(s)})}return r}getValueType(e){for(const t of e)if(null!==t.value)return Array.isArray(t.value)?"array":n.isObject(t.value)?"object":"other";return"other"}mergeResources(e,t,i){let r=t;const s=this.orderResources(e,i);if(!s.length)return{payload:null,paths:[],resetPaths:[]};const a=this.getValueType(s);if("default"===r&&(r="object"===a?"merge":"replace"),"replace"===r)return{payload:s[0].value,paths:[s[0].path],resetPaths:[]};s.reverse();const o=Array.isArray(s[0].value)?[]:{};let l=o;const d=[],c=[];for(const e of s){null===e.value&&(l=o,c.push(e.path));let i=n.merge;"merge"===t&&"array"===a&&(i=n.mergeArray),l=i(l,e.value),d.push(e.path)}return{payload:l,paths:d,resetPaths:c}}orderResources(e,t){if(1===e.length)return e[0].payload;let i=[];for(const t of e)i=i.concat(...t.payload);return"site"===t&&i.sort(((e,t)=>e.sourceIndex-t.sourceIndex)),i}prepareReturnValue(e){return e&&"object"==typeof e?n.clone(e,!0):e}getter(e,t=[],{mergeStrategy:i=null,orderStrategy:r=null,raw:s=!1,noCache:a=!1,interpolate:o=!0}){const n={mergeStrategy:l.stringRestricted(i,"default",["default","merge","replace"]),orderStrategy:l.stringRestricted(r,"site",["site","type"]),raw:l.false(s),noCache:l.false(a),resourceList:[]};for(const e of t)n.resourceList.push({name:e.name,useSites:!!e.useSites,site:l.stringOrNull(e.site)});const d=this.getCacheKey(e,n),c=this.getCache(d);if(!n.noCache&&c.isSet)return n.raw?{cached:!0,options:n,data:{raw:c.value.raw,merged:c.value.merged}}:this.prepareReturnValue(c.value.merged.payload);const p=n.resourceList.map((t=>({name:t.name,payload:this.getPaths(e,t,o)}))),g=this.mergeResources(p,n.mergeStrategy,n.orderStrategy);return this.setCache(d,{raw:p,merged:g}),n.raw?{cached:!1,options:n,data:{raw:p,merged:g}}:this.prepareReturnValue(g.payload)}get(e,{useSites:t=!0,site:i=null,raw:r=!1,noCache:s=!1,mergeStrategy:a=null,orderStrategy:o=null}={}){return this.getter(e,[{name:"viewConfig",useSites:t,site:i},{name:"config",useSites:t,site:i}],{mergeStrategy:a,orderStrategy:o,raw:r,noCache:s})}getConfig(e,{useSites:t=!0,site:i=null,raw:r=!1,noCache:s=!1,mergeStrategy:a=null}={}){return this.getter(e,[{name:"config",useSites:t,site:i}],{mergeStrategy:a,raw:r,noCache:s})}getCms(e,{raw:t=!1,noCache:i=!1}={}){return this.getter(e,[{name:"cmsConfig"}],{raw:t,noCache:i})}getView(e,{useSites:t=!0,site:i=null,raw:r=!1,noCache:s=!1,mergeStrategy:a=null}={}){return this.getter(e,[{name:"viewConfig",useSites:t,site:i}],{mergeStrategy:a,raw:r,noCache:s})}getFeatureFlags(e,{useSites:t=!0,site:i=null,raw:r=!1,noCache:s=!1,mergeStrategy:a=null}={}){return this.getter(e,[{name:"featureFlags",useSites:t,site:i}],{mergeStrategy:a,raw:r,noCache:s,interpolate:!1})}getContent(e,{raw:t=!1}={}){return this.getter(e,[{name:"content"}],{raw:t})}getLocal(e,{useSites:t=!0,site:i=null,raw:r=!1,noCache:s=!1,mergeStrategy:a=null}={}){return this.getter(e,[{name:"localisation",useSites:t,site:i}],{mergeStrategy:a,raw:r,noCache:s,interpolate:!1})}getPathForSite(e,t,i=""){return e&&t&&this.resourceObject[e]&&this.resourceObject[e].sitesPrefix?this.resourceObject[e].sitesPrefix+t+(i?`.${i}`:""):null}getStorePathForSite(e,t,i=""){return e&&t&&this.resourceObject[e]&&this.resourceObject[e].sitesPrefix?this.resourceObject[e].storeSitesPrefix+t+(i?`.${i}`:""):null}debug(){return this.cache.debug}}class p{constructor(e,t,i=!1,r="",s=""){this.configReader=e,this.viewport=t,this.fragmentMode=i,this.pageType=r,this.simulatedMode=s,this.cache=new Map,this.isEditor="edit"===this.getAppMode(),this.pixelDensityFactor=this.isEditor?1:this.configReader.get("viewHelper.image.pixelDensityFactor"),this.pixelDensityFactors={}}resetCache(){this.cache.clear()}getViewport(){return this.viewport}getViewports(){const e="getViewports";return this.cache.has(e)||this.cache.set(e,Object.keys(this.configReader.get("viewports")||{})),this.cache.get(e)}getMainViewport(){const e="getMainViewport";return this.cache.has(e)||this.cache.set(e,this.configReader.getCms("mainViewport")),this.cache.get(e)}getPageType(){return this.pageType}getSimulatedMode(){return this.simulatedMode}isFragmentMode(){return!!this.fragmentMode}isMainViewport(){return this.viewport===this.getMainViewport()}isTouchDevice(e=this.viewport){return this.configReader.getCms("isTouchDevice")}getSubViewports(){const e="getSubViewports";if(!this.cache.has(e)){const t=this.getMainViewport();this.cache.set(e,this.getViewports().filter((e=>e!==t)))}return this.cache.get(e)}isSubViewport(e=this.viewport){return e!==this.getMainViewport()}getEditableViewports(e=!1){const t=`getEditableViewports_${e}`;if(!this.cache.has(t)){const i=this.configReader.get("viewports"),r=e?{}:[];for(const t of Object.keys(i))i[t].noEdit||(e?r[t]=i[t]:r.push(t));this.cache.set(t,r)}return this.cache.get(t)}getViewportWidth(e=this.viewport){const t=this.configReader.get(`viewports.${e}.deviceWidth`);return t?parseInt(t,10):null}getEditViewportWidth(e=this.viewport){const t=this.configReader.get(`viewports.${e}.editSlotWidth`)||this.configReader.get(`viewports.${e}.deviceWidth`);return t?parseInt(t,10):null}getSite(e=null){const t={},i=`getSite_${e}`;if(!this.cache.has(i)){if(e){for(const t of this.configReader.getCms("sites"))if(t.alias===e)return this.cache.set(i,t),t;return this.cache.set(i,t),t}this.cache.set(i,this.configReader.getCms("site")||t)}return this.cache.get(i)}getSiteById(e){if(!e)return null;const t=`getSiteById_${e}`;if(!this.cache.has(t)){const i=parseInt(e,10);for(const e of this.configReader.getCms("sites"))if(e.id===i)return this.cache.set(t,e),e;return this.cache.set(t,null),null}return this.cache.get(t)}getSites(){const e="getSites";return this.cache.has(e)||this.cache.set(e,this.configReader.getCms("sites")||[]),this.cache.get(e)}getAppMode(){const e="getAppMode";return this.cache.has(e)||this.cache.set(e,this.configReader.getCms("app.mode")||"presentation"),this.cache.get(e)}isPresentationMode(){return!this.isEditor}isEditMode(){return this.isEditor}getPixelDensityFactor(e){return e?(this.pixelDensityFactors[e]||(this.pixelDensityFactors[e]=this.isEditor?1:this.configReader.get(`viewHelper.image.pixelDensity.${e}`)||this.configReader.get("viewHelper.image.pixelDensityFactor")),this.pixelDensityFactors[e]):this.pixelDensityFactor}getPreferredImageFormat(){return(this.configReader.get("imageUrlOptions.extension")||"").replace(".","")||null}}class g{constructor(e){this.debug=e&&"object"==typeof performance,this.logs={}}getLogs(){return this.logs}resetLogs(){this.logs={}}log(e,t){const i=e.pop();let r=this.logs;for(const t of e)r[t]||(r[t]={}),r=r[t];r[i]||(r[i]={count:0,time:0}),r=r[i],r.count++,r.time+=t}start(e){if(this.debug)return{paths:e,time:this.getTimestamp()}}end(e){this.debug&&this.log(e.paths,this.getTimestamp()-e.time)}getTimestamp(){return performance.now()}}class u{constructor({entries:e=[],behaviours:t={},debug:i=!1}={}){this.entries=e,this.behaviours=t,this.debug=i,this.events={},this.logs={},this.performanceLogger=new g(this.debug)}getLogs(){return this.performanceLogger.getLogs()}resetLogs(){this.performanceLogger.resetLogs()}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),!0}off(e,t){return!(!this.events[e]||!this.events[e].includes(t)||(this.events[e]=this.events[e].filter((e=>e!==t)),0))}emitEntry(e,...t){const i=this.performanceLogger.start(["entry",e]),r=this.callTargets(e,"entry",this.entries,...t);return this.performanceLogger.end(i),r}emitBehaviour(e,t,...i){const r=this.behaviours[t.getType()];if(!r||!r.length)return[];const s=this.performanceLogger.start(["behaviour",e,t.getType()]),a=this.callTargets(e,"behaviour",r,t,...i);return this.performanceLogger.end(s),a}emitCollectionBehaviour(e,t,...i){const r=this.behaviours[t.getType()];return r&&r.length?this.callTargets(e,"collection",r,t,...i):[]}emitEvent(e,...t){this.events[e]&&this.callEvents(e,this.events[e],...t)}requestEvent(e,...t){return this.events[e]?this.requestEvents(e,this.events[e],...t):[]}callEvents(e,t,...i){for(const r of t)try{r(...i)}catch(t){Sys.logger.error(`[Emitter] Failed to run method on listener for message "${e}"`),Sys.logger.debug(t.toString()),lab_api.v1.app.logError(t)}}requestEvents(e,t,...i){const r=[];for(const s of t)try{const e=s(...i);void 0!==e&&r.push(e)}catch(t){Sys.logger.error(`[Emitter] Failed to run method on listener for message "${e}"`),Sys.logger.debug(t.toString()),lab_api.v1.app.logError(t)}return r}callTargets(e,t,i,...r){const s=[];for(const a of i)try{if(a.isEnabled){const t=a.call(e,...r);null!=t&&s.push(t)}}catch(i){Sys.logger.error(`[Emitter] Call to method ${e} on '${a.name}' failed:`),console.error(i),lab_api.v1.app.logViewError(i,t)}return s}registerEntry(e){return!this.entries.includes(e)&&(this.entries.push(e),!0)}registerBehaviour(e,t){return this.behaviours[e]||(this.behaviours[e]=[]),!this.behaviours[e].includes(t)&&(this.behaviours[e].push(t),!0)}}class h{static build(e,t,i){let r;const s=[],a=i||"&",o=(e,t,i)=>{let r,s=t;const a=[];if(!0===s?s="1":!1===s&&(s="0"),null!=s){if("object"==typeof s){for(r in s)null!=s[r]&&a.push(o(`${e}[${r}]`,s[r],i));return a.join(i)}if("function"!=typeof s)return`${this.urlencode(e)}=${this.urlencode(s)}`;throw new Error("There was an error processing for http_build_query().")}return""};for(const i of Object.keys(e)){r=e[i];let n=i;t&&!Number.isNaN(n)&&(n=String(t)+n);const l=o(n,r,a);""!==l&&s.push(l)}return s.join(a)}static urlencode(e){return encodeURIComponent(`${e}`).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")}}class f extends u{constructor(e,t,i,r,s,a,o=!1){super({behaviours:s,debug:o}),this.properties=e,this.templates=t,this.configReader=i,this.propertyValidator=r,this.pathHelper=a,this.resolved={properties:new Map,templates:new Map,resourceMaps:new Map},this.appMode=i.getCms("app.mode"),this.pageTemplateName="default",this.resourceSettings=this.resolveResourceSettings(),this.viewportList=new Map,this.rootId=null,this.feedBaseUrl=`${this.configReader.getCms("front_api_url")}/feed/item`,this.isFragmentMode=!1,this.feedCounter={}}getPathInfo(e,t,i="stage"){const r=e.split("/"),s=r.pop();let a;return a=s.startsWith("page_")?`${s.replace("page_","page/")}/${this.pageTemplateName}`:`content/${s}`,{type:s,resourceType:a,area:i,modeList:this.getPrioritizedModes(),viewportList:this.getPrioritizedViewports(t),contextList:this.getPrioritizedContexts(`${r.join("/")}/`)}}resolveResourceSettings(){const e=l.object(this.configReader.get("resourceAllocation",{useSites:!1}),{resourceMaps:["_resources"]});"string"==typeof e.resourceMaps&&(e.resourceMaps=[e.resourceMaps]);const t=this.configReader.getCms("site.alias"),i=l.object(this.configReader.get("resourceAllocation",{site:t}));let r=[];if(Array.isArray(i.resourceMaps)&&r.push(...i.resourceMaps),!r.length||l.true(i.mergeMaps)){const t=[];for(const i of e.resourceMaps)r.includes(i)||t.includes(i)||t.push(i);t.length&&(r=[...t,...r])}return{names:r}}getResourceMap(e,t){if(this.resolved.resourceMaps.has(e.type))return this.resolved.resourceMaps.get(e.type);let i={labPaths:this.getEmptyPathObject()};for(const t of this.resourceSettings.names){const r=`${e.resourceType}/${t}.json`,s=this.getPropertyFile(r);s?(i.labPaths.maps.push(r),i=this.mergeObject(i,s)):Sys.logger.warn(`[ResourceManager] Cannot find resource-map for element "${e.type}". Tried "${r}".`)}if(t){const r=this.emitBehaviour("onResourceMap",t,{...i},{type:e.type,resourceType:e.resourceType});r.length&&(Sys.logger.warn(`[ResourceManager] Resource-map is overridden by a bahaviour for model "${t.getPositionedPath()}".`),i=r.pop())}return this.resolved.resourceMaps.set(e.type,i),i}getPaths(e,t,i){let r=[];for(const s of i.modeList){const a=this.getContextsForModeAndArea(e,s,i);if(a)for(const e of i.contextList){const o=this.getContexts(a,t,e);if(o.length)for(const e of o){const t=this.getPathForViewports(e.match,i);if(t)for(const i of Array.isArray(t.resources)?t.resources:[t.resources])r=r.filter((e=>e.path!==i)),r.push(this.getPathDescription({path:i,context:e.context,viewport:t.viewport,mode:s}))}}}return r.length||Sys.logger.debug(`ResourceManager: Cannot get ${t} for ${i.type}. Context-list: ${i.contextList.join(", ")}, area: ${i.area}`),r}getPathForViewports(e,t){for(const i of t.viewportList)if(e[i])return{resources:e[i],viewport:i};return null}getPathLength(e=""){return this.trimPath(e).replace(/\/\//g,"/||/").split("/").map((e=>e?"||"===e?.2:"*"===e?.6:1:0)).reduce(((e,t)=>e+t))}sortContexts(e){const t=e.sort(((e,t)=>this.getPathLength(e)-this.getPathLength(t)||e.localeCompare(t))),i=t.indexOf("lab-default");return i>0&&(t.splice(i,1),t.unshift("lab-default")),t}trimPath(e){let t=e;return t.startsWith("/")&&!t.startsWith("//")&&(t=t.substring(1)),t.endsWith("/")&&!t.endsWith("//")&&(t=t.substr(0,t.length-1)),t}getContexts(e,t,i){const r=this.sortContexts(Object.keys(e)),s=[];for(const a of r)if(e[a][t]){const r=this.pathHelper.pathMatch(a,i);r&&s.push({match:e[r][t],context:a})}return s}getContextsForModeAndArea(e,t,i){return n.get(`${t}.${i.area}`,e)||null}getPropertyFile(e){return this.properties[e]?{...this.properties[e]}:null}getEmptyPathObject(){return{maps:[],properties:[],map:[]}}getPathDescription(e={}){return{path:e.path||null,context:e.context||null,viewport:e.viewport||null,mode:e.mode||null,requiredBy:e.requiredBy||null}}resolveInheritance(e,t){if(!e.includeFiles)return e;let i=e;for(const r of e.includeFiles)if(!i.labPaths.properties.includes(r)){const e=this.getPathDescription(t);e.requiredBy=e.path,e.path=r;const s=this.resolvePropertyFileWithDescription(e);s&&(i=this.mergeObject(s,i))}return i}getTemplateFile(e){return this.templates[e]||null}getPrioritizedViewports(e){if(!this.viewportList.get(e)){const t=e?[e]:[];this.configReader.get(`viewports.${e||"default "}.noFallback`)||t.push("default"),this.viewportList.set(e,t)}return this.viewportList.get(e)}getPrioritizedModes(){const e=[this.appMode];return"edit"===this.appMode&&e.unshift("presentation"),e}getPrioritizedContexts(e){return["lab-default",e]}mergeObject(e,t){const i=n.merge(e,t);return e.labPaths&&t.labPaths&&(i.labPaths.properties=e.labPaths.properties.concat(t.labPaths.properties),i.labPaths.map=e.labPaths.map.concat(t.labPaths.map)),i}getCacheKey(e,t,i){return`${e||"no-path"}-${t}-${i}`}rootModelReady(e){this.isFragmentMode=lab_api.v1.app.mode.isFragmentMode(),e&&(this.rootId=e.get("id"),e&&e.getType().startsWith("page_")&&this.setPageTemplateName(e.get("fields.page_template_alias")||"default"))}setPageTemplateName(e="default"){Sys.logger.debug(`[ResourceManager] Will use page-template "${e}".`),"undefined"===e?(Sys.logger.warn("[ResourceManager] Invalid page_template_alias detected. Will override template to 'default'."),this.pageTemplateName="default"):this.pageTemplateName=e}getAreaFromPath(e,t){return e&&e.includes("pasteboard/")?"pasteboard":"stage"}getPropertiesForPath(e,t,i,r=this.getAreaFromPath(e)){e||Sys.logger.warn('ResourceManager.getPropertiesForPath: Missing required param "path". Will return default properties.');const s=this.getCacheKey(e,i,r);if(this.resolved.properties.has(s))return this.resolved.properties.get(s);let a={labPaths:this.getEmptyPathObject()};const o=this.getPathInfo(e,i,r),n=this.getResourceMap(o,t),l=this.getPaths(n,"properties",o);for(const e of l){const t=this.resolvePropertyFileWithDescription(e);t&&(a=this.mergeObject(a,t))}return a.labPaths.maps=n.labPaths.maps,this.resolved.properties.set(s,this.propertyValidator(a)),this.resolved.properties.get(s)}resolvePropertyFile(e){return this.resolvePropertyFileWithDescription(this.getPathDescription({path:e}))}resolvePropertyFileWithDescription(e){const t=this.getPropertyFile(e.path);return t?(t.labPaths=this.getEmptyPathObject(),t.labPaths.properties.push(e.path),t.labPaths.map.push(e),this.resolveInheritance(d.resolve(t,e.path,this.configReader),e)):(Sys.logger.warn(`ResourceManager: Cannot find property-file for path: ${e.path}.`),null)}getTemplateForPath(e,t,i,r=this.getAreaFromPath(e)){const s=this.getCacheKey(e,i,r);if(this.resolved.templates.has(s))return this.resolved.templates.get(s);const a={paths:null,resource:null},o=this.getPathInfo(e,i,r),n=this.getResourceMap(o,t);return a.paths=this.getPaths(n,"template",o),a.paths.length&&(a.resource=this.getTemplateFile([...a.paths].pop().path)),a.resource||(Sys.logger.debug(`ResourceManager: Cannot find template for path: ${e}, viewport: ${i}, area: ${o.area}. Will assign default template.`),a.resource=this.getDefaultTemplate(e)),this.resolved.templates.set(s,a),a}getDefaultTemplate(e){return"edit"===this.appMode?"<div>{{{ children.all }}}</div>":"{{{ children.all }}}"}getPropertiesForModel(e,t,i){return this.getPropertiesForPath(e.getPath(),e,t.viewport,i)}getTemplateForModel(e,t,i){if("presentation"===this.appMode&&!this.isFragmentMode&&"1"===e.get("fields.isAutomatic"))return`<div data-lab-placeholder="include" src="${this.getFeedUrl(e,t)}" ></div>`;const r=this.getTemplateForPath(e.getPath(),e,t.viewport,i);return r.paths.length&&t.setTemplatePath([...r.paths].pop().path),r.resource}getFeedUrl(e,t){const i=e.get("fields.feedId"),r=e.get("fields.feedParams")||{};let s="";Object.keys(r).length&&(s=`?${h.build(r)}`),void 0===this.feedCounter[i]&&(this.feedCounter[i]=0);const a=this.feedCounter[i]++;return`${this.feedBaseUrl}/${i}/${this.rootId}/${a}${s}`}}class m{constructor(e,t,i){this.viewport=e,this.model=t,this.eventPipe=i,this.markup=null,this.markupString=null,this.template=null,this.templatePath=null,this.properties=null,this.data=null,this.size=this.getEmptySizeObject(),this.proxies={current:null,child:null,children:null,childMarkup:null,childrenMarkup:null,store:{get:null,set:null}},this.cache=new Map}static resolveConfig(e={}){return lab_api.v1.app.dbg.logger.add("LabView","resolveConfig"),{labPaths:e.labPaths||{maps:[],properties:[],map:[]},boxTitle:e.boxTitle||"",boxDescription:e.boxDescription||"",boxKeywords:e.boxKeywords||"",childLimit:e.childLimit||null,includeFiles:l.array(e.includeFiles,null),gridRules:e.gridRules||[],viewHelper:e.viewHelper||null,viewportMap:l.object(e.viewportMap),bodytextElements:l.array(e.bodytextElements),bodytextHeadingElements:l.array(e.bodytextHeadingElements),overrideImageSize:l.object(e.overrideImageSize),image:l.object(e.image,null,{defaultAspectRatio:null}),external:l.object(e.external,null,{url:null,type:"html",headers:null})}}getEmptySizeObject(){return{grid:null,pixelWidths:null,gridWidth:null,absGridWidths:null,absGridCss:null}}isPrepared(){return!1}setPreparedState(e){}setMarkupString(e){this.markupString=e}getMarkup(){return null}getMarkupString(){return this.markupString||""}setGrid(e){this.size.grid=e}getGrid(){return this.size.grid}setPixelWidths(e){this.size.pixelWidths=e}getPixelWidth(){return this.size.pixelWidths[this.viewport]}getPixelWidths(){return this.size.pixelWidths}setGridWidth(e){this.size.gridWidth=e}getGridWidth(){return this.size.gridWidth}getAbsoluteGridWidth(){return this.size.absGridWidths?this.size.absGridWidths[this.viewport]:null}setAbsoluteGridWidths(e){this.size.absGridWidths=e}getAbsoluteGridWidths(){return this.size.absGridWidths}getAbsGridCss(){return this.size.absGridCss}setAbsGridCss(e){this.size.absGridCss=e}getWidth(){return this.get("width")}setWidth(e,t=!1){this.set("width",e,t)}setData(e){this.data=e}getData(){return this.data}getProxy(){return this.proxies.current}setProxy(e){this.proxies.current=e}getChildrenProxy(){return this.proxies.children}setChildrenProxy(e){this.proxies.children=e}getChildProxy(){return this.proxies.child}setChildProxy(e){this.proxies.child=e}getChildMarkupProxy(){return this.proxies.childMarkup}setChildMarkupProxy(e){this.proxies.childMarkup=e}getChildrenMarkupProxy(){return this.proxies.childrenMarkup}setChildrenMarkupProxy(e){this.proxies.childrenMarkup=e}getStoreProxy(e){return this.proxies.store.set&&this.proxies.store.get?e?this.proxies.store.set:this.proxies.store.get:null}setStoreProxy({get:e,set:t}){this.proxies.store.get=e,this.proxies.store.set=t}setTemplate(e){this.template=e}getTemplate(){return this.template}setTemplatePath(e){this.templatePath=e}getTemplatePath(){return this.templatePath}setProperties(e,t=!1){this.properties=t?e:this.constructor.resolveConfig(e)}getProperties(){return this.properties}getProperty(e,t){return n.get(e,this.properties,t)}getViewport(){return this.viewport}getviewportOrder(e,t=null,i=this.viewport){return this.eventPipe.getViewportOrder(this,this.model.getPath(),e,t,i)}getCacheKey(e,t,i=!1){return`${e}|${i?1:0}|${t}`}get(e,t=!1,i=this.viewport){lab_api.v1.app.dbg.logger.add(this.constructor.name,"get",this.viewport);const r=this.getCacheKey(e,i,t);if(this.cache.has(r))return this.getCache(r);const s=this.model.buildQuery(e),a=this.getviewportOrder(s.path,s.attribute,i);if(!a.length){const e=this.model.get(s.key,null,t);return this.setCache(r,e)}for(const e of a){const t=this.model.get(s.key,e,!0);if(void 0!==t)return this.setCache(r,t)}return this.setCache(r,t?void 0:null)}set(e,t,i=!1){if(lab_api.v1.app.dbg.logger.add(this.constructor.name,"set",this.viewport),!e)return!1;const r=this.model.buildQuery(e),s=this.getviewportOrder(r.path,r.attribute);return this.model.set(r.key,t,{save:!i,viewport:s[0]})}setAll(e,t=!0){if(e&&"object"==typeof e&&!Array.isArray(e)){for(const t of Object.keys(e))this.set(t,e[t],!0);t&&lab_api.v1.app.save()}else Sys.logger.warn("[LabView] Method setAll expect an object containing key/value pars of data to store. Non-object given.")}setTransparent(e,t){const i=this.model.buildQuery(e),r=this.getviewportOrder(i.path,i.attribute),s=this.model.buildQuery(e,r[0]);let{path:a}=s;return s.attribute&&(a="fields"===s.type?`${s.path}.attributes.${s.attribute}`:`${s.path}.${s.attribute}`),n.get(a,n.set(s.fullPath,t,{}))}setCache(e,t){return this.cache.set(e,t),this.getCache(e)}getCache(e){const t=this.cache.get(e);return t&&"object"==typeof t?Array.isArray(t)?[...t]:{...t}:t}resetCache(e,t=this.getViewport()){const i=this.getCacheKey(e,t);this.cache.delete(i),this.cache.forEach(((i,r,s)=>{r.startsWith(`${e}.`)&&r.endsWith(`|${t}`)&&this.cache.delete(r)}))}}class b{static generateShapes(e,t){if(!e)return"";const i=JSON.parse(e);let r="";for(const e of i)r+=this.createShape(e,t);return r}static createShape(e,t){return`<div class="imageShape" style="${this.getStyle(e,t)}"></div>`}static getStyle(e,t){const i=this.getPosition(e,t),r=this.getSize(e,t);return`position: absolute;\n        width: ${r.w}%;\n        height: ${r.h}%;\n        top: ${i.y}%;\n        left: ${i.x}%;\n        border-width: ${e.borderwidth}px;\n        border-color: ${e.bordercolor};\n        border-style: ${e.borderstyle};\n        border-radius: ${"circle"===e.shape?"50%":"0"};\n        background: ${e.background||"transparent"};\n        z-index: ${e.zindex};`}static getPosition(e,t){return{x:(e.x-t.x)*(100/t.cropw),y:(e.y-t.y)*(100/t.croph)}}static getSize(e,t){return{w:e.width*(100/t.cropw),h:e.height*(100/t.croph)}}}class y{constructor(e,t){this.api=e,this.isEditor=this.api.v1.app.mode.isEditor(),this.viewport=t.viewport,this.viewports=this.api.v1.config.get("viewHelper.image.viewports"),this.viewports.includes(this.viewport)||this.viewports.push(this.viewport),this.logger=t.logger,this.imageServer=this.api.v1.properties.get("image_server"),this.cropParamsFloat=["x","y","cropw","croph","panox","panoy","panow","panoh","heightx","heighty","heightw","heighth"],this.cropParamsString=["float","shapes"],this.privateCropParams=["bbRatio","whRatio","viewports_json","metadata_key"],this.allFields=[...this.cropParamsFloat,...this.cropParamsString,...this.privateCropParams],this.imageUrlOptions=this.api.v1.config.get("imageUrlOptions")||{},this.preferWebp=".webp"===this.api.v1.config.get("imageUrlOptions.extension"),this.maxDimension=3e3,this.pixelDensityFactors=this.readPixelDensity(),this.logger.debug(`Image-helper created. Will prepare image-data for viewports: ${this.viewports.join(", ")}.`)}static getImageProperties(e={}){const t=e.crop||{},i=t.pano||{},r=t.height||{};return{cropw:i.cropw||0,croph:i.croph||0,x:i.x||0,y:i.y||0,heightw:r.cropw||0,heighth:r.croph||0,heightx:r.x||0,heighty:r.y||0,imageCaption:e.imageCaption||""}}run(e,t){if(!e.hasNodeData())return this.logger.debug(`Image has no node-data, skipping. Path: "${e.getPositionedPath()}"`),void this.api.v1.model.noRender(e);const i=t.getProperty("image.defaultAspectRatio")||this.api.v1.config.get("image.defaultAspectRatio")||.5,r=t.getProperty("image.defaultBoundingBoxWidthRatio")||this.api.v1.config.get("image.defaultBoundingBoxWidthRatio")||1,s=t.getPixelWidths(),a=e.getData("instance_of"),o=e.get("fields.imageurl"),n=e.get("fields.forceImageUrl"),l={},d=[],c=this.imageUrlOptions.nameField?e.get(this.imageUrlOptions.nameField):null,p="_articlefeed"===e.get("fields.source"),g="1"===e.get("fields.isLabradorImageUrl"),u=this.preferWebp&&p?"webp":null,h=[];if((this.preferWebp||"webp"===u)&&h.push({format:"webp",type:"image/webp"}),h.push({format:"jpg",type:"image/jpeg"}),!o&&!a)return this.isEditor?e.setFiltered("image","/images/lab-head_1000.png"):e.setFiltered("image",`${this.api.v1.config.get("image.fallbackUrl")||"/404-image.png"}?noImageFound`),void(e.get("state.isUploading")?e.setFiltered("imageLoadingClass","lab-uploading-image labicon-cloud_up"):e.setFiltered("imageLoadingClass","lab-missing-image"));for(const e of this.viewports){const f={width:t.get("fields.width",!1,e)||t.getProperty("overrideImageSize.width"),height:t.get("fields.height",!1,e)||t.getProperty("overrideImageSize.height")},m=s[e],y={};for(const i of this.allFields){const r=t.get(`fields.${i}`,null,e);(r||"0"===r||0===r)&&(y[i]=r)}const v={imageId:p?void 0:a,format:u,bbRatio:t.get("filtered.bbRatio",null,e)||y.bbRatio||r,whRatio:t.get("filtered.whRatio",null,e)||y.whRatio||i},w={float:null,border:null,shapes:null};for(const e of this.cropParamsFloat)if(void 0!==y[e]){const t=parseFloat(y[e]||0);v[e]=t.toFixed(2)}for(const e of this.cropParamsString){const t=y[e]||null;t&&"null"!==t&&(w[e]=t)}v.width=t.get(`filtered.width.${e}`,null,e)||f.width||Math.ceil(m*v.bbRatio),v.height=t.get(`filtered.height.${e}`,null,e)||f.height||Math.ceil(v.width*v.whRatio);const _={width:v.width,height:v.height};if(v.width=Math.round(v.width*this.pixelDensityFactors[e]),v.height=Math.round(v.height*this.pixelDensityFactors[e]),v.width/v.height>1){if(v.width>this.maxDimension){const e=this.maxDimension/v.width;v.width=Math.floor(v.width*e),v.height=Math.floor(v.height*e)}}else if(v.height>this.maxDimension){const e=this.maxDimension/v.height;v.height=Math.floor(v.height*e),v.width=Math.floor(v.width*e)}const k=this.generateUrl(v,{imageurl:o,forceImageUrl:n,instanceOf:a,isLabradorImageUrl:g,imageUrlOptionsNameValue:c}),x=w.shapes?b.generateShapes(w.shapes,y):"";l[e]={viewport:e,url:k,formats:h,width:_.width,height:_.height,shapes:x,borderClass:"on"===w.border?"borderOn":""},d.push(l[e])}const f=l[this.viewport];e.setFiltered("viewport_list",l),e.setFiltered("viewport_array",d),e.setFiltered("image",f.url),e.setFiltered("imageWidth",f.width),e.setFiltered("imageHeight",f.height),e.setFiltered("borderClass",f.borderClass),e.setFiltered("shapes",f.shapes),e.setFiltered("imageLoadingClass",a?"":o?"lab-content-busy":"lab-is-dummy-image")}generateUrl(e,t={}){const i=[],r={width:e.width||t.width||150,height:e.height||t.height||100},s={imageId:e.imageId||t.imageId,x:e.x,y:e.y,cropw:e.cropw,croph:e.croph,panox:e.panox,panoy:e.panoy,panow:e.panow,panoh:e.panoh,heightx:e.heightx,heighty:e.heighty,heightw:e.heightw,heighth:e.heighth,width:r.width,height:r.height,format:e.format||void 0};for(const e of Object.keys(s))void 0!==s[e]&&i.push(`${e}=${s[e]}`);let a=this.imageServer,o="?";return!t.imageurl||!t.forceImageUrl&&t.instanceOf?t.instanceOf?this.imageUrlOptions&&t.imageUrlOptionsNameValue&&(a+=`/${t.imageUrlOptionsNameValue}${t.format?`.${t.format}`:this.imageUrlOptions.extension}`):a="":(-1!==t.imageurl.indexOf(this.imageServer)||t.isLabradorImageUrl?a=t.imageurl:a+=`?imageUrl=${t.imageurl}`,o="&"),a&&(a+=o+i.join("&")),a}readPixelDensity(){const e={};for(const t of this.viewports)e[t]=this.api.v1.view.getPixelDensityFactor(t);return e}}const v={unique:(e=8)=>{const t=`0x${Math.pow(10,e-1)}`;return Math.floor((1+Math.random())*t).toString(16)},async digestString(e){const t=(new TextEncoder).encode(e),i=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("")},trim(e,t){let i=(e||"").trim(),r=[];void 0===t?r.push(" "):"string"==typeof t?r.push(t):r=t;for(let e=0;e<r.length;e++)0===i.indexOf(r[e])&&(i=i.slice(r[e].length)),i.lastIndexOf(r[e])>-1&&i.lastIndexOf(r[e])===i.length-r[e].length&&(i=i.slice(0,i.length-r[e].length));return i.trim()},stripTags:(e="",t="")=>(e||"").replace(/<(?:.|\n)*?>/gm,t).trim(),stripLinks:(e="")=>(e||"").replace(/<a[^>]*>(.*?)<\/a>/gm,"$1"),sanitizeString:(e="")=>v.stripTags(e||"").replace(/"/g,"'"),toFileName:(e="")=>e.replace(/\s+/gi,"-").replace(/[^a-zA-Z0-9\-._]/gi,""),ucFirst(e=""){const t=e||"";return t.charAt(0).toUpperCase()+t.slice(1)},parsePath(e=""){const t=this.trim(e,"/").split("/"),i=/\[([0-9]+)\]/;return t.map((e=>{const t={base:e,index:null,path:e},r=i.exec(e);return r&&(t.index=parseInt(r[1],10),t.base=e.replace(`[${t.index}]`,"")),t}))},insertAtPosition:(e,t,i)=>[e.slice(0,t),i,e.slice(t)].join(""),labCtrlKey:()=>navigator.platform.toLowerCase().indexOf("mac")>=0?"⌘":"⊞",shiftKey:()=>"⇧",altKey:()=>navigator.platform.toLowerCase().indexOf("mac")>=0?"⌥":"alt",arrowUp:()=>"↑",arrowDown:()=>"↓",arrowLeft:()=>"←",arrowRight:()=>"→",keyMapper(e){if(!e)return"";switch(e){case" ":return"space";case"labCtrlKey":case"metaKey":return v.labCtrlKey();case"shiftKey":return v.shiftKey();case"altKey":return v.altKey();case"ArrowUp":return v.arrowUp();case"ArrowDown":return v.arrowDown();case"ArrowLeft":return v.arrowLeft();case"ArrowRight":return v.arrowRight();default:return v.ucFirst(e.replace("Key",""))}},hotkeyString:(e={})=>[...(e.controlkeys||[]).map((e=>v.keyMapper(e))),v.keyMapper(e.key)].map((e=>`<span class="lab-label-hotkey">${e}</span>`)).join("+"),niceNumber(e,t=" "){let i=`${e}`;const r=i.split(".");i=r.shift();let s="";for(;i.length>3;)s=`${t}${i.slice(-3)}${s}`,i=i.slice(0,-3);return(i+s).trim()+(r.length?".":"")+r.join(".")}};class w{static getLineData(e,t,i=!1){const r={};r.bodytext=this.getBodytext(e,t,i),r.tags=t.getProperty("bodytextElements")||["p"],r.headingTags=t.getProperty("bodytextHeadingElements")||["h1","h2","h3"],r.indexRegister=[];let s=0,a=0;w.analyze(r.bodytext).forEach((e=>{if(r.tags.indexOf(e.tag)>-1){const t={charIndex:e.index,bodytextIndex:s++};r.headingTags.indexOf(e.tag)>-1&&(t.bodytextHeadingIndex=a++),r.indexRegister.push(t)}})),r.indexRegister.reverse();for(const e of r.indexRegister)if("number"==typeof e.bodytextHeadingIndex){e.lastHeading=!0;break}return r}static getBodytext(e,t,i=!1){const r=e.get("fields.bodytext")||"";return!i||r?r:t.data.placeholder.bodytext||""}static analyze(e=""){const t=[],i=new RegExp("<([\\/a-zA-Z0-9\\-]*?)(?: .*?)?>","g"),r={tag:null,index:0,level:0};return e.replace(i,((e,i,s)=>{const a=i.indexOf("/"),o=a>-1?i.replace("/",""):i;r.tag?o===r.tag&&(a<0?r.level++:r.level>0?r.level--:(t.push({tag:r.tag,index:r.index,length:s+e.length-r.index}),r.tag=null)):(r.tag=o,r.index=s)})),t}}class _{constructor(e,t){this.api=e,this.viewport=t.viewport,this.allViewports=this.api.v1.viewport.getAll(),this.mainViewport=this.api.v1.viewport.getMain(),this.logger=t.logger,this.viewManager=t.viewManager,this.lineClassSelector="lab-bodytext-line",this.logger.debug(`Bodytext-helper created. Will prepare data for viewports: ${this.allViewports.join(", ")}.`)}run(e,t){this.insertContent(e,t)}insertContent(e,t){const i={bodyText:[],bodyTextHeading:[],lastBodyTextHeading:[]};let r=0;const s=w.getLineData(e,t,this.api.v1.app.mode.isEditor());for(const t of e.children){const e=this.viewManager.getView(t),r=e.get("metadata.bodyTextIndex"),a="number"==typeof r?r:null,o=e.get("metadata.bodyTextHeadingIndex");if(e.get("metadata.lastBodyTextHeading"))i.lastBodyTextHeading.push(t);else if("number"==typeof o)i.bodyTextHeading[o]=i.bodyTextHeading[o]||[],i.bodyTextHeading[o].push(t);else if("number"==typeof a)i.bodyText[a]=i.bodyText[a]||[],i.bodyText[a].push(t);else{const e=s.indexRegister[0]?s.indexRegister[0].bodytextIndex+1:0;i.bodyText[e]=i.bodyText[e]||[],i.bodyText[e].push(t)}}let{bodytext:a}=s;for(const e of s.indexRegister){if(void 0!==i.bodyText[e.bodytextIndex]){const t=this.createMarkup(i.bodyText[e.bodytextIndex],e.charIndex,a);a=t.bodytext,r+=t.count}if(void 0!==e.bodytextHeadingIndex&&void 0!==i.bodyTextHeading[e.bodytextHeadingIndex]){const t=this.createMarkup(i.bodyTextHeading[e.bodytextHeadingIndex],e.charIndex,a);a=t.bodytext,r+=t.count}if(e.lastHeading&&i.lastBodyTextHeading.length){const t=this.createMarkup(i.lastBodyTextHeading,e.charIndex,a);a=t.bodytext,r+=t.count}}for(const e of Object.keys(i.bodyText)){const t=i.bodyText[e];if(t&&t.length)for(const e of t){const t=this.viewManager.getView(e);!0!==t.get("metadata.skipIfOutOfBounds")&&(a+=t.getMarkupString(),r++)}}for(const e of i.lastBodyTextHeading){const t=this.viewManager.getView(e);!0!==t.get("metadata.skipIfOutOfBounds")&&(a+=t.getMarkupString(),r++)}Sys.logger.debug(`Bodytext: Parsed bodytext. Inserted ${r} of ${e.children.length} structures. Tags: [${s.tags.join(", ")}]. Line-count: ${s.indexRegister.length}.`),e.setFiltered("lineData",s),e.setFiltered("bodytext",a)}createMarkup(e,t,i){let r=0,s="";for(;e.length;){const t=e.shift();s+=this.viewManager.getView(t).getMarkupString(),r++}return{count:r,bodytext:v.insertAtPosition(i,t,s)}}getIndexes(e,t){const{indexRegister:i}=w.getLineData(e,t,this.api.v1.app.mode.isEditor());return i.map((e=>e.bodytextIndex))}isBodytextLine(e,t){return e===t||!!this.api.v1.util.dom.getParentByClass(e,t,this.lineClassSelector)||e.classList.contains(this.lineClassSelector)}getLineClassSelector(){return this.lineClassSelector}}class k{constructor(e,t){this.api=e,this.viewport=t.viewport,this.logger=t.logger,this.viewManager=t.viewManager,this.settings=t.settings,this.isEditor=t.isEditor,this.apiUrl=this.api.v1.properties.get("front_api_url")}run(e,t){if(this.isEditor&&e.isPseudo())return;const i=t.getProperty("external");if(!i||!i.url)return void this.logger.warning(`[External] Missing required config "external" or "external.url" for model ${e.getPositionedPath()}. No external content will be fetched.`);if(this.settings.fragmentMode){let r;const s=e.isNonPersistent();if(s){const t=this.api.v1.model.query.getRootModel(),i=e.getPositionedPath();t.get("fields.labExternalPath")===i&&(r=t.get("fields.labExternalData"),r&&(e.set("fields.isFragment","1",{notify:!1,registerModified:!1,save:!1,undoable:!1}),e.set("metadata.isFragment","1",{notify:!1,registerModified:!1,save:!1,undoable:!1})))}else r=e.get("fields.labExternalData");if(r){this.logger.debug(`[External] Data is available for ${s?"non-persistent":"persistent"} element ${e.getPositionedPath()}.`);let a=r;if(r&&this.isExternalData(i))try{a=JSON.parse(r)}catch(t){this.logger.warn(`[External] Cannot parse fetched external data for model ${e.getPositionedPath()}.`),a={}}return void e.set("external",a,{save:!1,undoable:!1})}}const r=this.getUrl(e,t,i,this.isEditor);if(r){if(this.isEditor){const s=e.get("state.requireExternal")||{},a=!0===s[t.getViewport()];return this.viewManager.getExternalContent(e,t,r,i,a),void(a&&(s[t.getViewport()]=!1,e.set("state.requireExternal",s,{save:!1,undoable:!1,notify:!1})))}t.setTemplate(`<div data-lab-placeholder="include" src="${r}" ></div>`)}}isExternalData(e){return"json"===e.type}getUrl(e,t,i,r){const s=Mustache.render(i.url,t.getData());if(!s)return this.logger.debug(`[External] Resolved empty url for model ${e.getPositionedPath()}`),null;lab_api.v1.app.dbg.extensiveLogging&&this.logger.debug(`[External] Resolved url for model ${e.getPositionedPath()}: "${s}"`);const a=encodeURIComponent(s),o=[`lab_viewport=${this.viewport}`];return i.headers&&o.push(`headers=${encodeURIComponent(JSON.stringify(i.headers))}`),this.buildUrl(e,a,r,o)}buildUrl(e,t,i,r){const s=r.length?r.join("&"):null;return i?`${this.api.v1.properties.get("proxy")}?query=${t}${s?`&${s}`:""}`:e.isNonPersistent()?`${this.apiUrl}/external/dynamic-data/${this.settings.contentId}/?path=${encodeURIComponent(e.getPositionedPath())}&url=${t}${s?`&${s}`:""}`:`${this.apiUrl}/external/node/${e.getId()}/${this.settings.contentId}/${t}${s?`?${s}`:""}`}}class x{constructor(e){this.description=e,this.startTime=this.getTime(),this.steps=[]}getTime(){return(new Date).getTime()}start(e="[default]"){return{time:this.getTime(),description:e,duration:0}}stop(e){return e.duration=this.getTime()-e.time,this.steps.push(e),e.duration}step(e="[default]"){const t={time:this.getTime(),description:e};return t.duration=this.steps.length>0?t.time-this.steps[this.steps.length-1].time:t.time-this.startTime,this.steps.push(t),t.duration}getMin(){let e=null,t=null;for(const i of this.steps)(null===e||i.duration<e)&&(e=i.duration,t=i);return{time:e,step:t}}getMax(){let e=0,t=null;for(const i of this.steps)(null===t||i.duration>e)&&(e=i.duration,t=i);return{time:e,step:t}}getSteps(){let e=0,t=0,i=null,r=null,s=null;for(const a of this.steps)e+=a.duration,(null===r||a.duration>t)&&(t=a.duration,r=a),(null===i||a.duration<i)&&(i=a.duration,s=a);return{description:this.description,totalTime:e,minTime:i,maxTime:t,meanTime:Math.round(e/this.steps.length),minTimeStep:s,maxTimeStep:r,steps:this.steps}}}const P={percentToGrid:(e,t=12)=>Math.round(e/100*t),gridToPercent:(e,t=12)=>P.floatPrecision(e/t*100),floatPrecision:e=>parseFloat(parseFloat(e).toFixed(2)),distributePercent:(e,t,i=12)=>P.distributeGrid(P.percentToGrid(e,i),t).map((e=>P.gridToPercent(e,i))),distributeGrid:(e,t)=>{let i=t;i>e&&(i=e,Sys.logger.warn(`grid.distributeGrid: Requested count ${t} is larger than gridSize ${e}. Will use count ${i}.`));const r=e/i;if(Number.isInteger(r))return Array(i).fill(r);let s=0,a=!0,o=[];for(let e=0;e<i;e++){const e=a?Math.ceil(r):Math.floor(r);o.push(e),s+=e,a=!a}let n=s-e;if(s!==e){const e=[];for(;n>0&&o.length;){let t=o.shift();t>1&&(t--,n-=1),e.push(t)}o=o.concat(e)}return o.length!==i&&Sys.logger.warn(`Utility-method grid.distributeGrid will return a faulty array. Excpected a count of ${i}, got ${o.length} ...`),o}},C={getData:(e,t,i,r,s,a)=>{const o=P.percentToGrid(e,r.span),n={};for(const e of Object.keys(t))n[e]=P.percentToGrid(t[e],r.span);const l={width:o,css:"",vp:{},cssVp:{}},d=C.getMatchingRule(s,i,r.span);l.vp=C.applyRule(o,n,s.length,d.values,r,a);for(const e of Object.keys(r.prefix))l.cssVp[e]=r.prefix[e]+l.vp[e];return l.css=Object.values(l.cssVp).join(" "),l},applyRule:(e,t,i,r,s,a)=>{const o={};for(const n of Object.keys(s.prefix)){let s=null;t[n]?s=t[n]:r[n]&&(s=C.getMatchingRuleValue(r[n],a,i,e)),o[n]=s?parseInt(s,10):e}return o},getMatchingRuleValue:(e,t,i,r)=>{for(const s of Object.keys(e)){if("first-child"===s&&0===t)return e[s];if("last-child"===s&&t===i-1)return e[s];if("inherit"===s&&e[s])return r;if(C.getNthChild(s)===t+1)return e[s]}return e.default?e.default:null},getNthChild:e=>"nth-child("===e.substring(0,10)?parseInt(e.substring(0,e.length-1).substring(10),10):null,getMatchingRule:(e,t,i)=>{const r=e.length;for(let s=t.length-1;s>=0;s--){if("odd"===t[s].condition&&!C.isEven(r))return t[s];if("even"===t[s].condition&&C.isEven(r))return t[s];if("number"==typeof t[s].condition&&t[s].condition===r)return t[s];if(Array.isArray(t[s].condition)&&t[s].condition.length===r){const a=[];for(let t=0;t<r;t++)a.push(P.percentToGrid(e[t],i));if(C.hasArrayMatch(t[s].condition,a))return t[s]}}return{values:{}}},isEven:e=>!(e%2),hasArrayMatch:(e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if("*"!==e[i]&&e[i]!==t[i])return!1;return!0}};class M{constructor(e={}){this.viewportInfo=e,this.cache=new Map,this.buildtin={width:{viewport:{default:!0},fallback:{default:this.viewportInfo.main}},external:{viewport:{default:!0},fallback:{default:this.viewportInfo.main},attributes:{"*":{viewport:{default:!0},fallback:{default:this.viewportInfo.main}}}}}}resetCache(){this.cache.clear()}get(e,t,i,r=null,s){const a=this.getCacheKey(t,i,r,s);if(!this.cache.has(a)){let t=e.getProperty(`viewportMap.${i}`);!t&&this.buildtin[i]&&(t=this.buildtin[i]),"string"==typeof t&&(t=e.getProperty(`viewportMap.${t}`)),t&&r&&"string"==typeof t.attributes&&(t.attributes=e.getProperty(`viewportMap.${t.attributes}`)),this.cache.set(a,this.defineOrder(s,r,t))}return this.cache.get(a)}defineOrder(e,t,i){if(!i)return[];if(t&&(!i.attributes||!i.attributes[t]&&!i.attributes["*"]))return[];const r={viewport:{},fallback:{},...t?i.attributes[t]||i.attributes["*"]:i},s=this.parseMap(e,r);return s.length&&!1!==r.fallback.no_viewport&&s.push(null),s}parseMap(e,t,i=[]){if(!t)return i;if(!1===t.viewport[e])return i;if((!0===t.viewport[e]||t.viewport.default)&&(i.includes(e)||i.push(e)),t.fallback){if(t.fallback[e]&&t.fallback[e]!==e){const r=t.fallback[e];return t.fallback={...t.fallback},delete t.fallback[e],this.parseMap(r,t,i)}if(t.fallback.default&&t.fallback.default!==e){const e=t.fallback.default;return t.fallback={...t.fallback},delete t.fallback.default,this.parseMap(e,t,i)}}return i}getCacheKey(e,t,i,r){return[e,t,i,r].join("|")}}const S={functionMap:{},isValidFunction:e=>{if(void 0!==S.functionMap[e])return S.hasFunction(e);let t;try{t=eval.call(null,e)}catch(e){t=null}return S.functionMap[e]=t,S.hasFunction(e)},hasFunction:e=>typeof S.functionMap[e]==typeof Function,getFunction:e=>!!e&&(S.isValidFunction(e)?S.functionMap[e]:lab_api.v1.ns.get(e)||!1)};class T{constructor(){this.resolved={pathMatch:new Map}}static getPropertyTypeAndIndex(e){const t=/(.+)\[(.*)\]/.exec(e);if(!t||t.length<3)return[e,null,!1];const i=t[1],r=t[2]?parseInt(t[2].trim(),10):null;return[i,Number.isInteger(r)?r:null,""===t[2].trim()]}pathMatch(e,t){const i=`${e}||${t}`;if(this.resolved.pathMatch.has(i))return this.resolved.pathMatch.get(i);let r=null;return(this.exactMatch(t,e)||this.wildcardMatch(t,e))&&(r=e),this.resolved.pathMatch.set(i,r),r}exactMatch(e,t){return t.endsWith("//")?e.endsWith(t.slice(0,-1)):t.endsWith("/")?e.endsWith(t):e.endsWith(`${t}/`)}wildcardMatch(e,t){const i=v.trim(t,[" ","/"]).split("/").reverse(),r=v.trim(e,[" ","/"]).split("/").reverse();return this.arrayMatch(r,i)}arrayMatch(e,t,i){const r=e.shift(),s=t.shift();return r===s||"*"===s?!t.length||this.arrayMatch(e,t):""===s?(e.unshift(r),this.arrayMatch(e,t,!0)):!(!i||!e.length)&&(t.unshift(s),this.arrayMatch(e,t,!0))}static getViewForMenuItem(e){return T.getTarget(e.getModel(),e.getView(),{pathHelper:e.getConfig("pathHelper")}).view}static getTarget(e,t,i={}){const r={model:e,view:t};if(i.pathHelper&&i.pathHelper.type){const e=Array.isArray(i.pathHelper.type)?i.pathHelper.type:[i.pathHelper.type];for(const i of e){const e=this.getTargetForPath(r.model,i);if(e)return r.model=e,r.view=lab_api.v1.view.getView(r.model,t.getViewport()),r}return Sys.logger.warn(`[PathHelper] Cannot get target for source. Check config. Tried "${i.pathHelper.type}". Will return original result.`),r}if(i.source&&"model"!==i.source){const e=S.getFunction(i.source);if(!e)return Sys.logger.warn(`[PathHelper] Cannot get function for source. Check config. Tried "${i.source}". Will return original result.`),r;if(r.model=e(),!r.model)return Sys.logger.warn(`[PathHelper] Cannot get bound source from supplied function. Check config. Tried "${i.source}". Will return original result.`),r;r.view=r.model}return r}static getTargetForPath(e,t){const i=t.split(".");if(!["parent","child","root"].includes(i[0]))return Sys.logger.warn(`[PathHelper] Supplied path not valid. Check config. Tried "${t}". Will return original result.`),null;let r;if("parent"===i[0])r=e.getParent();else if("root"===i[0])r=lab_api.v1.model.query.getRootModel();else{const t=i[1],[s,a]=T.getPropertyTypeAndIndex(t);r=null===a?lab_api.v1.model.query.getChildOfType(e,s):lab_api.v1.model.query.getModelsByType(s,e.children)[a]||null}return r}}class ${constructor(e){this.getView=e.getView,this.getMarkupForModels=e.getMarkupForModels,this.getMarkupString=e.getMarkupString,this.configReader=e.configReader,this.localisation=e.localisation,this.proxies={config:null,cmsConfig:null,root:null,selector:null,preload:null,localisation:null},this.parsedProps=new Map,this.isEditor=this.configReader.getCms("app.isEditMode")}parseProp(e){return this.parsedProps.has(e)||this.parsedProps.set(e,this.doParseProp(e)),this.parsedProps.get(e)}doParseProp(e){const t={prop:e,attr:void 0};if(!e.endsWith("]"))return t;const i=/(.+)\[(.*)\]/.exec(e);return!i||i.length<3?t:{prop:i[1],attr:i[2]}}getProxy(e,t=this.getView(e)){return t.getProxy()||t.setProxy(this.createProxy(e,t)),t.getProxy()}createProxy(e,t){const i=(e,i)=>{const r=this.parseProp(i);return r.attr?t.get(`${e}.${r.prop}.${r.attr}`):t.get(`${e}.${r.prop}`)},r=new Proxy({},{get:(e,t)=>i("fields",t),has:(e,t)=>!!i("fields",t)}),s=new Proxy({},{get:(e,i)=>t.get(`metadata.${i}`),has:(e,i)=>!!t.get(`metadata.${i}`)}),a=new Proxy({},{get:(e,i)=>t.get(`filtered.${i}`),has:(e,i)=>!!t.get(`filtered.${i}`)});return new Proxy({},{get:(e,i)=>"fields"===i?r:"metadata"===i?s:"filtered"===i?a:t.get(i),has:(e,i)=>!!t.get(i)})}getRootProxy(){return this.proxies.root||(lab_api.v1.model.query.getRootModel()?this.proxies.root=this.getProxy(lab_api.v1.model.query.getRootModel()):this.proxies.root={}),this.proxies.root}getParentProxy(e,t){return e.parent?this.isEditor?e.parent.isMarkedForDeletion()?null:(t.getParentProxy()||t.setParentProxy(new Proxy(this.getProxy(e.parent),{get:(t,i)=>(e.parent.addToRedrawDependencies(e),t[i]),has:(e,t)=>t in e})),t.getParentProxy()):this.getProxy(e.parent):null}getChildrenProxy(e,t){return t.getChildrenProxy()||t.setChildrenProxy(new Proxy({},{get:(t,i)=>{let r=i,s=!1;r.endsWith("+")&&(s=!0,r=r.substring(0,r.length-1));const a="all"===r?e.children:lab_api.v1.model.query.getModelsByType(r,e.children,s);return this.getProxiesForModels(a,!0)},has:(e,t)=>!0})),t.getChildrenProxy()}getChildProxy(e,t){return t.getChildProxy()||t.setChildProxy(new Proxy({},{get:(t,i)=>{let r=i,s=!1;r.endsWith("+")&&(s=!0,r=r.substring(0,r.length-1));let[a,o]=[r,null,!1];if(r.endsWith("]")&&([a,o]=T.getPropertyTypeAndIndex(r)),null===o){const t=lab_api.v1.model.query.getChildOfType(e,a,s);return t?this.getProxiesForModels([t],!1):null}const n=lab_api.v1.model.query.getModelsByType(a,e.children,s);return n[o]?this.getProxiesForModels([n[o]],!1):null},has:(e,t)=>!0})),t.getChildProxy()}getStoreProxy(e,t,i=!1){if(!t.getStoreProxy(i)){const e={};t.setStoreProxy({get:new Proxy(e,{has:()=>!0,get:(e,t)=>t in e?e[t]:""}),set:new Proxy(e,{has:()=>!0,get:(e,t)=>()=>(i,r)=>(e[t]=r(i),"")})})}return t.getStoreProxy(i)}getPreloadProxy(e){return this.proxies.preload||(this.proxies.preload=this.createPreloadProxy(e)),this.proxies.preload}createPreloadProxy(e){return new Proxy({},{get:(t,i)=>e.getObject(i),has:(e,t)=>!0})}getChildrenMarkupProxy(e,t){return t.getChildrenMarkupProxy()||t.setChildrenMarkupProxy(new Proxy({},{get:(t,i)=>{let r=i,s=!1;r.endsWith("+")&&(s=!0,r=r.substring(0,r.length-1));let[a,o,n]=[r,null,!1];r.endsWith("]")&&([a,o,n]=T.getPropertyTypeAndIndex(r));const l="all"===a?e.children:lab_api.v1.model.query.getModelsByType(a,e.children,s);return null===o?this.getMarkupForModels(l,n):this.getMarkupForModels(l[o]?[l[o]]:[],!1)},has:(e,t)=>!0})),t.getChildrenMarkupProxy()}getChildMarkupProxy(e,t){return t.getChildMarkupProxy()||t.setChildMarkupProxy(new Proxy({},{get:(t,i)=>{let r=i,s=!1;r.endsWith("+")&&(s=!0,r=r.substring(0,r.length-1));let[a,o]=[r,null];r.endsWith("]")&&([a,o]=T.getPropertyTypeAndIndex(r));const n=lab_api.v1.model.query.getModelsByType(a,e.children,s);return n.length?null===o||0===o?this.getMarkupForModels([n[0]],!1):this.getMarkupForModels(n[o]?[n[o]]:[],!1):""},has:(e,t)=>!0})),t.getChildMarkupProxy()}getSelectorProxy(){if(!this.proxies.selector){const e={get:(e,t)=>{const i=lab_api.v1.model.query.getModelBySelector(t);return i?this.getMarkupString(i,this.getView(i)):""},has:(e,t)=>!0};this.proxies.selector=new Proxy({},e)}return this.proxies.selector}getConfigProxy(){if(!this.proxies.config){const e={get:(e,t)=>this.configReader.get(t),has:(e,t)=>!0};this.proxies.config=new Proxy({},e)}return this.proxies.config}getCmsConfigProxy(){if(!this.proxies.cmsConfig){const e={get:(e,t)=>this.configReader.getCms(t),has:(e,t)=>!0};this.proxies.cmsConfig=new Proxy({},e)}return this.proxies.cmsConfig}getLocalisationProxy(){return this.proxies.localisation||(this.proxies.localisation=()=>(e,t)=>this.localisation.get(e)),this.proxies.localisation}getProxiesForModels(e,t=!0){const i=e.map((e=>this.getProxy(e)));return t?i:i[0]}}class j extends u{constructor(e){super({behaviours:e.behaviours,entries:e.entries,debug:e.settings.debug}),this.logger=e.logger,this.state={isEditor:!1},this.settings=e.settings,this.logger.debug(`Creating instance of ViewManager for viewport ${e.viewport}.`),this.resourceManager=e.resourceManager,this.configReader=e.configReader,this.configProcessor=e.configProcessor,this.viewMap=new Map,this.gridSettings=this.getGridSettings(),this.viewport={name:e.viewport,main:this.configProcessor.getMainViewport(),isMain:this.configProcessor.isMainViewport(),width:this.configProcessor.getViewportWidth()},this.styleManager=e.styleManager,this.preloadHandler=e.preloadHandler,this.localisation=e.localisation,this.viewportsSettings=this.configReader.get("viewports")||{},this.ViewHelpers={};const t=new M(this.viewport);this.viewEventPipe={getViewportOrder:t.get.bind(t)},this.rootModel=null,this.proxyManager=new $({configReader:this.configReader,localisation:this.localisation,getView:this.getView.bind(this),getMarkupForModels:this.getMarkupForModels.bind(this),getMarkupString:this.getMarkupString.bind(this)}),this.renderers={renderViewTemplate:this.renderViewTemplate.bind(this),renderViewPartial:this.renderViewPartial.bind(this),renderPartial:this.renderPartial.bind(this),renderPageElement:this.renderPageElement.bind(this)},this.renderHelpers={trim:()=>(e,t)=>t(e).replace(/\t|\r\n|\n|\r/gm," ").replace(/ +/gm," ").trim(),sanitizeString:()=>(e,t)=>v.sanitizeString(t(e)),stripTags:()=>(e,t)=>v.stripTags(t(e)),stripLinks:()=>(e,t)=>v.stripLinks(t(e)),encodeURIComponent:()=>(e,t)=>encodeURIComponent(t(e)),cachebuster:()=>e=>{const t=e.split(","),i="cms"===t[0]?"cms":"view",r=this.configReader.getCms(`deployTimestamps.${i}`);return r?`${(t[1]||"?")+(t[2]||"v")}=${r}-L4`:""},toFixed:()=>(e,t)=>{const[i,r]=t(e).trim().split(" ");return parseFloat(i).toFixed(r)}}}apiReady(e){this.ViewHelpers={image:new y(e,this.getViewHelperParams()),bodytext:new _(e,this.getViewHelperParams()),external:this.getExternalViewHelper(e)}}getGridSettings(){const e=this.configProcessor.getViewport(),t={prefix:this.configReader.get("grid.grid_prefix"),absPrefix:this.configReader.get("grid.abs_grid_prefix"),span:this.configReader.get("grid.total_grid_spans")};return t.prefix[e]||(t.prefix[e]=""),t}getViewHelperParams(){return{viewport:this.viewport.name,logger:this.logger,viewManager:this,isEditor:this.state.isEditor,settings:this.settings}}getViewHelper(e){return e in this.ViewHelpers?this.ViewHelpers[e]:null}getExternalViewHelper(e){return new k(e,this.getViewHelperParams())}allowViewport(e){const t=e.get("metadata.viewportBlacklist");return!t||!Array.isArray(t)||!t.includes(this.viewport.name)}draw(e=[],t=null){this.emitEvent("render",this.viewport.name),this.logger.debug(`[ViewManager] Start rendering for viewport ${this.viewport.name}.`);const i=new x("ViewManager.draw");for(const t of e)this.drawModel(t);this.logger.debug(`[ViewManager] Rendering finished for viewport ${this.viewport.name}. Element-count: ${lab_api.v1.model.query.getModelsFromCache().length}. Duration ${i.step()} ms.`);let r=[];for(const t of e){const e=this.getView(t);r.push(e.getMarkupString())}const s=this.notifyFrontRendered(r);return s.length&&(this.logger.warn('[ViewManager] Listener for event "app-rendered" has modified markup returned from drawing engine.'),r=s.pop()),"function"==typeof t&&t(r),r}notifyFrontRendered(e){return this.requestEvent("rendered",e,this.viewport.name)}drawModel(e,t=!0){if(lab_api.v1.app.dbg.logger.add(this.constructor.name,"drawModel",this.viewport.name),!this.allowViewport(e))return void this.logger.debug(`[ViewManager] Element ${e.getPositionedPath()} is not allowed on viewport ${this.viewport.name}.`);const i=this.getView(e);if(this.prepareDrawing(e,i),t){const t=i.getProperty("childLimit");for(const i of e.children)this.allowChild(e,i,t)&&this.drawModel(i)}this.drawPrepared(e,i)}allowChild(e,t,i){return t.get("metadata.hideViewport",this.viewport.name)?(this.logger.warn(`[ViewManager] Metadata "hideViewport" has cancelled rendering of element "${t.getPositionedPath()}" for viewport "${this.viewport.name}".`),this.hideViewportDetected(t)):!(i&&e.children.indexOf(t)>=i)||(this.logger.warn(`[ViewManager] Child-limit (${i}) reached for "${e.getType()}". Child: "${t.getPositionedPath()}". Viewport "${this.viewport.name}".`),this.childLimitDetected(e,t,i))}childLimitDetected(e,t,i){const r=this.requestEvent("childLimitReached",e,t,this.viewport.name,i);return!!r.length&&!!r.pop()}hideViewportDetected(e){const t=this.requestEvent("elementHidden",e,this.viewport.name);return!!t.length&&!!t.pop()}prepareDrawing(e,t){const i=this.performanceLogger.start(["prepare",e.getType()]);this.prepareView(e,t),t.getGrid()||(this.getAndSetGridData(e,t),this.gridIsDefined(e,t)),this.proxyManager.getProxy(e,t),this.notifyOnReady(e,t),this.performanceLogger.end(i)}gridIsDefined(e,t){}drawPrepared(e,t){let i=this.performanceLogger.start(["assembleData",e.getType()]);const r=this.getDataForView(e,t);this.performanceLogger.end(i),this.runViewHelper(e,t),this.notifyBeforeElementDraw(e,t),i=this.performanceLogger.start(["template",e.getType()]),this.renderTemplate(e,t,r),this.performanceLogger.end(i),this.markupStringReady(e,t)}markupStringReady(e,t){this.notifyOnRendered(e,t)}notifyOnReady(e,t){e.isPseudo()||this.emitBehaviour("onReady",e,t)}notifyOnViewHelper(e,t){e.isPseudo()||this.emitBehaviour("onViewHelper",e,t)}notifyBeforeElementDraw(e,t){e.isPseudo()||(this.emitBehaviour("onRender",e,t),this.emitEntry("onRender",e,t))}notifyOnRendered(e,t){this.emitBehaviour("onRendered",e,t),this.emitEntry("onRendered",e,t)}getDataForView(e,t){return t.getData()||this.getAndSetViewData(e,t)}createView(e){const t=e.getGuid();return this.viewMap.get(t)||this.viewMap.set(t,this.newViewInstance(e)),this.viewMap.get(t)}newViewInstance(e){return new m(this.viewport.name,e,this.viewEventPipe)}getView(e){return this.viewMap.get(e.getGuid())||this.createView(e)}getViews(){return this.viewMap.values()}prepareView(e,t){t.isPrepared()||(lab_api.v1.app.dbg.logger.add(this.constructor.name,"prepareView",this.viewport.name),this.setTemplate(e,t),this.setProperties(e,t),this.viewIsResolved(e,t))}setTemplate(e,t){t.setTemplate(this.resourceManager.getTemplateForModel(e,t))}setProperties(e,t){t.setProperties(this.resourceManager.getPropertiesForModel(e,t),!0)}viewIsResolved(e,t){t.setPreparedState(!0)}runViewHelper(e,t){if(e.isPseudo())return;const i=t.getProperty("viewHelper");if(!i)return;const r=this.getViewHelper(i);if(r){this.notifyOnViewHelper(e,t);const i=this.performanceLogger.start(["viewhelper",e.getType()]);r.run(e,t),this.performanceLogger.end(i)}else this.logger.warning(`[ViewManager] Cannot find view-helper ${i} for model ${e.getPositionedPath()}.`)}renderTemplate(e,t,i){lab_api.v1.app.dbg.extensiveLogging&&this.logger.debug(`[ViewManager] Start renderTemplate for model ${e.getPositionedPath()}`),e.getNoRenderState()?this.logger.debug(`[ViewManager] Model-state disallows rendering model "${e.getPositionedPath()}".`):this.renderTemplateAndData(e,t,i)}getAndSetViewData(e,t){const i=this.getViewData(e,t);return t.setData(i),i}getGridData(e){const t=e.getGrid()||{};return{width:t.width,absWidth:e.getAbsoluteGridWidth(),css:t.css,absCss:e.getAbsGridCss(),vp:t.vp,absVp:e.getAbsoluteGridWidths(),cssVp:t.cssVp,percentage:P.gridToPercent(t.width)}}getViewData(e,t){const i=lab_api.v1.model.query.getRootModel(),r=lab_api.v1.view.getView(i,t.getViewport());return{get:{current:this.proxyManager.getProxy(e,t),parent:this.proxyManager.getParentProxy(e,t),root:this.proxyManager.getRootProxy(),child:this.proxyManager.getChildProxy(e,t),children:this.proxyManager.getChildrenProxy(e,t),store:this.proxyManager.getStoreProxy(e,t)},set:{store:this.proxyManager.getStoreProxy(e,t,!0)},getPreload:this.proxyManager.getPreloadProxy(this.preloadHandler),child:this.proxyManager.getChildMarkupProxy(e,t),childByIndex:()=>(t,i)=>{const[r,s]=i(t).trim().split(" "),a=parseInt(r,10)||0,o=s?lab_api.v1.model.query.getChildrenOfType(e,s):e.getChildren();return o[a]?this.getMarkupString(o[a],this.getView(o[a])):null},children:this.proxyManager.getChildrenMarkupProxy(e,t),selector:this.proxyManager.getSelectorProxy(e,t),size:{grid:this.getGridData(t),pixelWidth:t.getPixelWidth(),pixelWidths:t.getPixelWidths()},style:{definition:()=>(i,r)=>this.styleManager.getStyleFromDefinition(e,t,r(i)),collection:()=>(i,r)=>this.styleManager.getStyle(e,t,r(i))},app:{viewport:{name:this.viewport.name,width:this.viewport.width,main:this.viewport.main,isMain:this.viewport.isMain},isEditor:this.state.isEditor,isFront:!this.state.isEditor},render:{template:this.renderers.renderViewTemplate,partial:this.renderers.renderViewPartial,sitePartial:this.renderers.renderPartial,pageElement:this.renderers.renderPageElement},helper:{trim:this.renderHelpers.trim,sanitizeString:this.renderHelpers.sanitizeString,stripTags:this.renderHelpers.stripTags,stripLinks:this.renderHelpers.stripLinks,encodeURIComponent:this.renderHelpers.encodeURIComponent,cachebuster:this.renderHelpers.cachebuster,toFixed:this.renderHelpers.toFixed},calculator:{add:()=>(e,t)=>{const[i,r]=t(e).trim().split(" ");return parseFloat(i)+parseFloat(r)},subtract:()=>(e,t)=>{const[i,r]=t(e).trim().split(" ");return parseFloat(i)-parseFloat(r)},divide:()=>(e,t)=>{const[i,r]=t(e).trim().split(" ");return parseFloat(i)/parseFloat(r)},multiply:()=>(e,t)=>{const[i,r]=t(e).trim().split(" ");return parseFloat(i)*parseFloat(r)}},if:()=>(e,t)=>{const i={"=":(e,t)=>e==t,"!=":(e,t)=>e!=t,"<":(e,t)=>e<t,">":(e,t)=>e>t,"[]":(e,t)=>e.includes(t)};let r=0,s=null,a=[];for(;a.length<2&&r<Object.keys(i).length;)s=Object.keys(i)[r++],a=e.split(s);if(a.length>1){const[e,r]=a.map((e=>t(e).trim()));if(i[s](e,r))return"1"}return""},getConfig:this.proxyManager.getConfigProxy(),getCmsConfig:this.proxyManager.getCmsConfigProxy(),image:{getFrontCropUrl:this.getFrontCropUrlHelper(i,r)},lang:this.proxyManager.getLocalisationProxy()}}getFrontCropUrlHelper(e,t){return()=>(t,i)=>{const r=e.get("frontCrop");if(r&&r.pano){const e=i(t).split(","),s=parseInt(e[0],10),a=parseInt(e[1],10),o=e[2]||void 0,n=this.getViewHelper("image").generateUrl(r.pano.fields,{instanceOf:r.pano.instance_of,imageUrlOptionsNameValue:r.pano.instance_of,imageId:r.pano.instance_of,width:s,height:a,format:o});if(n)return n}const s=(lab_api.v1.config.get("faviconList")||[]).pop();return s&&s.iconPath?s.iconPath.startsWith("http")?s.iconPath:lab_api.v1.properties.get("customer_front_url")+s.iconPath:""}}renderPageElement(){return(e,t)=>{const i=e.trim().split(" "),r=t(i.shift()),s=t(i.shift())||r,a=lab_api.v1.config.get(`pageElements.${r}`);if(!a)return this.renderViewPartial()(s,t);const o=this.getTemplate("widgets/structures/root");return o?t(this.renderPageElementRecursive(o,a)):(this.logger.warn('[ViewManager] Cannot find root-widget at "widgets/structures/root". Widget not rendered.'),"")}}getTemplate(e){return this.resourceManager.templates[e]}renderPageElementRecursive(e,t,i={value:1}){const{viewport:r,pageType:s,flag:a}=t.requirements||{};if((!r||r===this.viewport.name)&&(!s||s===this.configProcessor.getPageType())&&(!a||lab_api.v1.util.featureFlags.enabled(a,this.settings.contentId))){const r=i.value,s=t.settings||{},a=[];if(t.children)for(let e=0;e<t.children.length;e++){const r=t.children[e],s=this.getTemplate(`widgets/${r.type}`);if(s){i.value++;const e=this.renderPageElementRecursive(s,r,i);e&&a.push(e)}else this.logger.warn(`[ViewManager] Cannot find widget at "widgets/${r.type}". Widget not rendered.`)}const{tags:o}=Mustache;Mustache.tags=["[[","]]"];const n=Mustache.render(e,{children:a.join(""),settings:s,id:r});return Mustache.tags=o,n}return null}renderViewTemplate(){return(e,t)=>{const i=t(e.trim());return i&&this.getTemplate(i)?t(this.getTemplate(i)):(this.logger.debug(`Render template: Path is not valid: '${i}'`),"")}}renderViewPartial(){return(e,t)=>this.renderPartialWithFallback(e.trim(),t)}renderPartial(){return(e,t)=>this.renderPartialWithOutFallback(e.trim(),t)}renderPartialWithOutFallback(e,t){return this.renderViewTemplate()(`partial/${e}`,t)}renderPartialWithFallback(e,t,i=null,r=[]){const s=i||lab_api.v1.site.getSite().alias,a=this.renderViewTemplate(),o=a(`partial/site/${s}/${e}`,t);if(!o){r.push(s);const i=lab_api.v1.config.get("lab_fallback_site",s);return i&&!r.includes(i)?this.renderPartialWithFallback(e,t,i,r):a(`partial/${e}`,t)}return o}getPixelWidths(e,t){const i=t.getPixelWidths();if(i)return i;const r=t.getAbsoluteGridWidths(),s=r[this.viewport.main],a={};for(const e in this.viewportsSettings)if(this.viewportsSettings[e]){const t=r[e]?r[e]:s;a[e]=Math.ceil(t/this.gridSettings.span*this.viewportsSettings[e].deviceWidth)}return a}calculateGridData(e,t){const i=this.viewport.main,r=t.getWidth(),s=e.getViewportWidths();let a=[r],o=t.getProperty("gridRules")||[];if(Array.isArray(o)||(o=Object.values(o)),o.length){const t=e.parent?e.parent.getPersistentChildren():null;t&&(a=t.map((e=>e.getWidth(i)||e.getWidth())))}return C.getData(r,s,o,this.gridSettings,a,e.getModelIndex(!0))}calculateAbsoluteGridWidths(e,t){const i=t.getGrid().vp;i||this.logger.error("gridWidths do not exist. It should ...");let r={};if(e.parent){const t=this.getView(e.parent);r=this.getAbsoluteGridWidths(e.parent,t)||r}const s={};for(const e of Object.keys(i))s[e]=P.floatPrecision(i[e]/this.gridSettings.span*(r[e]||this.gridSettings.span));return s}getAbsoluteGridWidths(e,t){return t.getAbsoluteGridWidths()}getAbsoluteGridCss(e,t){if(!this.gridSettings.absPrefix)return"";const i=t.getAbsoluteGridWidths();return Object.keys(i).map((e=>this.gridSettings.absPrefix[e]?this.gridSettings.absPrefix[e]+i[e]:"")).join(" ")}getAndSetGridData(e,t){const i=this.calculateGridData(e,t);t.setGrid(i),t.setGridWidth(i.vp[this.viewport.name]),t.setAbsoluteGridWidths(this.calculateAbsoluteGridWidths(e,t)),t.setAbsGridCss(this.getAbsoluteGridCss(e,t)),t.setPixelWidths(this.getPixelWidths(e,t))}renderTemplateAndData(e,t,i){t.setMarkupString(Mustache.render(t.getTemplate(),i,this.resourceManager.templates))}getMarkupForModels(e,t=!0){const i=e.map((e=>this.getMarkupString(e,this.getView(e))));return t?i:i.join("")}getMarkupString(e,t){return t.getMarkupString()}getPlaceholders(){return{}}getMarkup(e){return this.getView(e).getMarkup()}}const F={create(){if("undefined"!=typeof crypto&&crypto.randomUUID)return crypto.randomUUID();let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:7&i|8).toString(16)}))}};class R{constructor(e,t={}){this.parent=null,this.children=[],this.path=e.path,this.data={type:e.type,metadata:e.metadata,contentdata:e.contentdata,width:R.validateInputWidth(e.width),guid:e.guid||F.create(),selector:e.selector},this.fallbackData=e.fallback,this.source={model:null,targets:[],keys:[]};const i=e.state||{};this.state={isNonPersistent:!!i.isNonPersistent,isPseudo:!!i.isPseudo,noRender:!1},this.cache={serialized:null,filtered:e.filtered||{},external:e.external||null,getter:new Map,path:null,positionedPath:{persistent:null,nonPersistent:null},childCount:{value:0}},this.eventPipe={keyModified:t.keyModified,childAdded:t.childAdded}}static validateInputWidth(e){const t=R.getEmptyDataObject();t.value="number"==typeof e?e:100;const i=l.object(e,t);return i.value||0!==Object.keys(i.vp).length||(i.value=100),i}static getEmptyDataObject(){return{value:null,vp:{}}}getNoRenderState(){return this.state.noRender}setNoRenderState(e){this.state.noRender=!!e}setDataProperty(e,t){this.data[e]=t}getId(){return this.data.contentdata&&this.data.contentdata.id||null}getGuid(){return this.data.guid}isNonPersistent(){return this.state.isNonPersistent||this.state.isPseudo}isPseudo(){return this.state.isPseudo}isDerived(){return!!this.source.model}hasNodeData(e=!1){if(this.data.contentdata)return!0;if(e)for(const t of this.children)if(t.hasNodeData(e))return!0;return!1}getSourceModel(){return this.source.model}setSourceModel(e,t){this.source.model=e,this.source.keys=t}addSourceTarget(e){this.source.targets.includes(e)||this.source.targets.push(e)}getSourceTargets(){return this.source.targets}hasSourceKey(e){if(!this.source.model)return!1;if(!this.source.keys.length)return!0;const t=e.split(".");for(;t.length;){if(this.source.keys.includes(t.join(".")))return!0;t.pop()}return!1}hasKeyInTarget(e){for(const t of this.source.targets)if(t.hasSourceKey(e))return!0;return!1}isSourceKey(e){return this.source.keys.includes(e)}setParent(e){this.parent=e}getParent(){return this.parent}getRootParent(){return this.parent?this.parent.getRootParent():this}getChildren(){return this.children}getPersistentChildren(){return this.children.filter((e=>!e.isNonPersistent()))}getNonpersistentChildren(){return this.children.filter((e=>e.isNonPersistent()))}getPersistentSiblings(){return this.parent?this.parent.getPersistentChildren():null}addChild(e,t,i=!1){this.addChildAtIndex(e,i?0:this.children.length,t)}addChildAtIndex(e,t,i=!0,r=!1){return e.setParent(this),this.children.length<=t?this.children.push(e):this.children.splice(t,0,e),e.resetPath(),!r&&this.eventPipe.childAdded&&this.eventPipe.childAdded(this,e,t),this.children}getPath(e=!1){return null===this.cache.path&&(this.cache.path=this.parent?`${this.parent.getPath()}/`:this.path),this.cache.path+(e?"":this.getType())}getArrayPath(e=!1){return this.getPath(e).split("/").filter((e=>!!e))}getPositionedPath(e=!1){return e?this.getPersistentPositionedPath():this.getNonPersistentPositionedPath()}getPersistentPositionedPath(){if(null===this.cache.positionedPath.persistent){let e=this.getModelIndexByType(!0);-1===e&&(e=0),this.cache.positionedPath.persistent=`${(this.parent?`${this.parent.getPersistentPositionedPath()}/`:this.path)+this.getType()}[${e}]`}return this.cache.positionedPath.persistent}getNonPersistentPositionedPath(){if(null===this.cache.positionedPath.nonPersistent){let e=this.getModelIndexByType(!1);-1===e&&(e=0),this.cache.positionedPath.nonPersistent=`${(this.parent?`${this.parent.getNonPersistentPositionedPath()}/`:this.path)+this.getType()}[${e}]`}return this.cache.positionedPath.nonPersistent}resetPath(){this.cache.path=null,this.cache.positionedPath={persistent:null,nonPersistent:null};for(const e of this.children)e.resetPath()}isStage(){return this.getRootParent().getType().startsWith("page_")}getModelIndex(e=!1){return this.parent?(e?this.parent.getPersistentChildren():this.parent.children).indexOf(this):-1}getModelIndexByType(e=!1){if(!this.parent)return-1;const t=this.getType();let i=-1;for(const r of e?this.parent.getPersistentChildren():this.parent.getChildren())if(r.getType()===t&&(i++,r===this))return i;return i}getType(){return this.data.type}getWidth(e){return e?this.data.width.vp[e]||null:this.data.width.value||100}getViewportWidths(){return this.getRaw("width.vp")||{}}setSelector(e){this.data.selector=e}getSelector(){return this.data.selector}getData(e,t){return e?n.get(e,this.data.contentdata,t):this.data.contentdata}getDataObjectForKey(e,t=!1){if(!t&&this.hasSourceKey(e)){const t=this.source.model.getDataObjectForKey(e);return t.sourceModel=this.source.model,t}const i=e.split(".")[0];return"fields"===i?{base:i,data:this.data.contentdata,fallback:this.fallbackData?this.fallbackData.contentdata:void 0}:"filtered"===i||"external"===i||"childCount"===i?{base:i,data:this.cache,fallback:void 0}:"metadata"===i||"width"===i||"type"===i||"guid"===i?{base:i,data:this.data,fallback:this.fallbackData?this.fallbackData:void 0}:"state"===i?{base:i,data:this,fallback:void 0}:{base:"",data:this.data.contentdata,fallback:void 0}}getRaw(e,t){return e?n.get(e,this.data,t):this.data}setRaw(e,t,i){const r=this.buildQuery(e);if(!r.isVpObj)return void Sys.logger.warn(`LabModel: Cannot set raw value for key "${e}". Not supported.`);const s={...i};delete s.viewport;const a=this.getRaw(e);if(!a&&!t)return;const o=Object.keys(t&&t.vp||{}),l=Object.keys(a&&a.vp||{});for(const i of l)o.includes(i)&&t||this.set(e,void 0,{...s,viewport:i});for(const i of o)this.set(e,t.vp[i],{...s,viewport:i});this.set(e,t?t.value||null:void 0,{...s,predefinedQuery:r}),t||n.delete(e,this.data)}validateVpModelData(e){return!!e&&"object"==typeof e&&(void 0!==e.value||void 0!==e.vp)}buildQuery(e,t){const i=e.split("."),r={min:"width"===i[0]||"external"===i[0]||"childCount"===i[0]?1:2,max:"fields"===i[0]||"filtered"===i[0]?2:1},s="metadata"===i[0]||"fields"===i[0]||"width"===i[0]||"external"===i[0]||"childCount"===i[0],a="external"===i[0],o={path:i.slice(0,r.max).join("."),allowSource:"childCount"!==i[0]&&"filtered"!==i[0],attribute:i.length>r.max?i[r.max]:null,key:i.slice(0,r.max+1).join("."),fullPath:e,raw:e,type:s?i[0]:null,isVpObj:s,isValidated:!(s&&!a)||i.length<=r.max+1&&i.length>=r.min};return a&&(o.attribute=i.slice(r.min).join("."),o.key=e),o.isVpObj&&(a?o.fullPath=t?`${i.slice(0,r.max).join(".")}.vp.${t}${o.attribute?`.${o.attribute}`:""}`:`${i.slice(0,r.max).join(".")}.value${o.attribute?`.${o.attribute}`:""}`:"fields"===o.type&&o.path.endsWith("_json")?(o.fullPath=`${o.path}.value${o.attribute?".":""}${i.slice(2).join(".")}`,o.isValidated=!0):(o.fullPath=o.attribute?`${o.path}.${"fields"===o.type?"attributes.":""}${o.attribute}`:o.path,o.fullPath+=t?`.vp.${t}`:".value")),o}get(e,t,i,r){lab_api.v1.app.dbg.logger.add(this.constructor.name,"get");const s=this.getCacheKey(e,t,i),a=i?void 0:null;if(this.cache.getter.has(s))return this.getCacheValue(s);const o=r||this.buildQuery(e,t);if(!o.isValidated)return Sys.logger.warn(`LabModel: Cannot get unvalid key: "${e}".`),this.cache.getter.set(s,a),a;const l=this.getDataObjectForKey(e,!o.allowSource);let d=n.get(o.fullPath,l.data,!0);return void 0===d&&l.fallback&&(d=n.get(o.fullPath,l.fallback,!0)),void 0===d?(this.cache.getter.set(s,a),a):(this.cache.getter.set(s,d),this.getCacheValue(s))}getCacheValue(e){const t=this.cache.getter.get(e);return t&&"object"==typeof t?Array.isArray(t)?[...t]:{...t}:t}getCacheKey(e,t="lab_main",i=!1){return`${e}-${i?1:0}-${t||"lab_main"}`}getAttributeObject(e){const t=this.buildQuery(e);if(!t.isVpObj)return null;const i=this.getDataObjectForKey(e,!0),r=n.get(t.path,i.data,!0);if(!r)return null;const s="fields"===t.type?r.attributes:r;return t.attribute&&!s[t.attribute]?null:t.attribute?{[t.attribute]:s[t.attribute]}:s}set(e,t,{viewport:i=null,notify:r=!0,checkDerived:s=!0,registerModified:a=!0,save:o=!0,predefinedQuery:l=null,undoable:d=!0}={}){if(lab_api.v1.app.dbg.logger.add(this.constructor.name,"set"),!e)return!1;let c=t;const p=l||this.buildQuery(e,i);if(!p.isValidated)return Sys.logger.warn(`LabModel: Cannot set value for key. Key not valid: ${e}.`),!1;const g=this.getDataObjectForKey(e,!p.allowSource);if(!g.data)return Sys.logger.warn(`LabModel: Trying to set data on a non-existing object. Skipping. Key: "${e}". Model-path: "${this.getPath()}".`),!1;const u=n.get(p.fullPath,g.data,!0);if(u===c)return!1;if(u&&void 0===c&&"fields"===p.type&&(c=null),p.isVpObj&&void 0===u&&void 0===n.get(p.path,g.data,!0)&&n.set(p.path,R.getEmptyDataObject(),g.data),r){if(!this.dataWillSet(p.key,c))return Sys.logger.debug(`Pre-set listener has cancelled setting data for path ${e} at model ${this.getPath()}.`),!1;d&&lab_api.v1.history&&lab_api.v1.history.getManager().add(lab_api.v1.history.getManager(),"modelSetter",[this.getGuid(),e,u,{viewport:i,notify:r,registerModified:a,save:!1,predefinedQuery:p,undoable:!1}])}return n.set(p.fullPath,c,g.data),this.keyModified(p.key,i),a&&(this.registerModified(e),g.sourceModel&&g.sourceModel.registerModified(e)),r&&this.dataIsSet(p.key,c,e,o,s),!0}keyModified(e,t){this.eventPipe.keyModified&&this.eventPipe.keyModified(this,e,t)}setFiltered(e,t){return this.set(`filtered.${e}`,t,{notify:!1,save:!1,registerModified:!1})}getSerializedCache(){return this.cache.serialized}setSerializedCache(e){this.cache.serialized=e}dataWillSet(e,t,i){return!0}dataIsSet(e,t,i){}registerModified(e){}}const A={internalToBackend(e,t=!0){const i={...e};i.type=e.type||null,i.id=e.id||null,i.tmpId=e.tmpId||null,i.instance_of=e.instance_of||null,i.parent=e.parent||null,e.status&&(i.status=e.status),i.site_id=e.site_id||null;const r={viewports_json:{}};for(const e of Object.keys(i.fields||{})){let t=i.fields[e];"object"==typeof t&&null!==t||(t={value:t}),this.internalFieldToBackend(e,t,r)}return i.fields=r,i},backendToInternal(e,t=[],i=!0){const r=this.backendToInternalStructure(e.structure,t);return e.contentdata&&(r.contentdata=this.backendToInternalNode(e.contentdata)),r},viewToInternal(e,t,i=lab_api.v1.viewport.getEditable()){let r=!0,s=e;Array.isArray(e)||(r=!1,s=[e]);const a=[],o=["contentdata","metadata","children","width"];for(const e of s){const r=t?{...e,...t}:e,s={width:{value:null,vp:{}}};r.width&&("object"==typeof r.width?s.width.vp=r.width:(s.width.value=r.width,r.metadata&&"object"==typeof r.metadata.width&&(s.width.vp=r.metadata.width)));for(const e in r)o.includes(e)||(s[e]=r[e]);r.children&&(s.children=this.viewToInternal(r.children,t)),r.contentdata&&(s.contentdata=this.backendToInternalNode(r.contentdata)),r.metadata&&(s.metadata=this.backendToInternalStructureMeta(r.metadata,i)),a.push(s)}return r?a:a[0]},backendToView(e,t=!1){const i=e.fields?{fields:e.fields}:null;i&&(i.type=e.type||null,i.tags=e.tags||void 0,i.instance_of=e.instance_of||null,i.apiResult=e.apiResult,t||(i.id=e.id||void 0));const r=e.width&&"object"==typeof e.width?e.width.value:e.width||null;return{type:e.type||null,metadata:e.metadata||{},width:r,contentdata:i,children:(e.children||[]).map((e=>this.backendToView(e)))}},backendToInternalNode(e){const t={...e},i={};if(t.fields&&t.fields.viewports_json)for(const e of Object.keys(t.fields.viewports_json))for(const i of Object.keys(t.fields.viewports_json[e].fields||{}))void 0===t.fields[i]&&(t.fields[i]=null);if(t.fields)for(const e of Object.keys(t.fields||{}))if(e.endsWith("_style_json")){const i=e.replace("_style_json","");t.fields[i]||(t.fields[i]=null)}for(const e of Object.keys(t.fields||{}))if(!e.endsWith("_style_json")&&"viewports_json"!==e){i[e]={value:t.fields[e],vp:this.getViewportKey(e,t.fields),attributes:{}};for(const r in t.fields[`${e}_style_json`]||{})void 0!==t.fields[`${e}_style_json`][r]&&(i[e].attributes[r]={value:t.fields[`${e}_style_json`][r],vp:{}});for(const r in t.fields.viewports_json||{})if(t.fields.viewports_json[r].fields&&void 0!==t.fields.viewports_json[r].fields[`${e}_style_json`])for(const s in t.fields.viewports_json[r].fields[`${e}_style_json`])void 0!==t.fields.viewports_json[r].fields[`${e}_style_json`]&&(i[e].attributes[s]||(i[e].attributes[s]={value:null,vp:{}}),i[e].attributes[s].vp[r]=t.fields.viewports_json[r].fields[`${e}_style_json`][s])}return t.fields=i,t},backendToInternalStructure(e,t){const i=e.metadata?this.backendToInternalStructureMeta(e.metadata,t):{},r={guid:e.id||F.create(),selector:e.selector||null,metadata:i,type:e.type||null,width:{value:e.width?P.floatPrecision(e.width):100,vp:i.width?i.width.vp:{}},children:[]};return delete r.metadata.width,r},backendToInternalStructureMeta(e,t){const i={};for(const r of Object.keys(e))if(i[r]={value:null,vp:{}},"object"!=typeof e[r]||Array.isArray(e[r]))i[r].value=e[r];else for(const s of Object.keys(e[r]||{}))t.includes(s)?i[r].vp[s]=e[r][s]:(i[r].value||(i[r].value={}),i[r].value[s]=e[r][s]);return i},internalToBackendStructureMeta(e){const t={};for(const i of Object.keys(e)){const r=e[i];let s=!1;for(const e of Object.keys(r.vp||{}))s=!0,t[i]||(t[i]={}),t[i][e]=r.vp[e];s||void 0===r.value||(t[i]=r.value)}return t},getViewportKey(e,t){const i={};if(!t.viewports_json)return i;for(const r in t.viewports_json)t.viewports_json[r].fields&&void 0!==t.viewports_json[r].fields[e]&&(i[r]=t.viewports_json[r].fields[e]);return i},internalFieldToBackend(e,t,i){if(!t)return;const r=i;r[e]=t.value;for(const i of Object.keys(t.vp||{}))r.viewports_json||(r.viewports_json={}),r.viewports_json[i]||(r.viewports_json[i]={fields:{}}),r.viewports_json[i].fields[e]=t.vp[i];if(t.attributes){const i=`${e}_style_json`;for(const e of Object.keys(t.attributes)){void 0!==t.attributes[e].value&&(r[i]||(r[i]={}),r[i][e]=t.attributes[e].value);for(const s of Object.keys(t.attributes[e].vp||{}))r.viewports_json||(r.viewports_json={}),r.viewports_json[s]||(r.viewports_json[s]={fields:{}}),r.viewports_json[s].fields[i]||(r.viewports_json[s].fields[i]={}),r.viewports_json[s].fields[i][e]=t.attributes[e].vp[s]}}},filterModifiedContent(e,t){const i={fields:{}},r=e.getModifiedPaths(),s=e.data.contentdata.fields||{};for(const e of r)if(e.startsWith("fields.")){const t=e.replace("fields.",""),r=s[t];this.internalFieldToBackend(t,r,i.fields)}else e.startsWith("state.")||n.set(e,n.get(e,t),i);return i}};class I extends u{constructor(e,t,i,r,s=!1){super({entries:i,behaviours:r,debug:s}),this.configReader=e,this.resourceManager=t,this.models=[],this.cache={id:new Map,guid:new Map},this.eventPipe={keyModified:this.keyModified.bind(this),childAdded:this.childAdded.bind(this)},this.cacheHandler=null}static validateViewInput(e={},t=[],{useExisting:i=!1,intermediateUseExisting:r=!0}={}){for(const i of t)if(!e[i])return null;if(!e.data)return null;if(!e.data.type)return null;const s={...e};return s.options={...s.options||{}},s.options.front=!1!==s.options.front,s.options.editor=!1!==s.options.editor,s.options.frontpage=!0===s.options.frontpage,s.options.articlepage=!0===s.options.articlepage,s.options.template=s.options.template||null,s.options.useExisting=void 0===s.options.useExisting?i:s.options.useExisting,s.options.intermediate=s.options.intermediate||{},s.options.intermediate.useExisting=void 0===s.options.intermediate.useExisting?r:s.options.intermediate.useExisting,s.options.persistentTarget=!!s.options.persistentTarget,s.options.append&&(s.options.append=l.object(s.options.append,{match:"",index:0})),s.options.prepend&&(s.options.prepend=l.object(s.options.prepend,{match:"",index:0})),s}setCacheHandler(e){this.cacheHandler=e}getModelsFromCache(){return Array.from(this.cache.guid.values())}getChildModels(e){const t=[],i=e=>{for(const t of e.children)i(t);t.push(e)};return i(e),t}getModels(){return this.models}getModelById(e){return this.cache.id.get(e)||null}getModelByGuid(e){return this.cache.guid.get(e)||null}getModelBySelector(e){for(const t of this.getModelsFromCache())if(t.getSelector()===e)return t;return null}getModelTypes(e){return e?[...new Set(this.getChildModels(e).map((e=>e.getType())))]:[...new Set(this.getModelsFromCache().map((e=>e.getType())))]}recursiveGetModelByAttribute(e,t,i){}getRootModel(){return this.models[0]}getParentNodeId(e){if(e.parent)return e.parent.hasNodeData()?e.parent.getId():this.getParentNodeId(e.parent);const t=this.getRootModel();return t===e?null:t.getId()}getModelByType(e,t=this.getModelsAsArray()){for(const i of t)if(i.getType()===e)return i;return null}getChildOfType(e,t,i=!1){const r=Array.isArray(t)?t:[t];for(const t of e.children)if(r.includes(t.getType()))return t;if(!i)return null;for(const i of e.children){const e=this.getChildOfType(i,t,!0);if(e)return e}return null}getChildrenOfType(e,t,i=!1,r=!1){const s=[],a=Array.isArray(t)?t:[t];for(const t of e.children)!a.includes(t.getType())||t.isNonPersistent()&&r||s.push(t);if(!i)return s;for(const i of e.children){const e=this.getChildrenOfType(i,t,!0,r);e&&s.push(...e)}return s}getModelsByKeyAndValue(e,t,i=this.getModelsAsArray()){return i.filter((i=>i.get(e)==t))}getModelsByPath(e,t=!0,i=!1,r=null){let s=[];const a=v.trim(e,"/").split("/");let o=a.shift();const n=v.parsePath(o).shift(),l=null!==n.index;l&&(o=n.base);let d=r;r||(d="*"===o?this.models:this.getModelsByType(o,this.models));const c=[];for(let e=0;e<d.length;e++)"*"!==o&&d[e].getType()!==o||d[e].isNonPersistent()&&!i||c.push(d[e]);if(l?c[n.index]?s.push(c[n.index]):!t&&c.length&&(n.index>=c.length?s.push(c[c.length-1]):s.push(c[0])):s=c,!s.length)return[];if(a.length){let e=[];for(let r=0;r<s.length;r++)s[r].children.length&&(e=e.concat(this.getModelsByPath(a.join("/"),t,i,s[r].children)));return e}return s}getModelByPath(e,t=!0,i=!1,r=null){const s=this.getModelsByPath(e,t,i,r);return s.length?s[0]:null}getModelsByQuery(e="",t=this.getModelsAsArray()){const i=e.trim().toLowerCase();return t.filter((e=>e.getType().toLowerCase().indexOf(i)>-1))}getModelsByType(e,t=this.models,i=!0){const r=[];return t.forEach((t=>{t.getType()===e&&r.push(t),i&&r.push(...this.getModelsByType(e,t.children,i))})),r}getNextContentModel(e){let t=this.getRightSibling(e);if(t){const e=this.getFirstContentModel(t);if(e)return e}return e.getParent()&&(t=this.getNextContentModel(e.getParent()),t)?t:null}getParentOfType(e,t,i=!0){const r=e.getParent();return r?r.getType()===t?r:i?this.getParentOfType(r,t,!0):null:null}getLeftSibling(e){if(!e.getParent())return null;const t=e.getModelIndex(!0);return 0===t?null:e.getParent().getPersistentChildren()[t-1]||null}getRightSibling(e){if(!e.getParent())return null;const t=e.getModelIndex(!0),i=e.getParent().getPersistentChildren();return i[t+1]?i[t+1]:null}hasChildOfType(e,t,i=!1){return!!this.getChildOfType(e,t,i)}hasChildOfTypes(e,t,i=!1){for(const r of t)if(this.getChildOfType(e,r,i))return!0;return!1}hasChild(e,t){if(!e.children.length)return!1;for(const i of e.children){if(this.is(i,t))return!0;if(this.hasChild(i,t))return!0}return!1}hasParentOfType(e,t,i=!1){return!!this.getParentOfType(e,t,i)}hasParentOfTypes(e,t,i=!1){if(!e||!Array.isArray(t))return!1;for(const r of t)if(this.getParentOfType(e,r,i))return!0;return!1}hasParent(e,t){return!!e.parent&&(!!this.is(e.parent,t)||this.hasParent(e.parent,t))}getModelsAsArray(e=null){let t=[];for(const i of e||this.models)t=t.concat(this.getChildModels(i));return t}getIndex(e,t=!1){return e?e.getModelIndex(t):null}getPath(e,t=!1){return e?e.getPath(t):null}getArrayPath(e,t=!1){return e?e.getArrayPath(t):[]}resetCache(){this.cache.id.clear(),this.cache.guid.clear()}addToCache(e,t=!0){if(e.isPseudo())return;t&&e.children.forEach((e=>this.addToCache(e))),this.cache.guid.set(e.getGuid(),e);const i=e.getId();i&&this.cache.id.set(i,e)}setData(e=[],t=!0){this.resetCache(),this.models=this.newModels(e,!1)}newModels(e=[],t=!0){const i=[];for(const t of e){const e=this.newModel(t);e&&i.push(e)}return i}newModelInstance(e){return new R(e,this.eventPipe)}modelCreated(e){this.addToCache(e)}modelsAdded(e){}newModel(e,t=!0){const i=this.modelData(e);if(!i)return Sys.logger.warn("ModelController: Data do not validate. Cannot create new instance of LabModel."),null;const r=this.newModelInstance(i);if(e.children)for(const i of e.children){const e=this.newModel(i,t);e&&r.addChild(e,t)}return this.modelCreated(r),r}modelData(e){if(!e.type)return Sys.logger.warn('ModelController: Required attribute "type" is missing. Cannot create data for new LabModel.'),null;const t=e;let i="";t.path&&(i=`${v.trim(t.path,["/"])}/`);const r=this.configReader.get(`data.elements.${t.type}.fallbackData`);return{uncreated:!1,type:t.type,path:i,width:"width"in t?t.width:null,metadata:"metadata"in t?{...t.metadata}:{},state:"state"in t?{...t.state}:{},contentdata:"contentdata"in t&&t.contentdata?{...t.contentdata}:null,filtered:"filtered"in t&&t.filtered?{...t.filtered}:null,selector:"selector"in t?t.selector:null,external:"external"in t?t.external:null,guid:"guid"in t?t.guid:null,fallback:r?A.viewToInternal(r):null}}insertAtPath(e){const t=I.validateViewInput(e,["path"],{useExisting:!1});if(!t)return Sys.logger.warn('ModelController: Cannot insert model at path. Missing required input "path", "data", or "data.type".'),null;Sys.logger.debug(`ModelController: Will insert model of type ${t.data.type} at path ${t.path}.`);const i=this.ensurePath(t.path,t.options.persistentTarget,t.options.intermediate.useExisting);if(!i)return Sys.logger.warn(`ModelController: No model inserted at path ${t.path}. Parent not found and could not be created.`),null;const r=this.insertAtParent(i,t.data,t.options);return Sys.logger.debug(`ModelController: Did insert model at path ${t.path}. Type: ${r.getType()}, path: ${r.getPositionedPath()}.`),r}insertBySelector(e){const t=I.validateViewInput(e,["selector"],{useExisting:!1});if(!t)return Sys.logger.warn('ModelController: Cannot insert model by selector. Missing required input "selector", "data", or "data.type".'),null;Sys.logger.debug(`ModelController: Will insert model of type ${t.data.type} at selector ${t.selector}.`);const i=this.getModelBySelector(t.selector);if(!i)return Sys.logger.warn(`ModelController: No model inserted at selector ${t.selector}. Model not found.`),null;const r=this.insertAtParent(i,t.data,t.options);return Sys.logger.debug(`ModelController: Did insert model at selector ${t.selector}. Type: ${r.getType()}, path: ${r.getPositionedPath()}.`),r}insertAtParent(e,t,i={}){const r={};t.state&&t.state.isNonPersistent&&(r.state={isNonPersistent:!0});const s=this.newModel(A.viewToInternal(t,r));if(e)if("number"==typeof i.index){let{index:t}=i;if(i.persistentTarget){const r=(i.match?this.getModelsByType(i.match,e.children||[],!1):e.children||[]).filter((e=>!e.isNonPersistent())),s=i.index<r.length&&i.index>=0?r[i.index]:r[r.length-1];t=this.getIndex(s)}e.addChildAtIndex(s,t)}else e.addChild(s,!0,i.prepend);else i.prepend?this.models.unshift(s):this.models.push(s);return this.modelsAdded([s],i.silent),s}addElement(e){const t={};e.data.state&&e.data.state.isNonPersistent&&(t.state={isNonPersistent:!0});const i=this.ensurePath(e.path,e.options.persistentTarget,e.options.intermediate.useExisting,t);return i&&e.options.useExisting&&(e.data.selector?this.getModelBySelector(e.data.selector):this.getChildOfType(i,e.data.type))?null:this.insertAtParent(i,e.data,e.options)}allowInsetion(e){const t={frontpage:()=>"page_front"===lab_api.v1.model.query.getRootModel().getType(),articlepage:()=>"page_article"===lab_api.v1.model.query.getRootModel().getType(),template:e=>lab_api.v1.model.query.getRootModel().get("fields.page_template_alias")===e,front:lab_api.v1.app.mode.isFront,editor:lab_api.v1.app.mode.isEditor},i=i=>{for(const r of i)if(e.options[r]&&t[r](e.options[r]))return!0;return!1};return!!i(["front","editor"])&&!(e.options.template&&!i(["template"]))&&i(["frontpage","articlepage"])}ensurePath(e,t,i=!0,r=null){const s=i?this.getModelsByPath(e,!0,!t).shift():null;if(s)return s;let a="",o=null;const n=v.parsePath(e);for(;n.length;){const e=n.shift();if(!e.base)return o;const s=e.index||0;let l=0,d=!1;const c=`${a}${e.base}[${s}]`;for(;l<=s;){if(!i&&!n.length&&l===s||!this.getModelsByPath(c,!0,!t).length){const t=r?{...r}:{};t.type=e.base;const i=this.newModel(t,!1);o?null!==e.index?o.addChildAtIndex(i,e.index):o.addChild(i):this.models.push(i),this.modelsAdded([i]),l===s&&(o=i,d=!0),Sys.logger.debug(`ModelController: Inserted intermediate model type ${e.base} at path ${i.getPositionedPath()}.`)}l++}a+=`${e.path}/`,o=d?o:this.getModelsByPath(a,!0,!t).shift()}return o}keyModified(e,t,i,r=!0){if(r){if(e.hasKeyInTarget(t))for(const r of e.getSourceTargets())this.keyModified(r,t,i,!1);e.hasSourceKey(t)&&this.keyModified(e.getSourceModel(),t,i)}this.cacheHandler.resetKey(e,t,i),this.triggerRedrawByKey(e,t,i)}childAdded(){}triggerRedrawByKey(e,t,i){}noRender(e){e&&e.setNoRenderState(!0)}}class D{constructor(e){this.totalGridSpans=e||12,this.backendNodes=new Map,this.nodeChildren={},this.activeNodes=[],this.offstageTypes=["pasteboard"],this.requireContentdata=["article"]}backendToInternal(e={},t={}){if(!e.data||!e.structure)return Sys.logger.debug("[DataTransformer] Unsupported input data. Require { data: {...}, structure: []"),[];const i=e.data,r=e.structure;this.registerBackendNodes(i);const s=lab_api.v1.viewport.getEditable(),a=A.backendToInternal({contentdata:this.backendNodes.get(i.id),structure:{type:`page_${i.type}`}},s,!1),o=[a];for(const e of r)if(t.skipOffstage&&this.offstageTypes.includes(e.type))Sys.logger.debug(`[DataTransformer] Skipping offstage-element "${e.type}".`);else{const i=this.createModelData(e,t.blacklist||[],t.blacklistOptions||{},s);i&&(this.offstageTypes.includes(e.type)?o.push(i):a.children.push(i))}return this.activeNodes.push(i.id),o}modelsToFragmentApi(e,{viewport:t=null,stringify:i=!1,recursive:r=!0}={}){const s=e.map((e=>this.modelToFragmentApi(e,r,t)));return i?s.map((e=>JSON.stringify(e))):s}modelToFragmentApi(e,t,i){const r={nodedata:this.modelToBackend(e,t),isNonPersistent:e.isNonPersistent(),type:e.getType(),width:e.getWidth(i),id:e.getGuid(),node_id:e.getId(),guid:e.getGuid()};if(t){r.children=[];for(const t of e.children)r.children.push(this.modelToFragmentApi(t))}return r}modelToBackend(e,t=!1){let i;const r=e.getSerializedCache();if(r?(lab_api.v1.app.dbg.logger.add(e.constructor.name,"modelToBackend[cache]"),i=r):(lab_api.v1.app.dbg.logger.add(e.constructor.name,"modelToBackend"),i=e.data.contentdata?{...A.internalToBackend(e.data.contentdata)}:{},e.data.contentdata&&(i.parent=lab_api.v1.model.query.getParentNodeId(e)),i.guid=e.data.guid,i.metadata=A.internalToBackendStructureMeta(e.data.metadata),i.metadata.width=e.getViewportWidths(),i.width=e.getWidth(),e.data.selector&&(i.selector=e.data.selector),i.type=e.data.type.replace("page_",""),e.data.tmpId&&(i.tmpId=e.data.tmpId),e.setSerializedCache({...i})),t&&e.children.length){i.children=[];for(const t of e.children)i.children.push(this.modelToBackend(t,!0))}return i}modelToInternal(e,t=!0,i=!1){const r=JSON.parse(JSON.stringify(e.data));if(i&&(r.contentdata&&delete r.contentdata.id,delete r.guid),r.children=[],!t)return r;for(const t of e.children)r.children.push(this.modelToInternal(t,!0,i));return r}modelToView(e,t=!0,i=!1){const r=this.modelToBackend(e,t);return A.backendToView(r,i)}modelsToView(e,t=!0){return e.map((e=>this.modelToView(e,t)))}modifiedToBackend(e,t,i=!0,r=!1){const s=[];for(const e of t)e.getType().startsWith("page_")?s.push(...e.getPersistentChildren()):s.push(e);const a=this.removeFrontCrops(s);return{node:e.map((e=>this.modelNodeToBackend(e,i,r))),structure:a.map((e=>this.modelStructureToBackend(e)))}}removeFrontCrops(e){return e.filter((e=>!e.get("fields.metadata_key")))}modelNodeToBackend(e,t=!1,i=!1){const r=this.modelToBackend(e,i);if(t&&!e.isDirty()){const t=A.filterModifiedContent(e,r),i=this.modelNodeBaseToBackend(e);return n.merge(i,t)}return delete r.metadata,delete r.width,r}modelNodeBaseToBackend(e){if(Array.isArray(e))return e.map((e=>this.modelNodeBaseToBackend(e)));const t=this.modelToBackend(e),i={type:t.type||null,id:t.id||null,guid:t.guid||null,tmpId:t.tmpId||null,instance_of:t.instance_of||null,parent:t.parent||null,status:t.status||null,site_id:t.site_id||null};return t.primaryTags&&(i.primaryTags=t.primaryTags),t.tags&&(i.tags=t.tags),i}modelStructureToBackend(e,t=!1){const i=this.modelToBackend(e),r={type:i.type,width:i.width,metadata:i.metadata,id:i.guid,selector:i.selector,children:[]};return i.id&&(r.node_id=i.id),e.isNonPersistent()&&(r.isNonPersistent=!0),e.children.forEach((e=>{!t&&e.isNonPersistent()||r.children.push(this.modelStructureToBackend(e,t))})),r}registerBackendNodes(e){if(e.id&&this.backendNodes.set(e.id,this.prepareBackendNode(e)),e.children){this.nodeChildren[e.id]=[];for(const t of e.children)this.registerBackendNodes(t),t.id&&this.nodeChildren[e.id].push(t.id)}}prepareBackendNode(e){const t={};for(const i in e)"children"!==i&&(t[i]=e[i]);return t}createModelData(e,t,i,r,s={}){if(t.includes(e.type)){if(i[e.type]&&i[e.type].includeChildren&&e.children&&s.children){Sys.logger.warn(`[DataTransformer] Found blacklisted element "${e.type}". Skipping. Will include and move children to parent element.`);for(const a of e.children){const e=this.createModelData(a,t,i,r);e&&s.children.push(e)}}else Sys.logger.warn(`[DataTransformer] Found blacklisted element "${e.type}". Skipping.`);return null}const a=A.backendToInternal({contentdata:e.node_id?this.backendNodes.get(e.node_id):null,structure:e},r,!1);if(this.requireContentdata.includes(a.type)&&!a.contentdata)return Sys.logger.debug(`[DataTransformer] Found "${a.type}" without node-data. Skipping.`),null;a.contentdata&&this.activeNodes.push(a.contentdata.id);for(const t in a.width.vp)a.width.vp[t]?a.width.vp[t]&&a.width.vp[t]<=this.totalGridSpans&&Number.isInteger(parseFloat(a.width.vp[t],10))&&(Sys.logger.warn(`[DataTransformer] Will modify Lab3-width for element "${e.type}", viewport "${t}". Was: "${a.width.vp[t]}", New value: "${P.gridToPercent(a.width.vp[t],this.totalGridSpans)}"`),a.width.vp[t]=P.gridToPercent(a.width.vp[t],this.totalGridSpans)):delete a.width.vp[t];if(!e.children){if(!(a.contentdata&&a.contentdata.id&&this.nodeChildren[a.contentdata.id]))return a;e.children=[];for(const t of this.nodeChildren[a.contentdata.id])if(!this.activeNodes.includes(t)){const i=this.backendNodes.get(t);i&&(e.children.push({type:i.type,node_id:t}),Sys.logger.warn(`[DataTransformer] Adding structure-data for deprecated node-child. Type: ${i.type}, id: ${t}`))}}for(const s of e.children){const e=this.createModelData(s,t,i,r,a);e&&a.children.push(e)}return a}}class O{constructor(e,t,i){this.renderer=t,this.log=i,this.styles={definitions:new Map,collections:new Map},this.setupStyles(O.resolveConfig(e||{})),this.styleByKey={},this.defaultItemTemplate="{{ #items }}{{ prefix }}{{ value }}{{ postfix }} {{ /items }}"}static resolveConfig(e={}){const t={definitions:{},collections:[]};for(const i of Object.keys(e.definitions||{})){const r=O.resolveDefinition(e.definitions[i]);r&&(t.definitions[i]=r)}const i=Array.isArray(e.collections)?e.collections:Object.values(e.collections||{});for(const e of i){const i=O.resolveCollection(e);i&&t.collections.push(i)}return t}static resolveDefinition(e={}){if(!Array.isArray(e.items)||!e.items.length)return null;const t={requirePath:l.false(e.requirePath),path:l.string(e.path),template:l.stringOrNull(e.template),items:[]};for(const i of e.items){const e=O.resolveItem(i);e&&t.items.push(e)}return t}static resolveItem(e={}){const t=Array.isArray(e.fallback)?e.fallback:[];return"string"==typeof e.fallback&&t.push(e.fallback),{prefix:l.string(e.prefix),postfix:l.string(e.postfix),viewport:l.string(e.viewport),value:l.string(e.value),fallback:t,nullValue:l.stringOrUndefined(e.nullValue)}}static resolveCollection(e){const t=l.string(e.name),i=l.array(e.definitions),r=l.array(e.additions);if(!t||!i.length&&!r.length)return null;const s=[];for(const e of[...i,...r])if("string"==typeof e)s.includes(e)||s.push(e);else{const t=O.resolveDefinition(e);t&&s.push(t)}return{name:t,definitions:s}}setupStyles(e={}){for(const t of Object.keys(e.definitions))this.styles.definitions.set(t,e.definitions[t]);for(const t of e.collections)this.styles.collections.set(t.name,t.definitions);this.log.debug(`StyleManager: Set up and ready. Holds ${this.styles.definitions.size} definitions and ${this.styles.collections.size} collections.`)}getStyleFromDefinition(e,t,i="",r){if(!this.styles.definitions.size)return"";const{name:s,path:a,target:o,targetType:n,index:l}=this.getInputValues(i),d=this.getTargetModel(e,o,n,l);return d?this.getStyleFromDefinitionNamePath(d,s,a,null,r):""}getStyleFromDefinitionNamePath(e,t,i,r,s){const a=this.getDefinition(t);return a?this.parseDefinition(e,t,i,a,r,s):(this.log.warn(`StyleManager: Cannot find style-definition "${t}". Empty string returned.`),"")}getStyle(e,t,i="",r){if(!this.styles.collections.size)return"";const{name:s,path:a,target:o,targetType:n,index:l}=this.getInputValues(i),d=this.getTargetModel(e,o,n,l);if(!d)return this.log.warn(`StyleManager: Cannot find target-model "${o}". Empty string returned. Model: ${e.getPositionedPath()}`),"";const c=this.getCollection(s);if(!c)return this.log.warn(`StyleManager: Cannot find style-collection "${s}". Empty string returned.`),"";const p=[];for(const e of c){const t=this.parseDefinition(d,s,a,e,null,r);t&&p.push(t)}return p.join(" ").trim()}getCollection(e){return this.styles.collections.get(e)}getDefinition(e){return this.styles.definitions.get(e)}getTargetModel(e,t,i,r){return"current"===t?e:"parent"===t?e.getParent():"root"===t?lab_api.v1.model.query.getRootModel():"child"===t?null===r?lab_api.v1.model.query.getChildOfType(e,i):lab_api.v1.model.query.getModelsByType(i,e.children)[r]||null:e}getInputValues(e=""){const t=(e||"").split(" ").map((e=>e.trim())).filter((e=>!!e)),i=t.shift();let r=t.shift()||"",s="current",a=null,o=null;if(r.startsWith("parent."))s="parent",r=r.replace("parent.","");else if(r.startsWith("root."))s="root",r=r.replace("root.","");else if(r.startsWith("current."))r=r.replace("current.","");else if(r.startsWith("child.")){const e=r.split(".");s=e.shift();const t=e.shift();r=e.join("."),[o,a]=T.getPropertyTypeAndIndex(t)}return{name:i,path:r||null,target:s,targetType:o,index:a}}getItemsViewports(e){const t={};for(const i of e)if(i.viewport&&(t[i.viewport]=!0),i.fallback)for(const e of i.fallback)t[e]=!0;return Object.keys(t)}parseDefinition(e,t,i,r,s,a){let o=r;if("string"==typeof r&&(o=this.getDefinition(r),!o))return this.log.warn(`StyleManager: Cannot find style-definition "${r}". Empty string returned.`),"";const n=[];if(o.requirePath&&!i)return this.log.warn(`StyleManager: Missing required path for style "${t}".`),"";const l=o.requirePath?i:"";for(const t of o.items){const i=this.getItemValueWithFallback(e,o.path,t,l,o.items,s,a);null!=i&&""!==i&&n.push({...t,value:i})}return n.length?this.renderer(o.template||this.defaultItemTemplate,{items:n}).trim().split(" ").filter(((e,t,i)=>i.indexOf(e)===t)).join(" "):""}getItemValueWithFallback(e,t,i,r,s,a,o){const n=r+(r&&t?".":"")+t,l=this.getItemValue(e,i,n,a,o);if(void 0!==l||"current_viewport"===i.viewport)return l;const d={...i};for(d.fallback=[...d.fallback];d.fallback.length;){const t=d.fallback.shift();d.viewport=t;const i=this.getItemValue(e,d,n,a,o);if(i)return i}}getItemValue(e,t,i,r,s){let a,{viewport:o}=t;return"no_viewport"===o?o="":"current_viewport"===o&&(o=s),a=r?o?(r.vp||{})[o]:r.value:e.get(i,o,!0),null!==a&&""!==a&&!1!==a||void 0===t.nullValue?a&&t.value?t.value:a:t.nullValue}}class E{constructor(e){this.headers=e.Headers||{},this.queryString=e.queryString||"",this.params=this.parseQueryString(this.queryString)}parseQueryString(e){const t={},i=e.split("&");for(const e of i){const i=e.split("=");2===i.length&&(t[i[0]]=i[1])}return t}getHeaders(){return this.headers}getHeader(e){return this.headers[e]||null}getQueryString(){return this.queryString}getQueryParam(e){return this.params[e]}hasQueryParam(e){return void 0!==this.getQueryParam(e)}}class V{constructor(e,t){this.logger=t,this.siteAlias=e,this.log(`Site-alias: ${this.siteAlias}`),this.featureFlags=[],this.cache={}}prepareFlags(e){const t=[];return Array.isArray(e)&&e.forEach((e=>{if("group"===e.type){const i=e.enabled;e.flags.forEach((e=>{e.enabled=i&&e.enabled,t.push(e)}))}else t.push(e)})),this.cache[this.siteAlias]=t,t}enabled(e,t=""){return this.featureFlags=this.cache[this.siteAlias]||this.prepareFlags(lab_api.v1.config.getFeatureFlags().flags||[]),this.featureFlags.filter((i=>{if(Array.isArray(t)){const r=t.map(String);return i.key===e&&(!i.nodeId||r.indexOf(i.nodeId)>-1)&&!0===i.enabled}return i.key===e&&(!i.nodeId||i.nodeId===t.toString())&&!0===i.enabled})).length>0}get(e,t=""){return this.featureFlags.filter((i=>i.key===e&&i.nodeId===t.toString()))}log(e,t=null){this.logger&&(t?this.logger.debug(`FeatureFlags: ${e}`,[t]):this.logger.debug(`FeatureFlags: ${e}`))}}class L{static getWords(e){return e.replaceAll("."," ").replaceAll("!"," ").split(" ").filter((e=>""!==e))}static getSentences(e){return e.replaceAll("!",".").split(".").filter((e=>""!==e))}static getReadTime(e,t){const i=L.getWords(e).length/(t||250);return i<.5?.5:Math.round(i)}static lix(e){if(!e)return null;const t=L.getWords(e),i=L.getSentences(e),r=t.filter((e=>e.length>6));return t.length/i.length+100*r.length/t.length}}class q{constructor(){this.ns={}}create(e={}){return{app:{dbg:{logger:{add:()=>{}}},logError:(e={})=>{e&&e.toString&&Sys.logger.debug(`CMS-error: ${e.toString()}`)},logViewError:(e={},t)=>{e&&e.toString&&Sys.logger.debug(`View-error: ${e.toString()}`)},mode:{get:e.configProcessor.getAppMode.bind(e.configProcessor),getSimulatedMode:e.configProcessor.getSimulatedMode.bind(e.configProcessor),isEditor:e.configProcessor.isEditMode.bind(e.configProcessor),isFragmentMode:e.configProcessor.isFragmentMode.bind(e.configProcessor),isFront:e.configProcessor.isPresentationMode.bind(e.configProcessor)},off:e.appManager.off.bind(e.appManager),on:e.appManager.on.bind(e.appManager)},config:{debug:e.configReader.debug.bind(e.configReader),get:e.configReader.get.bind(e.configReader),getConfig:e.configReader.getConfig.bind(e.configReader),getContent:e.configReader.getContent.bind(e.configReader),getFeatureFlags:e.configReader.getFeatureFlags.bind(e.configReader),getPathForSite:e.configReader.getPathForSite.bind(e.configReader),getStorePathForSite:e.configReader.getStorePathForSite.bind(e.configReader),getView:e.configReader.getView.bind(e.configReader),reloadResourceBySite:e.configReader.reloadResourceBySite.bind(e.configReader)},grid:{gridToPercent:P.gridToPercent,percentToGrid:P.percentToGrid},image:{getPreferredImageFormat:e.configProcessor.getPreferredImageFormat.bind(e.configProcessor)},locale:{get:e.localisation.get.bind(e.localisation),off:e.localisation.off.bind(e.localisation),on:e.localisation.on.bind(e.localisation)},model:{getArrayPath:e.modelController.getArrayPath,getPageType:e.configProcessor.getPageType.bind(e.configProcessor),getPath:e.modelController.getPath,insert:{atPath:e.modelController.insertAtPath.bind(e.modelController),bySelector:e.modelController.insertBySelector.bind(e.modelController)},noRender:e.modelController.noRender,off:e.modelController.off.bind(e.modelController),on:e.modelController.on.bind(e.modelController),query:{getChildOfType:e.modelController.getChildOfType.bind(e.modelController),getChildrenOfType:e.modelController.getChildrenOfType.bind(e.modelController),getIndex:e.modelController.getIndex.bind(e.modelController),getModelByGuid:e.modelController.getModelByGuid.bind(e.modelController),getModelById:e.modelController.getModelById.bind(e.modelController),getModelByPath:e.modelController.getModelByPath.bind(e.modelController),getModelBySelector:e.modelController.getModelBySelector.bind(e.modelController),getModelByType:e.modelController.getModelByType.bind(e.modelController),getModels:e.modelController.getModels.bind(e.modelController),getModelsAsArray:e.modelController.getModelsAsArray.bind(e.modelController),getModelsByKeyAndValue:e.modelController.getModelsByKeyAndValue.bind(e.modelController),getModelsByPath:e.modelController.getModelsByPath.bind(e.modelController),getModelsByQuery:e.modelController.getModelsByQuery.bind(e.modelController),getModelsByType:e.modelController.getModelsByType.bind(e.modelController),getModelsFromCache:e.modelController.getModelsFromCache.bind(e.modelController),getModelTypes:e.modelController.getModelTypes.bind(e.modelController),getNextContentModel:e.modelController.getNextContentModel.bind(e.modelController),getParentNodeId:e.modelController.getParentNodeId.bind(e.modelController),getParentOfType:e.modelController.getParentOfType.bind(e.modelController),getRootModel:e.modelController.getRootModel.bind(e.modelController),getSiblingLeft:e.modelController.getLeftSibling.bind(e.modelController),getSiblingRight:e.modelController.getRightSibling.bind(e.modelController),hasChild:e.modelController.hasChild.bind(e.modelController),hasChildOfType:e.modelController.hasChildOfType.bind(e.modelController),hasChildOfTypes:e.modelController.hasChildOfTypes.bind(e.modelController),hasParent:e.modelController.hasParent.bind(e.modelController),hasParentOfType:e.modelController.hasParentOfType.bind(e.modelController),hasParentOfTypes:e.modelController.hasParentOfTypes.bind(e.modelController)},root:{getType:()=>e.modelController.getRootModel()?e.modelController.getRootModel().get("type"):""},serialize:{model:e.dataTransformer.modelToBackend.bind(e.dataTransformer),modelToInternal:e.dataTransformer.modelToInternal.bind(e.dataTransformer),modelToView:e.dataTransformer.modelToView.bind(e.dataTransformer)}},ns:{get:(e="")=>n.get(e,this.ns),set:(e,t)=>n.set(e,t,this.ns)},preload:{get:e.preloadHandler.get.bind(e.preloadHandler),getHeader:e.preloadHandler.getHeader.bind(e.preloadHandler)},properties:{get:e.configReader.getCms.bind(e.configReader),update:e.configReader.updateConfigByPath.bind(e.configReader)},templates:{get:e.resourceManager.getTemplateFile.bind(e.resourceManager)},site:{getSite:e.configProcessor.getSite.bind(e.configProcessor),getSiteById:e.configProcessor.getSiteById.bind(e.configProcessor),getSites:e.configProcessor.getSites.bind(e.configProcessor)},style:{getNamedStyle:e.styleManager.getStyleFromDefinitionNamePath.bind(e.styleManager),getStyle:e.styleManager.getStyleFromDefinition.bind(e.styleManager),getStyles:e.styleManager.getStyle.bind(e.styleManager)},util:{defaults:e.utils.defaults,featureFlags:{enabled:e.featureFlags.enabled.bind(e.featureFlags),get:e.featureFlags.get.bind(e.featureFlags)},functionHelper:{getFunction:e.utils.functionHelper.getFunction,isValidFunction:e.utils.functionHelper.isValidFunction},object:n,request:{getHeader:e.requestUtil.getHeader.bind(e.requestUtil),getHeaders:e.requestUtil.getHeaders.bind(e.requestUtil),getQueryParam:e.requestUtil.getQueryParam.bind(e.requestUtil),getQueryString:e.requestUtil.getQueryString.bind(e.requestUtil),hasQueryParam:e.requestUtil.hasQueryParam.bind(e.requestUtil),parseQueryString:e.requestUtil.parseQueryString.bind(e.requestUtil)},string:e.utils.stringHelper},view:{getHelper:e.viewManager?e.viewManager.getViewHelper.bind(e.viewManager):()=>{},getPixelDensityFactor:e.configProcessor.getPixelDensityFactor.bind(e.configProcessor),getView:e.viewManager?e.viewManager.getView.bind(e.viewManager):null,off:e.viewManager?e.viewManager.off.bind(e.viewManager):null,on:e.viewManager?e.viewManager.on.bind(e.viewManager):null,render:({template:t,model:i,viewManager:r=e.viewManager}={})=>{const s=r.getView(i),a=r.getDataForView(i,s);return Mustache.render(t,a,e.resourceManager.templates)}},viewHeaders:{get:t=>e.viewHeaders.get?e.viewHeaders.get(t):"",getAll:()=>e.viewHeaders.getAll?e.viewHeaders.getAll():"",set:(t,i)=>{e.viewHeaders.set&&e.viewHeaders.set(t,i)}},viewport:{getActive:()=>[e.configProcessor.getViewport()],getAll:e.configProcessor.getViewports.bind(e.configProcessor),getEditable:e.configProcessor.getEditableViewports.bind(e.configProcessor),getMain:e.configProcessor.getMainViewport.bind(e.configProcessor),getName:e.configProcessor.getViewport.bind(e.configProcessor),getSubViewports:e.configProcessor.getSubViewports.bind(e.configProcessor),getWidth:e.configProcessor.getViewportWidth.bind(e.configProcessor),isMain:e.configProcessor.isMainViewport.bind(e.configProcessor),isSubViewport:e.configProcessor.isSubViewport.bind(e.configProcessor),isTouchDevice:e.configProcessor.isTouchDevice.bind(e.configProcessor)},text:{getWords:L.getWords,getSentences:L.getSentences,getReadTime:L.getReadTime,lix:L.lix}}}}class W{constructor(e=[]){this.viewManagers=e,Sys.logger.debug(`CacheHandler: Ready to support view-manager(s) for viewport(s): ${this.viewManagers.map((e=>e.viewport.name)).join(", ")}`)}setViewManagers(e){this.viewManagers=e}resetKey(e,t,i){this.resetModelCacheForKey(e,t,i),this.resetViewCacheForKey(e,t)}resetModelCacheForKey(e,t,i){e.cache.getter.delete(e.getCacheKey(t,i)),e.cache.getter.delete(e.getCacheKey(t,i,!0)),e.cache.getter.forEach(((r,s)=>{s.startsWith(`${t}.`)&&s.endsWith(`-${i||"lab_main"}`)&&e.cache.getter.delete(s)}))}resetViewCacheForKey(e,t){for(const i of this.viewManagers)i.getView(e).resetCache(t)}}class B{constructor(e,t=null){this.isEnabled=!0,this.Implementation=e,this.instance=null,this.name=t}initialize(){this.instance=new this.Implementation}disable(){this.isEnabled=!1}enable(){this.isEnabled=!0}call(e,...t){if(this.isEnabled){if(!this.instance){if(!this.Implementation)return;this.initialize(),this.instance.name&&(this.name=this.instance.name)}if(e in this.instance)return this.instance[e](...t)||null}}}class H extends B{}class U extends B{initialize(){this.instance=new this.Implementation(lab_api)}}class N{constructor(e){this.data=e}get(e=""){const t=e.split("."),i=this.getObject(t.shift());return i?t.length?n.get(t.join("."),i):i:null}getObject(e){return e?this.data[e]||null:this.data}getHeader(e){if(e){const t=this.getObject(e);return t?t.responseHeaders:null}return null}}class z extends u{constructor({configReader:e,language:t,siteAlias:i,renderFn:r,configPrefix:s}){super(),this.configReader=e,this.language=t||this.configReader.get("contentLanguage")||"en-GB",this.secondaryLanguage=this.configReader.get("contentLanguageFallback")||this.language,this.siteAlias=i||this.configReader.siteAlias,this.fallbackLanguage="en-GB",this.renderFn=r,this.objectHelper=n,this.configPrefix=s||"int_",this.cache=new Map}overrideLanguage(e){e&&(this.secondaryLanguage===this.language&&(this.secondaryLanguage=e),this.language=e)}get(e,{language:t,siteAlias:i,data:r={},noRender:s=!1}={}){const a=(e||"").trim(),o=r||{},n=t||this.language,l=`${a}_${n}_${i}_${JSON.stringify(o||{})}_${s?"1":"0"}`;return this.cache.has(l)||this.cache.set(l,this.getKey(a,n,i,o,s)),this.cache.get(l)}getKey(e,t,i,r,s){const a=this.readConfigObject(e,i,t);if(a)return this.returnValue(e,a,r,t,i,"config",s);const o=this.readConfig(e,t,i);return o?this.returnValue(e,o,r,t,i,"configObject",s):t!==this.fallbackLanguage&&t!==this.secondaryLanguage&&this.secondaryLanguage!==this.language?this.getKey(e,this.secondaryLanguage,i,r,s):t!==this.fallbackLanguage?this.getKey(e,this.fallbackLanguage,i,r,s):e}returnValue(e,t,i,r,s,a,o){const n={value:t,data:i},l=this.requestEvent("localisation",{key:e,value:t,data:i,language:r,siteAlias:s,type:a});if(l.length){const e=l.pop();"string"==typeof e.value&&(n.value=e.value,n.data=e.data)}return n.value?o?n.value:this.renderFn(n.value,n.data).trim():e}readConfig(e,t,i){const r=this.configReader.getConfig(`${this.configPrefix}${t}.${e}`,{site:i});return"string"==typeof r?r:void 0}readConfigObject(e,t,i){const r=t||this.siteAlias,s=i||this.language,a=this.configReader.getLocal(`lang.${r}.${s}.${e}`);return"string"==typeof a?a:void 0}}class G extends u{constructor({logger:e={},settings:{siteAlias:t="default",pageType:i="front",contentId:r=null,device:s="desktop",runtime:a={Request:!1},transform:n,fragmentMode:l=null,debug:d=!1,simulatedMode:g=""},resources:{config:u={},templates:h={view:{},editor:{}},properties:b={},data:y=null,preload:v={},viewHeaders:w={},views:_=[]},globals:k={},callbacks:x={},entries:P=[],behaviours:C={}}={}){super({entries:P.map((e=>new H(e))),behaviours:Object.keys(C).reduce(((e,t)=>({...e,[t]:C[t].map((e=>new U(e,t)))})),{}),debug:d}),this.settings={debug:d,fragmentMode:l,simulatedMode:g,pageType:i,contentId:r,siteAlias:t,device:s,request:a.Request,transform:void 0===n||!!n},this.resources={properties:b,data:y,templates:h?h.view:{},viewHeaders:w},this.logger=e,this.settings.fragmentMode&&this.logger.debug(`[Core] Running fragmentMode: "${l}"`),this.configReader=new c(c.resolveFullConfig(u,o),this.logger),this.configProcessor=new p(this.configReader,this.settings.device,this.settings.fragmentMode,this.settings.pageType,this.settings.simulatedMode),this.logger.debug("---------------------------------------------------------"),this.logger.debug("[Core] Labrador rendering engine"),this.logger.debug(`Version ${this.configReader.getCms("app.version")} - build ${this.configReader.getCms("buildInfo.version")} - views: ${_.join(", ")}`),this.logger.debug("(c) Labrador CMS AS. Use require a valid licence"),this.logger.debug("---------------------------------------------------------"),this.localisation=new z({configReader:this.configReader,renderFn:Mustache.render}),this.viewManager=null,this.pathHelper=new T,this.resourceManager=new f(this.resources.properties,this.resources.templates,this.configReader,m.resolveConfig,this.behaviours,this.pathHelper,this.settings.debug),this.dataTransformer=new D(this.configReader.get("grid.total_grid_spans")),this.modelController=new I(this.configReader,this.resourceManager,this.entries,this.behaviours),this.styleManager=new O(this.configReader.get("style"),Mustache.render,this.logger),this.preloadHandler=new N(v),this.viewManager=new j({resourceManager:this.resourceManager,configReader:this.configReader,configProcessor:this.configProcessor,logger:this.logger,viewport:this.settings.device,styleManager:this.styleManager,entries:this.entries,behaviours:this.behaviours,settings:this.settings,localisation:this.localisation,preloadHandler:this.preloadHandler}),this.api={v1:this.createApi()},k.lab_api=this.api,x.apiReady&&x.apiReady(this.api.v1),this.apiReady(this.api),this.resources.data&&this.setData(this.resources.data)}getApi(){return this.api}createApi(){this.logger.debug("Core: Creating api using CoreApi.");const e=new q,t={appManager:this,configReader:this.configReader,configProcessor:this.configProcessor,modelController:this.modelController,viewManager:this.viewManager,styleManager:this.styleManager,dataTransformer:this.dataTransformer,utils:a,requestUtil:new E(this.settings.request),featureFlags:new V(this.settings.siteAlias,this.logger),preloadHandler:this.preloadHandler,viewHeaders:this.resources.viewHeaders,localisation:this.localisation,resourceManager:this.resourceManager};return e.create(t)}getAllLogs(){return{front:this.getLogs(),view:this.viewManager.getLogs(),resource:this.resourceManager.getLogs(),model:this.modelController.getLogs()}}setSite(e){this.configReader.updateConfigByPath("site",e),this.configReader.getCms("site",{noCache:!0}),this.configProcessor.resetCache()}apiReady(e){this.logger.debug("Core: Api ready."),this.viewManager.apiReady(e),this.modelController.setCacheHandler(new W([this.viewManager])),this.onReady(e)}onReady(e){this.emitEntry("onReady",e)}setData(e){if(!e||!this.settings.transform&&!Array.isArray(e)||this.settings.transform&&!e.data)throw new Error("[Core] Cannot set data. Invalid input. "+(this.settings.transform?"Expecting property data, none given.":`Expecting an array, ${typeof e} given.`));this.viewManager.viewMap.clear();const t=this.settings.transform?this.dataTransformer.backendToInternal(e,{blacklist:this.configReader.get("data.blacklist")||[],skipOffstage:!0}):e;let i=null;const r=this.emitEntry("onDataReady",t);r.length&&(this.logger.warn("[Core] Entry-hook 'onDataReady' has modifyed input-data."),i=r.pop()),this.modelController.setData(i||t),this.resourceManager.rootModelReady(this.modelController.getRootModel()),this.emitEntry("onAcceptContent"),this.emitEvent("acceptContent")}serializeView(e=this.modelController.models){return this.dataTransformer.modelsToView(e)}serializeForFragmentApi(e=this.modelController.models,{device:t=this.settings.device,stringify:i=!0,recursive:r=!0}={}){return this.dataTransformer.modelsToFragmentApi(e,{device:t,stringify:i,recursive:r})}render(e,{transform:t}={}){return new Promise(((i,r)=>{void 0!==t&&(this.settings.transform=!!t),this.setData(e),i(this.draw())}))}draw(e){return this.viewManager.draw(this.modelController.models,(t=>{e&&e(t)}))}getMarkup(e){if(!e)return this.logger.warn("Core: No model supplied. Will return empty string."),"";const t=this.viewManager.getView(e);return t?t.getMarkupString()||"":(this.logger.warn(`Core: Cannot get view for model ${e.getPositionedPath()}. Will return empty string.`),"")}}var K=s.Q},"./public/common/labrador/Mapper.js":(e,t,i)=>{i.r(t),i.d(t,{Mapper:()=>n});var r=i("./public/common/labrador/ClientData.js"),s=i("./public/common/labrador/transformers/source/LabradorApi.js"),a=i("./public/common/labrador/transformers/source/DachserJson.js"),o=i("./public/common/labrador/transformers/source/KilkayaStreams.js");class n{constructor({source:e,image_server:t,mapperSettings:i={},settings:r={useEditorProxy:!1}}={}){this.source=e,this.useEditorProxy=r.useEditorProxy,this.image_server=t,this.mapperSettings=i}map(e){const t=new r.ClientData;switch(this.source){case"LabradorApi":return this.mapLabradorApi(e,t);case"DachserJson":return this.mapDachserJson(e,t);case"KilkayaStreams":return this.mapKilkayaStreams(e,t);default:return console.warn(`[Mapper] Unsupported source ${this.source}`),[]}}mapLabradorApi(e,t){const i=this.resolveProxy(e);if(!i||!i.result||!i.result.length)return t;const r=new s.LabradorApi(this.mapperSettings);return t.setData(r.map(i)),t.setTotalCount(i.totalCount),t}mapDachserJson(e,t){const i=this.resolveProxy(e);if(!i||!i.result||!i.result.length)return t;const r=new a.DachserJson(this.mapperSettings);return t.setData(r.map(i)),t.setTotalCount(i.totalCount),t}mapKilkayaStreams(e,t){if(!e||!e.stream||!e.stream.length)return t;const i=new o.KilkayaStreams(this.mapperSettings);return t.setData(i.map(e.stream)),t.setTotalCount(e.stream.length),t}resolveProxy(e){return this.useEditorProxy?JSON.parse(e.value):e}}},"./public/common/labrador/Reader.js":(e,t,i)=>{i.r(t),i.d(t,{Reader:()=>r});class r{constructor({url:e,mappers:t=[]}={}){this.url=e,this.mappers=t,this.modifiedUrl=this.url,this.cache=new Map}read(){return new Promise(((e,t)=>{this.cache.has(this.modifiedUrl)?e(this.mapData(this.cache.get(this.modifiedUrl))):fetch(this.modifiedUrl).then((e=>e.json())).then((t=>{this.cache.set(this.modifiedUrl,t);const i=this.mapData(t);e(i)})).catch((e=>{console.log("[Reader] Failed to fetch/transform data. Please check input params. Error:"),console.error(e)}))}))}mapData(e){let t=e;for(const e of this.mappers)t=e.map(t);return t}updateUrl(e){this.modifiedUrl=e}reload(e=!1){return e&&this.cache.delete(this.modifiedUrl),this.read()}}},"./public/common/labrador/Renderer.js":(e,t,i)=>{i.r(t),i.d(t,{Renderer:()=>o});var r=i("./public/common/labrador/Core.js"),s=i("./build/modules/client_modules.js"),a=i("./build/modules/client_package.js");class o{constructor(e){console.group("[Labrador] Setup rendering engine");const t=o.resolveConfig(e),i={},n=[s.Entry];for(const e of Object.keys(s.behaviours))i[e]=[s.behaviours[e]];let l=!1;new URLSearchParams(window.location.search).get("debug")&&(l=!0),window.Sys={logger:console},this.renderer=new r.Core({logger:window.Sys.logger,settings:{siteAlias:t.site.alias,device:t.app.device,debug:l,transform:t.app.transform},resources:{config:{site:{alias:t.site.alias,display_name:t.site.display_name,domain:t.site.domain,id:t.site.id},image_server:t.app.image_server,app:{mode:"presentation",abc:123},customer:{...a.config,...t.config}},templates:{view:a.templates},properties:a.properties,views:["baseview_client"]},globals:window,callbacks:{},entries:n,behaviours:i}),this.api=this.renderer.getApi(),console.groupEnd()}static resolveConfig(e){const t=e.site||{},i=e.app||{};return{config:e.config||{},site:{alias:t.alias,display_name:t.display_name,id:t.id,domain:t.domain},app:{debug:!!i.debug,image_server:i.image_server,device:i.device,transform:!!i.transform}}}setData(e){return this.renderer.setData("function"==typeof e.getData?e.getData():e)}render(){return new Promise(((e,t)=>{console.group("[Labrador] Render data"),this.renderer.draw((t=>{e(t),console.groupEnd()}))}))}}},"./public/common/labrador/source/FrontContentMapper.js":(e,t,i)=>{i.r(t),i.d(t,{FrontContentMapper:()=>r});class r{constructor(e){this.layout=e.layout||{},this.hide_items=this.layout.hide_items||[],this.alignImage=e.alignImage?`float${e.alignImage.charAt(0).toUpperCase()+e.alignImage.slice(1)}`:"",this.fallbackImage=e.fallbackImage,this.imageWidth=e.imageWidth}map(e){return e.setData(e.getData().map((e=>{const t={...e};if(t.children&&t.children[0]){const e=t.children[0];e.contentdata.fields.float={vp:{desktop:this.alignImage}},e.contentdata.fields.whRatio={vp:{desktop:this.layout.imageAspectRatio||.5}},e.width={vp:{desktop:this.imageWidth,mobile:100}}}else this.fallbackImage&&t.children.push({type:"image",contentdata:{fields:{imageurl:{value:`${this.fallbackImage}`},float:{vp:{desktop:this.alignImage}},whRatio:{vp:{desktop:this.layout.imageAspectRatio||.5}}}},width:{vp:{desktop:this.imageWidth,mobile:100}},metadata:{style_preset:{value:"fallbackImage"}}});for(const e of this.hide_items)switch(e){case"title":t.metadata.hideTitle={value:!0};break;case"subtitle":t.metadata.hidesubtitle={value:!0};break;case"image":t.metadata.hideimage={value:!0}}return this.hide_items.includes("kicker")||(t.metadata.showKicker={value:!0}),t}))),e}}},"./public/common/labrador/source/FrontContentRenderer.js":(e,t,i)=>{i.r(t),i.d(t,{FrontContentRenderer:()=>u});var r=i("./public/common/labrador/Mapper.js"),s=i("./public/common/labrador/Reader.js"),a=i("./public/common/labrador/Renderer.js"),o=i("./public/common/labrador/source/FrontContentMapper.js"),n=i("./public/common/labrador/transformers/prosessors/Filter.js"),l=i("./public/common/labrador/transformers/prosessors/Tags.js"),d=i("./public/common/labrador/transformers/prosessors/RowLines.js"),c=i("./public/common/labrador/transformers/prosessors/Setter.js"),p=i("./public/common/labrador/transformers/layout/RowsAndColumns.js"),g=i("./public/common/labrador/transformers/layout/RandomRows.js");class u{constructor({url:e,app:t={},site:i={},settings:u={}}={}){this.mappers={api:new r.Mapper({source:u.sourceType,image_server:t.image_server,settings:{useEditorProxy:u.isEditor&&"LabradorApi"!==u.sourceType}}),tagboard:new o.FrontContentMapper(u),filter:new n.Filter({data:u.articleFilterList}),tags:new l.Tags({tagGroups:[]}),setter:new c.Setter({data:u.style}),rows:"RowsAndColumns"===u.organizer?new p.RowsAndColumns({layout:u.layout}):new g.RandomRows({layout:u.layout}),lines:new d.RowLines(u)},this.reader=new s.Reader({url:e,mappers:[this.mappers.api,this.mappers.tagboard,this.mappers.filter,this.mappers.tags,this.mappers.setter,this.mappers.rows,this.mappers.lines]}),this.renderer=new a.Renderer({app:t,site:i})}read(){return new Promise(((e,t)=>{this.reader.read().then((i=>{0!==!i.data.count?this.render(i).then((t=>{e(t)})).catch((e=>{t(e)})):t()})).catch((e=>{t(e)}))}))}render(e){return new Promise(((t,i)=>{0!==!e.data.count?(this.renderer.setData(e),this.renderer.render().then((i=>{e.setMarkups(i),t(e)})).catch((e=>{i(e)}))):i()}))}filter(e){Array.isArray(e)&&e.length&&(this.mappers.tags.tagGroups=[...e])}updateUrl(e){this.reader.updateUrl(e)}}},"./public/common/labrador/source/Search.js":(e,t,i)=>{i.r(t),i.d(t,{Search:()=>n});var r=i("./public/common/labrador/Mapper.js"),s=i("./public/common/labrador/Reader.js"),a=i("./public/common/labrador/Renderer.js"),o=i("./public/common/labrador/source/SearchMapper.js");class n{constructor({config:e,url:t,app:i={},site:n={},searchMapper:l={}}={}){this.reader=new s.Reader({url:t,mappers:[new r.Mapper({source:"LabradorApi",image_server:i.image_server}),new o.SearchMapper(l)]}),this.renderer=new a.Renderer({config:e,app:i,site:n})}read(){return new Promise(((e,t)=>{this.reader.read().then((i=>{this.renderer.setData(i),this.renderer.render().then((t=>{i.setMarkups(t),e(i)})).catch((e=>{t(e)}))})).catch((e=>{t(e)}))}))}updateUrl(e){this.reader.updateUrl(e)}}},"./public/common/labrador/source/SearchMapper.js":(e,t,i)=>{i.r(t),i.d(t,{SearchMapper:()=>r});class r{constructor(e){this.bodytextLength=e.bodytextLength||0,this.fallbackImage=e.fallbackImage,this.sites=e.sites,this.sitesById={}}map(e){return e.setData(e.getData().map((e=>{const t={...e};if(t.children&&t.children[0]){const e=t.children[0];e.contentdata.fields.float={vp:{desktop:"floatLeft"}},e.contentdata.fields.width={vp:{desktop:160,mobile:200}},e.contentdata.fields.whRatio={vp:{desktop:.65}}}else this.fallbackImage&&t.children.push({type:"image",contentdata:{fields:{imageurl:{value:`${this.fallbackImage}`},float:{vp:{desktop:"floatLeft"}},width:{vp:{desktop:160,mobile:200}},whRatio:{vp:{desktop:.65}}}},metadata:{style_preset:{value:"fallbackImage"}}});return t.contentdata.fields.subtitle.value=this.trimBodytext(t.contentdata.fields.subtitle.value,t),t.contentdata.fields.subtitle.value+=`<span class="info"><span class="sitealias label">${this.siteIdToDisplayName(t.contentdata.fields.site_id.value)}</span> <span class="date fi-clock"> ${this.dateToAge(t.contentdata.fields.published.value)}</span> <span class="section_tag fi-price-tag"> ${t.contentdata.primaryTags.section}</span></span>`,t}))),e}trimBodytext(e,t){if(e)return e;const i=t.contentdata.fields.bodytext.value||"",r=this.bodytextLength;return 0===r?"":i.length>r?`${i.substring(0,r)} ...`:i}siteIdToDisplayName(e){const t=parseInt(e,10);return void 0===this.sitesById[e]&&(this.sitesById[e]=(this.sites.filter((e=>e.id===t)).pop()||{}).displayName),this.sitesById[e]}dateToAge(e){if(!e)return"";const t=new Date(e);return`${t.toLocaleDateString()} - ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}}},"./public/common/labrador/transformers/datatype.js":(e,t,i)=>{i.r(t),i.d(t,{datatype:()=>r});const r={object:{get:(e="",t={},i=!1)=>e.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:i?void 0:null),t),set:(e,t,i)=>(e.split(".").reduce(((e,i,s,a)=>{if(s!==a.length-1)return r.object.isObject(e[i])?e[i]:e[i]={};e[i]=t}),i),i),isObject:e=>e&&"object"==typeof e&&!Array.isArray(e),merge:(e,t)=>{if(Array.isArray(e)&&Array.isArray(t))return t;const i=Object.assign(Array.isArray(e)?[]:{},e);if(r.object.isObject(e)&&r.object.isObject(t))for(const s of Object.keys(t))r.object.isObject(t[s])?s in e&&r.object.isObject(e[s])?i[s]=r.object.merge(e[s],t[s]):Object.assign(i,{[s]:t[s]}):Object.assign(i,{[s]:t[s]});return i}},string:{unique:e=>{const t=`0x${10**(e-1)}`;return Math.floor((1+Math.random())*t).toString(16)},strip_tags:(e="")=>(e||"").replace(/<(?:.|\n)*?>/gm,"").trim()}}},"./public/common/labrador/transformers/layout/RandomRows.js":(e,t,i)=>{i.r(t),i.d(t,{RandomRows:()=>s});var r=i("./public/common/labrador/transformers/utils.js");class s{constructor(e){const t=e.layout||{};this.options={maxPixelWidth:t.maxPixelWidth||1e3,imageAspectRatio:t.imageAspectRatio||.6,maxRowSize:t.maxRowSize||4,minRowSize:t.minRowSize||1,selector:t.selector||"",grid_size:t.grid_size||12}}map(e){const t=e.getData(),i=[];if(!t.length)return e;const s=[];let a=[],o=this.getRandomInt(this.options.minRowSize,this.options.maxRowSize);for(const e of t){if(a.length>=o){s.push(a),a=[];const e=o;o=this.getRandomInt(this.options.minRowSize,this.options.maxRowSize),o===e&&(o=this.getRandomInt(this.options.minRowSize,this.options.maxRowSize))}a.push(e)}s.push(a);for(const e of s)r.utils.decorateRow(e,this.options),i.push({type:"row",selector:this.options.selector||"",children:e});return e.setData(i),e}getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}}},"./public/common/labrador/transformers/layout/RowsAndColumns.js":(e,t,i)=>{i.r(t),i.d(t,{RowsAndColumns:()=>s});var r=i("./public/common/labrador/transformers/utils.js");class s{constructor(e){const t=e.layout||{};this.options={columnCount:t.columnCount||3,rowCount:t.rowCount||4,grid_size:t.grid_size||12,maxPixelWidth:t.maxPixelWidth||1e3,imageAspectRatio:t.imageAspectRatio||.6,selector:t.selector||""}}map(e){const t=[],i=r.utils.groupRowsAndColums(e.getData(),this.options);for(const e of i)r.utils.decorateRow(e,this.options),t.push({type:"row",selector:this.options.selector||"",children:e});return e.setData(t),e}}},"./public/common/labrador/transformers/prosessors/Filter.js":(e,t,i)=>{i.r(t),i.d(t,{Filter:()=>s});var r=i("./public/common/labrador/transformers/datatype.js");class s{constructor(e){this.options={data:e.data||[]}}map(e){const t=e.getData();return Array.isArray(t)&&this.options.data.length?(e.setData(t.filter((e=>{for(const t of this.options.data)if(Array.isArray(t.values)&&t.values.includes(r.datatype.object.get(t.path,e)))return!1;return!0}))),e):e}}},"./public/common/labrador/transformers/prosessors/RowLines.js":(e,t,i)=>{i.r(t),i.d(t,{RowLines:()=>s});var r=i("./public/common/labrador/transformers/datatype.js");class s{constructor(e){this.active="RowLines"===e.postprocessor,this.aspectRatio=e.layout.imageAspectRatio||.45,this.options={ratioOptionsSource:{title:1.4,subtitle:1,kicker:1,image:1},ratioOptionsTarget:{title:1.4,subtitle:1,kicker:1,image:1},text_size:{min:16,max:70,base:30},fieldSuffix:{size:"text_size"}}}map(e){if(!this.active)return e;const t=e.getData();return this.autoLayoutRows(t,this.options),e.setData(t),e}autoLayoutRows(e,t){return e.forEach((e=>this.autoLayoutRow(e,t))),e}autoLayoutRow(e,t){const i=e.children.length,s={kicker:e.children.map((e=>Math.max((e.contentdata.fields.kicker.value||"").length,10))),title:e.children.map((e=>Math.max(r.datatype.string.strip_tags(e.contentdata.fields.title.value||"").length,10))),subtitle:e.children.map((e=>Math.max((e.contentdata.fields.subtitle.value||"").length,50))),image:e.children.map((e=>e.children.length?177:0))},a=Object.keys(s),o=3,n=1.5,l=.54,d=.5,c=t.ratioOptionsSource||{},p=t.ratioOptionsTarget||{};for(const e of a)c[e]=c[e]||1,p[e]=p[e]||1;const g=[];for(let e=0;e<i;e++)g.push(parseInt(s.title[e]*o*c.title+s.kicker[e]*n*c.kicker+s.subtitle[e]*l*c.subtitle+s.image[e]*d*c.image,10));const u=this.getAvg(g),h=g.map((e=>u/e));for(const i of e.children){const a=e.children.indexOf(i),o=s.image[a]>0,n=o?(h[a]-1)/2+1:h[a];if(o){const e=n*p.image;i.children[0].contentdata.fields.whRatio={value:this.aspectRatio*e}}let l=Math.round(t.text_size.base*n*p.title);l<t.text_size.min&&(l=t.text_size.min),l>t.text_size.max&&(l=t.text_size.max),r.datatype.object.set(`attributes.${this.options.fieldSuffix.size}.value`,l,i.contentdata.fields.title)}}getAvg(e){return Math.round(e.reduce(((e,t)=>e+t),0)/e.length)}}},"./public/common/labrador/transformers/prosessors/Setter.js":(e,t,i)=>{i.r(t),i.d(t,{Setter:()=>s});var r=i("./public/common/labrador/transformers/datatype.js");class s{constructor(e){this.options={data:e.data||[]}}map(e){if(!this.options.data.length)return e;const t=e.getData();for(const e of t)for(const t of this.options.data)t.path&&void 0!==t.value&&r.datatype.object.set(t.path,t.value,e);return e.setData(t),e}}},"./public/common/labrador/transformers/prosessors/Tags.js":(e,t,i)=>{i.r(t),i.d(t,{Tags:()=>r});class r{constructor({tagGroups:e=[]}={}){this.tagGroups=Array.isArray(e)?e:[]}map(e){const t=e.getData();return Array.isArray(t)&&this.tagGroups.length?(e.setData(t.filter((e=>{for(const t of this.tagGroups)if(!this.tagGroupMatch(t,e))return!1;return!0}))),e):e}tagGroupMatch(e,t){if(!e.length)return!0;for(const i of e)if(t.contentdata.tags.includes(i))return!0;return!1}}},"./public/common/labrador/transformers/source/DachserJson.js":(e,t,i)=>{i.r(t),i.d(t,{DachserJson:()=>r});class r{constructor(e){this.options={ignore:e.ignore||[]}}map(e){return(e.result||[]).map((e=>this.transformArticle(e)))}allowFragment(e){return!this.options.ignore.includes(e)}transformArticle(e){const t={type:"article",contentdata:{id:e.id,fields:{title:this.allowFragment("title")?{value:e.title}:null,subtitle:this.allowFragment("subtitle")?{value:e.description}:null,kicker:this.allowFragment("kicker")?{value:e.kicker}:null,published_url:{value:e.url}},tags:Array.isArray(e.tags)?e.tags:[]},metadata:e.metadata||{},width:e.width||100,widthVp:e.widthVp||{},children:[]};return e.images&&e.images.length&&this.allowFragment("image")&&t.children.push(this.transformImage(e.images[0])),t}transformImage(e){return{type:"image",contentdata:{fields:{},instance_of:e.id,metadata:{}}}}}},"./public/common/labrador/transformers/source/KilkayaStreams.js":(e,t,i)=>{i.r(t),i.d(t,{KilkayaStreams:()=>r});class r{constructor(e){this.options={ignore:e.ignore||[]}}map(e){return(e||[]).map((e=>this.transformArticle(e)))}allowFragment(e){return!this.options.ignore.includes(e)}transformArticle(e){const t={type:"article",contentdata:{fields:{title:{value:this.allowFragment("title")?e.title:null},subtitle:{value:this.allowFragment("subtitle")?e.desc:null},published_url:{value:this.ensureUrlProtocol(e.url)},paywall:{value:e.paid?"1":""}},primaryTags:{section:e.section}},metadata:{},children:[]};return e.image&&this.allowFragment("image")&&t.children.push(this.transformImage(this.ensureUrlProtocol(e.image))),t}ensureUrlProtocol(e="",t="https"){if(e.startsWith("//"))return e;return`${t}://${e.replace("http://","").replace("https://","")}`}transformImage(e){return{type:"image",contentdata:{fields:{imageurl:{value:e?encodeURIComponent(e):""}}},metadata:{}}}}},"./public/common/labrador/transformers/source/LabradorApi.js":(e,t,i)=>{i.r(t),i.d(t,{LabradorApi:()=>r});class r{constructor(e){this.options={imageServer:e.imageServer||"",ignore:e.ignore||[],extraFields:Array.isArray(e.extraFields)?e.extraFields:[]}}map(e){return(e.result||[]).map((e=>this.transformArticle(e)))}transformArticle(e){const t={type:e.type,contentdata:{id:e.id,fields:{title:{value:e.titleHTML||e.title||null},teaserTitle:{value:e.teaserTitle||null},subtitle:{value:e.subtitleHTML||e.subtitle||null},teaserSubtitle:{value:e.teaserSubtitle||null},kicker:{value:e.teaserKicker||e.kicker||null},teaserKicker:{value:e.teaserKicker||null},published_url:{value:e.siteDomain+e.published_url},byline:{value:e.byline_names},bylineImage:{value:e.full_bylines&&e.full_bylines[0]?e.full_bylines[0].imageUrl:""},seotitle:{value:e.seotitle},seodescription:{value:e.seodescription},paywall:{value:e.paywall},bodytext:{value:e.bodytext},site_id:{value:e.site_id},published:{value:e.published},modified:{value:e.modified},created:{value:e.created}},primaryTags:{section:e.section_tag},tags:(e.tags||"").split(", ")},metadata:{},width:100,widthVp:{},children:[]};for(const i of this.options.extraFields)void 0!==e[i]&&void 0===t.contentdata.fields[i]&&(t.contentdata.fields[i]={value:e[i]});return e.frontCropUrl&&t.children.push(this.transformImage(e)),t}transformImage(e){const t={caption:{value:e.imageCaption}};if(e.frontCropUrl){const i=e.frontCropUrl.split("?");if(2===i.length){const e=["imageId"],r=i[1].split("&");for(const i of r){const[r,s]=i.split("=");r&&!e.includes(r)&&(t[r]={value:s})}const s={panox:"x",panoy:"y",panow:"cropw",panoh:"croph"};for(const[e,i]of Object.entries(s))void 0!==t[e]&&(t[i]=t[e],delete t[e])}}return{type:"image",contentdata:{instance_of:e.image,fields:t},metadata:{}}}}},"./public/common/labrador/transformers/utils.js":(e,t,i)=>{i.r(t),i.d(t,{utils:()=>r});const r={decorateRow:(e,t)=>{const i=r.distributePercent(100,e.length,t.grid_size);for(const t of e)t.width=i.shift()},groupRowsAndColums:(e,t)=>{const i=[];let r=[];for(const s of e){if(r.length>=t.columnCount){if(i.push(r),i.length>=t.rowCount)return i;r=[]}r.push(s)}return i.push(r),i},percentToGrid:(e,t=12)=>Math.round(e/100*t),gridToPercent:(e,t=12)=>r.floatPrecision(e/t*100),floatPrecision:e=>parseFloat(parseFloat(e).toFixed(2)),distributePercent:(e,t,i=12)=>r.distributeGrid(r.percentToGrid(e,i),t).map((e=>r.gridToPercent(e,i))),distributeGrid:(e,t)=>{let i=t;i>e&&(i=e,Sys.logger.warn(`grid.distributeGrid: Requested count ${t} is larger than gridSize ${e}. Will use count ${i}.`));const r=e/i;if(Number.isInteger(r))return Array(i).fill(r);let s=0,a=!0,o=[];for(let e=0;e<i;e++){const e=a?Math.ceil(r):Math.floor(r);o.push(e),s+=e,a=!a}let n=s-e;if(s!==e){const e=[];for(;n>0&&o.length;){let t=o.shift();t>1&&(t--,n-=1),e.push(t)}o=o.concat(e)}return o.length!==i&&Sys.logger.warn(`Utility-method grid.distributeGrid will return a faulty array. Excpected a count of ${i}, got ${o.length} ...`),o}}},"./public/common/modules/FrontContent.js":(e,t,i)=>{i.r(t),i.d(t,{FrontContent:()=>s});var r=i("./public/common/labrador/source/FrontContentRenderer.js");class s{constructor(e){this.settings=e,this.FrontContentRenderer=new r.FrontContentRenderer({url:this.getUrl(),app:{device:this.settings.viewport,image_server:this.settings.imageServer},settings:this.settings});const t=document.querySelector(`#tagboard_${this.settings.id} .taglistToggle`),i=document.querySelector(`#tagboard_${this.settings.id} .taglist`);if(t&&i){const e=t.querySelector(".dac-icon-hamburger");t.addEventListener("click",(t=>{e.classList.toggle("dac-open"),i.classList.toggle("dac-hidden")}),!1)}this.selectedTags=[],this.tagGroups=[],this.contentTags=[];const s=[...document.querySelectorAll(`#tagboard_${this.settings.id} form.taglist .group`)];for(const e of s){const t=s.indexOf(e),i=e.querySelectorAll("li input"),r={};for(const e of i)r[e.value]={count:0,maxCount:0,element:e,counter:e.nextElementSibling,groupIndex:t},e.addEventListener("change",(e=>{this.toggleTag(e.target.value,e.target.checked,t)}),!1);this.tagGroups.push(r),this.selectedTags.push([])}this.fetchData()}getUrl(){if("LabradorApi"===this.settings.sourceType){let e="";return this.settings.tagOptions&&this.settings.tagOptions.allow&&(e=this.settings.isEditor?encodeURIComponent(`%20AND%20tag:(${this.settings.tagOptions.tags.map((e=>`%22${e}%22`)).join("%20")})`):` AND tag:(${this.settings.tagOptions.tags.map((e=>`"${e}"`)).join(" ")})`),`${this.settings.url}${e}&limit=${this.settings.articleCount}${this.settings.siteId?`&site_id=${this.settings.siteId}`:""}`}return this.settings.url}fetchData(){this.FrontContentRenderer.read().then((e=>{this.insertArticles(e),this.readTagCount()}))}insertArticles(e){const t=document.querySelector(this.settings.selector);for(;t.firstChild;)t.firstChild.remove();const i=new DocumentFragment;for(const t of e.markups){const e=document.createElement("div");e.innerHTML=t,i.appendChild(e.firstChild)}t.appendChild(i)}readTagCount(e){if(this.contentTags.length){for(const e of this.tagGroups)for(const t of Object.keys(e))e[t].count=0,e[t].maxCount=0;this.contentTags=[]}for(const e of this.FrontContentRenderer.renderer.api.v1.model.query.getModelsAsArray().filter((e=>"article"===e.getType()))){const t=e.get("tags")||[];this.contentTags.push(t);for(const e of t)this.bumpTagNumber(e,!0)}this.updateTagNumberElements()}filterTagCount(e){for(const t of this.tagGroups)if(this.tagGroups.indexOf(t)!==e){const i=this.selectedTags[e];for(const e of Object.keys(t))t[e].count=this.getTagCount(e,i)}this.updateTagNumberElements()}getTagCount(e,t){return this.contentTags.filter((i=>{if(!i.includes(e))return!1;if(!t.length)return!0;for(const e of t)if(i.includes(e))return!0;return!1})).length}bumpTagNumber(e,t=!1){for(const i of this.tagGroups)void 0!==i[e]&&(i[e].count++,t&&i[e].maxCount++)}updateTagNumberElements(){for(const e of this.tagGroups)for(const t of Object.keys(e))e[t].counter.innerHTML=e[t].count,e[t].element.disabled=0===e[t].count,0===e[t].count?e[t].element.parentElement.classList.add("disabled"):e[t].element.parentElement.classList.remove("disabled")}toggleTag(e,t,i){this.selectedTags[i]=this.selectedTags[i].filter((t=>t!==e)),t&&this.selectedTags[i].push(e),this.FrontContentRenderer.filter(this.selectedTags),this.fetchData()}}},"./public/common/modules/LabradorSearch.js":(e,t,i)=>{i.r(t),i.d(t,{LabradorSearch:()=>s});var r=i("./public/common/labrador/source/Search.js");class s{constructor(e){this.settings=e,this.dom={container:e.container,spinner:e.spinner,nav:e.nav,filters:e.filters,nextEl:null,advanced:{button:e.advanced.button.element,container:e.advanced.container,toggleAllSites:e.advanced.sites.toggleAll}},this.sites=JSON.parse(this.settings.advanced.sites.allowed||"[]"),this.sitesById={},this.baseUrl=e.apiUrl;const t=new URLSearchParams(window.location.search);this.isDebug="1"===t.get("debug"),this.requestedSites=this.readSiteIDs(t.get("sites")||""),this.nohitsLabel=e.nohitsLabel,this.urlParams={limit:t.get("limit")||e.articleCount||20,start:parseInt(t.get("start"),10)||0,query:t.get("query")||t.get("q"),altText:1},e.orderBy&&(this.urlParams.orderBy=e.orderBy),this.searchSettings={count:0,totalCount:0,canPage:!0},this.setup(),this.searchHandler=new r.Search({config:this.settings.config,url:this.getUrl(),app:{device:this.settings.viewport,image_server:this.settings.imageServer},searchMapper:{bodytextLength:this.settings.bodytextLength,fallbackImage:this.settings.fallbackImage,sites:this.sites}})}setup(){const e=this.dom.container.querySelector("form");this.settings.isEditor&&e.addEventListener("submit",(e=>{e.preventDefault()}),!1);if(this.dom.container.querySelector('input[name="query"]').value=this.getUrlParam("query"),this.dom.nextEl=this.dom.container.querySelector('[data-nav="next"]'),this.updatePager(),this.dom.nextEl.addEventListener("click",(e=>{e.preventDefault(),this.searchSettings.canPage&&this.nextPage()}),!1),this.settings.advanced.display){let e=[];this.sites.length!==this.requestedSites.length&&this.requestedSites.length||(this.dom.advanced.toggleAllSites.checked=!0),this.sites.forEach((t=>{this.requestedSites.length>0?this.requestedSites.includes(t.id)&&e.push(t):e.push(t)})),this.settings.advanced.sites.checkboxes.forEach((t=>{const i=parseInt(t.value,10);for(const r of e)if(r.id===i){t.checked=!0;break}t.addEventListener("change",(t=>{if(t.target.checked){let t=null;for(const r of this.sites)if(r.id===i){let s=!1;for(const t of e)if(t.id==i){s=!0;break}s||(t=r);break}null!==t&&e.push(t),this.sites.length===e.length&&(this.dom.advanced.toggleAllSites.checked=!0)}else{if(1===e.length)t.target.checked=!0;else{let t=-1;for(let r=0;r<e.length;r++)if(i===e[r].id){t=r;break}t>-1&&e.splice(t,1)}this.dom.advanced.toggleAllSites.checked=!1}this.settings.advanced.sites.input.value=this.writeSiteIDs(e.length>0?e:this.sites)}))})),this.settings.advanced.sites.input.value=this.writeSiteIDs(e),this.setUrlParam("query",this.generateQuery(e)),this.dom.advanced.button.addEventListener("click",(e=>{e.preventDefault(),this.dom.advanced.container.classList.contains("expanded")?(this.dom.advanced.button.innerText=this.settings.advanced.button.openText||"Show Advanced",this.dom.advanced.container.classList.remove("expanded")):(this.dom.advanced.button.innerText=this.settings.advanced.button.closeText||"Hide Advanced",this.dom.advanced.container.classList.add("expanded"))})),this.dom.advanced.toggleAllSites.addEventListener("click",(t=>{this.settings.advanced.sites.checkboxes.forEach((i=>{const r=t.target.checked;e=[];for(const t of this.sites)i.checked=r,r&&e.push(t);this.settings.advanced.sites.input.value=this.writeSiteIDs(e.length>0?e:this.sites)}))}))}else this.setUrlParam("query",this.generateQuery(this.sites));window.addEventListener("load",(e=>{this.getUrlParam("query")&&(this.fetchData(),this.dom.nav.classList.remove("dac-hidden"))}))}fetchData(){this.dom.spinner.classList.remove("dac-hidden"),this.searchHandler.read().then((e=>{this.insertArticles(e)}))}insertArticles(e){const t=document.querySelector(this.settings.selector),i=new DocumentFragment;for(const t of e.markups){const e=document.createElement("div");e.innerHTML=t,i.appendChild(e.firstChild)}t.appendChild(i),this.searchSettings.count=e.count,this.searchSettings.totalCount=this.getUrlParam("start")+e.count,e.totalCount<=this.searchSettings.totalCount&&this.disablePager(),this.dom.spinner.classList.add("dac-hidden"),this.updatePager(),0===e.count&&this.displayNohits()}readSiteIDs(e=""){return e.split(",").filter((e=>""!==e)).map((e=>parseInt(e,10)))||[]}writeSiteIDs(e){const t=[];return e.forEach((e=>{t.push(e.id)})),t.join(",")}generateQuery(e){let t=this.getUrlParam("query");if(t){const i=new RegExp(`[${["-","\\\\&&","\\\\||","!","(",")",'"',"~","*","?",":","+"].join("")}]`,"g");if(t=t.replace(i," ").trim(),t)return`${t.replace(i," ")} AND lab_site_id:(${e.map((e=>e.id)).join(" OR ")})`}}updatePager(){if(!this.searchSettings.canPage)return;this.dom.nextEl.classList.remove("disabled");const e=this.getUrlParam("start");this.settings.isEditor?this.dom.nextEl.setAttribute("href","#"):this.dom.nextEl.setAttribute("href",this.getUrlParams({start:e+this.searchSettings.count}))}getUrlParam(e){return this.urlParams[e]}setUrlParam(e,t){this.urlParams[e]=t}getUrl(){const e=Object.keys(this.urlParams).map((e=>`${e}=${this.urlParams[e]}`)).join("&");return`${this.baseUrl}?${e}`}getUrlParams(e={}){return`?${Object.keys(this.urlParams).map((t=>`${t}=${void 0!==e[t]?e[t]:this.urlParams[t]}`)).join("&")}`}nextPage(){this.setUrlParam("start",this.getUrlParam("start")+this.searchSettings.count),this.searchHandler.updateUrl(this.getUrl()),this.fetchData()}disablePager(){this.searchSettings.canPage=!1,this.dom.nextEl.classList.add("disabled")}displayNohits(){const e=document.createElement("div");e.innerHTML=this.nohitsLabel,e.classList.add("nohitsLabel"),this.dom.container.querySelector(".labclient-content").appendChild(e)}}},"./public/common/modules/Tagboard.js":(e,t,i)=>{i.r(t),i.d(t,{Tagboard:()=>s});var r=i("./public/common/labrador/source/FrontContentRenderer.js");class s{constructor(e){this.settings=e,this.baseUrl=e.apiUrl,this.FrontContentRenderer=new r.FrontContentRenderer({url:this.getUrl(),app:{device:this.settings.viewport,image_server:this.settings.imageServer},settings:this.settings});const t=document.querySelector(`#tagboard_${this.settings.id} .taglistToggle`),i=document.querySelector(`#tagboard_${this.settings.id} .taglist`);if(t&&i){const e=t.querySelector(".dac-icon-hamburger");t.addEventListener("click",(t=>{e.classList.toggle("dac-open"),i.classList.toggle("dac-hidden")}),!1)}this.selectedTags=[],this.tagGroups=[],this.contentTags=[];const s=[...document.querySelectorAll(`#tagboard_${this.settings.id} form.taglist .group`)];for(const e of s){const t=s.indexOf(e),i=e.querySelectorAll("li input"),r={};for(const e of i)r[e.value]={count:0,maxCount:0,element:e,counter:e.nextElementSibling,groupIndex:t},e.addEventListener("change",(e=>{this.toggleTag(e.target.value,e.target.checked,t)}),!1);this.tagGroups.push(r),this.selectedTags.push([])}this.fetchData()}getUrl(){return`${this.addTagsToUrl(this.settings.url,this.settings.tagOptions.tags,this.settings.tagOptions.groups)}&fields=*,-bodytext,-ai_*,-bodytextHTML&limit=${this.settings.articleCount}${this.settings.siteId?`&site_id=${this.settings.siteId}`:""}`}addTagsToUrl(e,t=[],i=[]){const r=e=>e.map((e=>{let t=e.trim();return t.indexOf(" ")>-1&&(t=`"${t}"`),`tag:${t}`})),s=" ";let a="";return a=i.length?encodeURIComponent(`${s}AND${s}${i.map((e=>`(${r(e).join(`${s}OR${s}`)})`)).join(`${s}AND${s}`)}`):encodeURIComponent(`${s}AND${s}(${r(t).join(`${s}OR${s}`)})`),e+a}fetchData(){this.FrontContentRenderer.read().then((e=>{this.insertArticles(e),this.readTagCount()}))}insertArticles(e){const t=document.querySelector(this.settings.selector);for(;t.firstChild;)t.firstChild.remove();const i=new DocumentFragment;for(const t of e.markups){const e=document.createElement("div");e.innerHTML=t,i.appendChild(e.firstChild)}t.appendChild(i)}readTagCount(e){if(this.contentTags.length){for(const e of this.tagGroups)for(const t of Object.keys(e))e[t].count=0,e[t].maxCount=0;this.contentTags=[]}for(const e of this.FrontContentRenderer.renderer.api.v1.model.query.getModelsAsArray().filter((e=>"article"===e.getType()))){const t=e.get("tags")||[];this.contentTags.push(t);for(const e of t)this.bumpTagNumber(e,!0)}this.updateTagNumberElements()}filterTagCount(e){for(const t of this.tagGroups)if(this.tagGroups.indexOf(t)!==e){const i=this.selectedTags[e];for(const e of Object.keys(t))t[e].count=this.getTagCount(e,i)}this.updateTagNumberElements()}getTagCount(e,t){return this.contentTags.filter((i=>{if(!i.includes(e))return!1;if(!t.length)return!0;for(const e of t)if(i.includes(e))return!0;return!1})).length}bumpTagNumber(e,t=!1){for(const i of this.tagGroups)void 0!==i[e]&&(i[e].count++,t&&i[e].maxCount++)}updateTagNumberElements(){for(const e of this.tagGroups)for(const t of Object.keys(e))e[t].counter.innerHTML=e[t].count,e[t].element.disabled=0===e[t].count,0===e[t].count?e[t].element.parentElement.classList.add("disabled"):e[t].element.parentElement.classList.remove("disabled")}toggleTag(e,t,i){this.selectedTags[i]=this.selectedTags[i].filter((t=>t!==e)),t&&this.selectedTags[i].push(e),this.FrontContentRenderer.filter(this.selectedTags),this.fetchData()}}}},t={};function i(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,i),a.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{i.r(r),i.d(r,{ClientData:()=>e.ClientData,Core:()=>t.Core,FrontContent:()=>d.FrontContent,LabradorSearch:()=>n.LabradorSearch,Mapper:()=>s.Mapper,Reader:()=>a.Reader,Renderer:()=>o.Renderer,Tagboard:()=>l.Tagboard});var e=i("./public/common/labrador/ClientData.js"),t=i("./public/common/labrador/Core.js"),s=i("./public/common/labrador/Mapper.js"),a=i("./public/common/labrador/Reader.js"),o=i("./public/common/labrador/Renderer.js"),n=i("./public/common/modules/LabradorSearch.js"),l=i("./public/common/modules/Tagboard.js"),d=i("./public/common/modules/FrontContent.js")})();var s=r.ClientData,a=r.Core,o=r.FrontContent,n=r.LabradorSearch,l=r.Mapper,d=r.Reader,c=r.Renderer,p=r.Tagboard;export{s as ClientData,a as Core,o as FrontContent,n as LabradorSearch,l as Mapper,d as Reader,c as Renderer,p as Tagboard};
//# sourceMappingURL=baseview_dependencie_modules.js.map